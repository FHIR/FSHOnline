import{m as ae,j as t,A as wt,T as bt,B as R,c as M,S as Ke,a as Ze,b as k,E as jt,d as vt,r as d,e as ge,I as fe,L as It,D as xe,f as me,g as ie,h as Fe,l as Ee,F as ot,C as kt,i as Se,k as it,n as be,o as Te,p as Ft,U as Tt,q as at,s as Nt,t as Ht,u as Et,v as rt,w,x as Ue,y as Dt,z as Lt,G as Rt,H as Ot,J as lt,K as $t,M as ze,N as Ce,O as ke,P as ct,Q as dt,R as Wt,V as De,W as Gt,X as Bt,Y as Mt,Z as At,_ as X,$ as Qe,a0 as Ye,a1 as Vt,a2 as Le,a3 as Re,a4 as Oe,a5 as $e,a6 as Pt,a7 as Ut,a8 as et,a9 as zt,aa as Jt,ab as _t,ac as tt,ad as Xt,ae as We,af as qt,ag as Kt,ah as Zt}from"./vendor-DIgoMSwM.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))o(s);new MutationObserver(s=>{for(const l of s)if(l.type==="childList")for(const f of l.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&o(f)}).observe(document,{childList:!0,subtree:!0});function i(s){const l={};return s.integrity&&(l.integrity=s.integrity),s.referrerPolicy&&(l.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?l.credentials="include":s.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function o(s){if(s.ep)return;s.ep=!0;const l=i(s);fetch(s.href,l)}})();const Qt="/assets/FSH-online-logo-BTt1RVAN.png",Yt=ae(e=>({root:{background:e.palette.common.blue,position:"static",boxShadow:"0"},title:{fontSize:20,fontWeight:700},logo:{height:"55px",width:"63px"},"@keyframes spin-once":{"0%":{rotate:"0deg"},"100%":{rotate:"360deg"}},logoSpin:{animation:"$spin-once 1000ms",animationIterationCount:1},toolbarBox:{alignItems:"center"},exitIcon:{paddingLeft:"3px",transform:"scaleX(-1)"},docButton:{color:e.palette.common.white,backgroundColor:e.palette.common.blue,fontSize:"0.875rem",fontWeight:700,"&:hover":{background:e.palette.common.lightBlue}},versionText:{color:e.palette.common.white,fontSize:"0.8rem",fontStyle:"italic",marginTop:"-5px"}}));function en(e){const n=Yt();return t.jsx(wt,{className:n.root,children:t.jsx(bt,{children:t.jsxs(R,{className:n.toolbarBox,display:"flex",flexGrow:1,flexDirection:"row",children:[t.jsxs(R,{order:1,display:"flex",flexGrow:1,flexDirection:"row",children:[t.jsx(R,{order:1,alignSelf:"center",display:"flex",children:t.jsx("img",{src:Qt,alt:"logo",className:M(n.logo,{[n.logoSpin]:e.sayAhoy})})}),t.jsx(R,{order:2,alignSelf:"center",m:1,children:t.jsxs(Ke,{injectFirst:!0,children:[t.jsx(Ze,{order:1,className:n.title,children:"FSH ONLINE"}),t.jsx(Ze,{order:2,className:n.versionText,children:"Powered by SUSHI v3.14.0 and GoFSH v2.5.0"})]})})]}),t.jsx(R,{order:1,children:t.jsx(Ke,{injectFirst:!0,children:t.jsxs(k,{className:n.docButton,href:"https://fshschool.org/",target:"_blank",children:[t.jsx(jt,{className:n.exitIcon,fontSize:"small"}),"Back to School"]})})})]})})})}const se={lighterBlue:"#D8E2EA",lightBlue:"#487AA2",blue:"#30638e",darkerBlue:"#143E61",editorGrey:"#263238",lightestGrey:"#E7ECEE",lightGrey:"#D0D9DD",grey:"#575B5C",darkerGrey:"#3D4345",darkestGrey:"#121D21",red:"#FD6668"},Je=vt({palette:{success:{main:se.blue,dark:se.darkerBlue,light:se.lightBlue},common:se},typography:{fontFamily:"Open Sans"},overrides:{MuiTooltip:{tooltip:{backgroundColor:se.darkestGrey,fontSize:"13px"},arrow:{color:se.darkestGrey}},MuiButton:{text:{textTransform:"none",fontWeight:600}},MuiIconButton:{root:{"&:hover":{backgroundColor:se.grey}}}}}),tn=ae(e=>({iconButton:{color:e.palette.common.white,padding:"3px"},textArea:{width:"100%",color:e.palette.text.primary,fontWeight:"bold"},copyBox:{backgroundColor:e.palette.common.lightestGrey,borderRadius:2,display:"flex",justifyContent:"space-between",alignItems:"center",paddingLeft:"15px",paddingRight:"5px"},linkBox:{paddingTop:"15px",paddingBottom:"15px",paddingRight:"5px",whiteSpace:"nowrap",overflowX:"scroll",textOverflow:"ellipsis"},copyButton:{padding:"8px",borderRadius:0,"&:hover":{background:e.palette.common.lightGrey}}}));function nn(e){const n=tn(),[i,o]=d.useState(!1),[s,l]=d.useState(!1),[f,a]=d.useState(!1),[r,c]=d.useState(!1),[u,x]=d.useState("Copy to Clipboard"),[v,b]=d.useState("Copy Formatted Link to Clipboard"),[{fshCopied:T,fshCopyButton:U},Y]=d.useState({fshCopied:!1,fshCopyButton:"Copy FSH to Clipboard"}),[z,ee]=d.useState(),[q,te]=d.useState(),[V,O]=d.useState(!0),D=K=>{var Z;const _=(Z=K.target.value.match(/gist\.github\.com\/[^/]+\/(.+)/))==null?void 0:Z[1];_&&te(`https://fshonline.fshschool.org/#/gist/${_}`)},P=()=>{l(!0),m()},m=()=>{o(!1),a(!0),te(""),Y({fshCopied:!1,fshCopyButton:"Copy FSH to Clipboard"})},S=()=>{a(!1),l(!1)},p=()=>{q?(S(),ee(q),o(!0),x("Copy to Clipboard"),b("Copy Formatted Link to Clipboard"),O(!1)):c(!0)},y=()=>{c(!1)},I=async()=>{var Z,re,le,ce,de,ue,he,pe;let K;(Z=e.config)!=null&&Z.canonical||(re=e.config)!=null&&re.version||((le=e.config)==null?void 0:le.fhirVersion.length)>0||(ce=e.config)!=null&&ce.dependencies?K=Te.deflateSync(JSON.stringify({c:(de=e.config)==null?void 0:de.canonical,v:(ue=e.config)==null?void 0:ue.version,f:(he=e.config)==null?void 0:he.fhirVersion,d:(pe=e.config)==null?void 0:pe.dependencies})+`
`+e.shareText).toString("base64"):K=Te.deflateSync(e.shareText).toString("base64");const _=`https://fshonline.fshschool.org/#/share/${K}`;_.length>2048?P():(ee(_),o(!0),x("Copy to Clipboard"),b("Copy Formatted Link to Clipboard"),O(!0))},N=()=>{o(!1),l(!1)},J=()=>{Y({fshCopied:!0,fshCopyButton:"FSH Copied to Clipboard"})};return t.jsxs(t.Fragment,{children:[t.jsx(ge,{title:"Share FSH",placement:"top",arrow:!0,children:t.jsx(fe,{name:"Share FSH",className:n.iconButton,onClick:I,children:t.jsx(It,{fontSize:"small",style:{transform:"rotate(-45deg)"}})})}),t.jsxs(xe,{open:i,onClose:N,"aria-labelledby":"form-dialog-title",maxWidth:"md",fullWidth:!0,children:[t.jsx(me,{id:"form-dialog-title",children:"Share"}),t.jsxs(ie,{children:[t.jsx(Fe,{children:"Use this link to share your FSH with others!"}),t.jsxs(R,{className:n.copyBox,children:[t.jsx(R,{className:n.linkBox,children:z}),t.jsxs(R,{sx:{display:"flex",flexWrap:"nowrap"},children:[t.jsx(ge,{title:u,placement:"top",arrow:!0,children:t.jsx(fe,{className:n.copyButton,children:t.jsx(Ee.CopyToClipboard,{text:z,onCopy:()=>x("Link Copied"),children:t.jsx(ot,{fontSize:"small"})})})}),t.jsx(ge,{title:v,placement:"top",arrow:!0,children:t.jsx(fe,{className:n.copyButton,children:t.jsx(Ee.CopyToClipboard,{text:`[FSH Online Link](${z})`,onCopy:()=>b("Link Copied"),options:{format:"text/plain"},children:t.jsx(kt,{fontSize:"small"})})})})]})]})]}),t.jsxs(Se,{children:[V&&t.jsx(k,{onClick:m,color:"primary",style:{align:"left"},children:"Create Link with Gist"}),t.jsx(R,{style:{flex:"1 0 0",hidden:!0}}),t.jsx(k,{onClick:N,color:"primary",children:"Done"})]})]}),t.jsxs(xe,{open:f,onClose:S,"aria-labelledby":"alert-dialog-title",maxWidth:"md",fullWidth:!0,children:[t.jsx(me,{id:"alert-dialog-title",children:"Share with Gist"}),s&&t.jsx(ie,{style:{color:Je.palette.common.red},children:"Your FSH content is too long to share directly. Please use a Gist to share."}),t.jsxs(ie,{children:["Create a"," ",t.jsx(it,{id:"gistURL",href:"https://gist.github.com/",target:"_blank",children:"Gist"})," ","and paste the URL below to generate a shareable FSH Online link.",t.jsx(be,{id:"gistURLText",label:"Gist URL",fullWidth:!0,onChange:D})]}),t.jsxs(Se,{style:{bottom:0,right:0},children:[t.jsx(k,{onClick:S,color:"primary",children:"Cancel"}),t.jsx(R,{style:{flex:"1 0 0",hidden:!0}}),t.jsx(Ee.CopyToClipboard,{text:e.shareText,onCopy:J,style:{align:"left"},children:t.jsx(k,{color:T?"secondary":"primary",children:U})}),t.jsx(k,{color:"primary",onClick:p,style:{align:"left"},children:"Generate Link from Gist"})]})]}),t.jsxs(xe,{open:r,onClose:y,"aria-labelledby":"alert-dialog-title",maxWidth:"lg",children:[t.jsx(me,{id:"alert-dialog-title",children:"Error Creating Gist Link"}),t.jsx(ie,{children:t.jsx(Fe,{children:"Could not generate a link from your Gist URL. Ensure the URL is valid."})}),t.jsx(Se,{children:t.jsx(k,{onClick:y,color:"primary",children:"Keep Swimming!"})})]})]})}Ft.defineSimpleMode("fsh",{meta:{lineComment:"//"},start:[{regex:/"(?:[^\\]|\\.)*?(?:"|$)/,token:"atom"},{regex:/\b(Alias|Characteristics|Context|CodeSystem|Expression|Extension|Description|Id|Instance|InstanceOf|Invariant|Logical|Mapping|Mixins|Parent|Profile|Resource|RuleSet|Severity|Source|Target|Title|Usage|ValueSet|XPath)(?=\s*:)\b/,token:"keyword"},{regex:/(\s|^)(and|codes|contains|descendent-of|exclude|exists|from system|from|generalizes|include|in|insert|is-a|is-not-a|named|not-in|obeys|only|or|regex|units|valueset|where|D|MS|N|SU|TU|\\?!)(\s|$)/,token:"def"},{regex:/(\(\s*)(exactly|example|extensible|preferred|required)(\s*\))/,token:"def"},{regex:/\b(CodeableReference|Reference|Canonical)\s*\(/,push:"closingParen",token:"atom"},{regex:/\*|->|=|\+|:/,token:"def"},{regex:/\b(https?:\/\/(www\.)?[-a-zA-Z0-9@:%._+~#=]{2,256}\.[a-z]{2,6}\b([-a-zA-Z0-9@:%_+.~#?&//=]*))\b/,token:"atom"},{regex:/(\s|^)(true|false)(\s|$)/,token:"string"},{regex:/(\s|^)(-?\d+(\.\d+)?)(\s|^)/,token:"string"},{regex:/#"(?:\\.|[^\\"])*"/,token:"string"},{regex:/#[^\s]*/,token:"string"},{regex:/'.*'/,token:"string"},{regex:/\s\/\/.*/,token:"comment"},{regex:/\/\/.*/,token:"comment",sol:!0},{regex:/\/\*/,token:"comment",next:"comment"}],closingParen:[{regex:/\)/,pop:!0,token:"atom"}],comment:[{regex:/.*?\*\//,token:"comment",next:"start"},{regex:/.*/,token:"comment"}]});const we=200,sn=ae(e=>({box:{height:"100%"},header:{fontFamily:"Open Sans",color:e.palette.common.white,background:e.palette.common.darkerGrey,padding:"0px",paddingLeft:"29px",height:"34px",display:"flex",justifyContent:"space-between",transition:e.transitions.create(["margin","width"],{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen})},headerShift:{width:`calc(100% - ${we}px - 29px)`,transition:e.transitions.create(["margin","width"],{easing:e.transitions.easing.easeOut,duration:e.transitions.duration.enteringScreen}),marginRight:we},headerLabel:{lineHeight:"34px",float:"left",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},headerActionGroup:{paddingRight:"10px"},headerActions:{alignItems:"center",display:"flex"},iconButton:{color:e.palette.common.white,padding:"3px"},drawer:{width:we,flexShrink:0},drawerPaper:{width:we,border:"none",height:"calc(100vh - 116px - 34px)",top:"116px"},drawerPaperExpandedConsole:{height:"calc(100vh - 116px - 300px)"},drawerHeader:{display:"flex",alignItems:"center",justifyContent:"flex-start",color:e.palette.common.white,background:e.palette.common.darkerGrey,height:"34px",minHeight:"34px"},drawerHeaderIcon:{padding:"0px",color:e.palette.common.white,background:e.palette.success.main,"&:hover":{background:e.palette.success.light},borderRadius:0,height:"100%",width:"34px",minWidth:"34px"},content:{flexGrow:1,width:"100%",transition:e.transitions.create(["margin","width"],{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen})},contentShift:{width:`calc(100% - ${we}px)`,transition:e.transitions.create(["margin","width"],{easing:e.transitions.easing.easeOut,duration:e.transitions.duration.enteringScreen}),marginRight:0}}));function _e(e){const n=sn(),i=d.useContext(St),[o,s]=d.useState(!0),l=()=>{s(!0)},f=()=>{s(!1)};function a(x){e.updateTextValue(x)}const r=(x,v,b,T={})=>t.jsx(ge,{title:w.upperFirst(v),placement:"top",arrow:!0,children:t.jsx(fe,{name:v,className:n.iconButton,"aria-label":v,onClick:b,children:t.jsx(x,{fontSize:"small",style:T})})}),c=()=>t.jsxs("div",{className:n.headerActions,children:[t.jsxs("div",{className:n.headerActionGroup,children:[e.mode==="fsh"&&!e.isExamples&&t.jsx(nn,{shareText:e.value,config:e.config}),e.copy&&r(ot,"copy",()=>{}),e.save&&r(at,"save",e.save),e.delete&&r(Nt,"delete",e.delete)]}),e.renderDrawer&&!o&&t.jsx(fe,{name:"expand",className:n.drawerHeaderIcon,"aria-label":"expand",onClick:l,children:t.jsx(Ht,{})})]}),u=()=>t.jsxs(Et,{className:n.drawer,"data-testid":"editor-drawer",variant:"persistent",anchor:"right",open:o,classes:{paper:M(n.drawerPaper,i&&n.drawerPaperExpandedConsole)},children:[t.jsx("div",{className:n.drawerHeader,children:t.jsx(k,{name:"collapse","aria-label":"collapse",className:n.drawerHeaderIcon,onClick:f,children:t.jsx(rt,{})})}),e.renderDrawer()]});return t.jsxs(R,{className:n.box,children:[t.jsxs("div",{className:M(n.header,{[n.headerShift]:e.renderDrawer&&o}),children:[t.jsx("div",{title:e.name,className:n.headerLabel,children:e.name}),c()]}),t.jsx(Tt,{className:M("react-codemirror2",e.renderDrawer&&n.content,{[n.contentShift]:e.renderDrawer&&o}),value:e.initialText,options:{mode:e.mode,theme:"material",placeholder:e.placeholder,scrollbarStyle:"overlay",autoCloseBrackets:!0,lineNumbers:!0,foldGutter:!0,readOnly:e.isExamples,gutters:["CodeMirror-linenumbers","CodeMirror-foldgutter"],extraKeys:{Tab:x=>{x.replaceSelection("  ")},"Ctrl-/":"toggleComment","Cmd-/":"toggleComment","Ctrl-Q":x=>{x.foldCode(x.getCursor())}},lineWrapping:e.isLineWrapped},onChange:(x,v,b)=>{a(b)}}),e.renderDrawer&&u()]})}function ut(e){return t.jsxs(xe,{open:e.isOpen,onClose:e.handleCloseModal,"aria-labelledby":"delete-confirmation-dialog",children:[t.jsxs(me,{id:"delete-confirmation-dialog-title",children:["Delete ",e.title]}),t.jsx(ie,{children:t.jsxs(Fe,{children:["Are you sure you want to delete ",e.item,"? This action cannot be undone."]})}),t.jsxs(Se,{children:[t.jsx(k,{onClick:e.handleCloseModal,color:"primary",children:"Cancel"}),t.jsx(k,{onClick:e.handleDelete,color:"secondary",children:"Delete"})]})]})}const on=ae(e=>({fileTreeContent:{overflowY:"scroll",height:"100%"},button:{color:e.palette.common.white,background:e.palette.success.main,"&:hover":{background:e.palette.success.dark},border:"8px solid white",fontSize:"13px",width:"100%"},list:{padding:"8px",paddingLeft:"0px",paddingBottom:"0px",fontSize:"13px"},listItemError:{paddingTop:"5px",paddingBottom:"5px",margin:0},listItem:{background:e.palette.common.lightestGrey,paddingTop:"5px",paddingBottom:"5px",marginTop:"5px",marginBottom:"5px",paddingLeft:"5px",margin:0,"&:hover":{background:e.palette.common.lightGrey},display:"block",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},listItemSelected:{background:e.palette.common.editorGrey,color:e.palette.common.white,"&:hover":{background:e.palette.common.darkestGrey}},listHeader:{padding:"5px",paddingLeft:"15px"},listIcon:{color:e.palette.success.main,verticalAlign:"middle",fontSize:"13px",paddingLeft:"3px",paddingRight:"3px"},listIconError:{color:e.palette.common.red},blankIcon:{paddingLeft:"19px"}})),Be=e=>{if(e.resourceType==="ValueSet"||e.resourceType==="CodeSystem")return e.resourceType;if(e.resourceType==="StructureDefinition"){if(e.derivation==="specialization"){if(e.kind==="resource")return"Resource";if(e.kind==="logical")return"Logical Model"}else if(e.derivation==="constraint"){if(e.kind==="complex-type"&&e.type==="Extension")return"Extension";if(["resource","complex-type","primitive-type","logical"].includes(e.kind))return"Profile"}}return e.resourceType!=null?"Instance":null},Me=e=>{if(e.id)if(typeof e.id=="object"){if(e.id.value)return e.id.value}else return e.id;return e.resourceType?`Instance of ${e.resourceType.substring(e.resourceType.lastIndexOf("/")+1)}`:"Untitled"},an=e=>[...e.profiles,...e.extensions,...e.logicals,...e.resources,...e.instances,...e.valueSets,...e.codeSystems].map(i=>({resourceType:Be(i),id:Me(i),def:JSON.stringify(i,null,2)}));function rn(e){const n=on(),[i,o]=d.useState(""),[s,l]=d.useState([{resourceType:null,id:"Untitled",def:null}]),{setShowNewText:f,updateTextValue:a}=e,[r,c]=d.useState(0),[u,x]=d.useState([]),[v,b]=d.useState(!1);d.useEffect(()=>{if(e.showNewText&&!w.isEqual(e.text,[""])){f(!1);let m;try{m=JSON.parse(e.text)}catch{m={profiles:[],extensions:[],logicals:[],resources:[],instances:[],valueSets:[],codeSystems:[]}}const S=an(m);l(S),c(0),o(S.length>0?S[0].def:""),a(S)}else e.isWaiting&&(o(null),l([]))},[e.text,e.showNewText,e.isWaiting,a,f]);const T=m=>{if(e.isWaiting)return;const S=[...s];try{const p=m===""?{}:JSON.parse(m);if(u.includes(r)){const y=[...u];y.splice(u.indexOf(r),1),x(y)}s[r]||(S[r]={resourceType:Be(p),id:Me(p)}),(!s[r]||p.resourceType!==s[r].resourceType)&&(S[r].resourceType=Be(p)),(!s[r]||p.id!==s[r].id)&&(S[r].id=Me(p))}catch{if(!u.includes(r)){const y=[...u];y.push(r),x(y)}}S[r]&&(S[r].def=m),l(S),e.updateTextValue(S),i===null&&o(m)},U=()=>{const m=[...s];m.push({resourceType:null,id:"Untitled",def:null}),c(m.length-1),l(m),o(null),e.updateTextValue(m)},Y=()=>{const m=r,S=[...s];if(S.splice(m,1),S.length===0&&S.push({resourceType:null,id:"Untitled",def:null}),l(S),m<=r){let I=0;m<r&&(I=r-1),c(I);const N=S.length>0?S[I].def:null;o(N)}const p=[...u];u.includes(m)&&p.splice(u.indexOf(m),1);const y=p.map(I=>I<m?I:I-1);x(y),b(!1),e.updateTextValue(S)},z=()=>{b(!0)},ee=()=>{b(!1)},q=(m,S)=>{let p;try{p=JSON.parse(m)}catch{}Ue.saveAs(new Blob([m]),p!=null&&p.resourceType&&(p!=null&&p.id)?`${p.resourceType}-${p.id}.json`:`${S}.json`)},te=()=>{const m=s[r];if(!m)return;const S=m.resourceType||"Unknown Type",p=m.id||"Untitled";return t.jsx(ut,{title:"FHIR JSON",item:`${S} ${p}`,isOpen:v,handleCloseModal:ee,handleDelete:Y})},V=()=>{const m=["Profiles","Extensions","Logical Models","Resources","ValueSets","CodeSystems","Instances","Unknown Type"],S=w.groupBy(s,p=>p&&p.resourceType?`${p.resourceType}s`:"Unknown Type");return Object.keys(S).sort((p,y)=>m.indexOf(p)-m.indexOf(y)).map(p=>t.jsxs(Lt,{component:"nav",className:n.list,children:[t.jsx("div",{className:n.listHeader,children:p}),S[p].sort((y,I)=>{const N=y.id?y.id:"Untitled",J=I.id?I.id:"Untitled";return N.toLowerCase()<J.toLowerCase()?-1:N.toLowerCase()>J.toLowerCase()?1:0}).map((y,I)=>{const N=s.indexOf(y),J=u.includes(N);return t.jsxs(Rt,{button:!0,title:(y==null?void 0:y.id)||"Untitled","data-testid":`${p}-defId`,className:M(n.listItem,J&&n.listItemError,N===r&&n.listItemSelected),onClick:()=>{c(N),o(y.def)},children:[u.includes(N)?t.jsx(ge,{title:"Invalid JSON",placement:"top",arrow:!0,children:t.jsx(Ot,{className:M(n.listIcon,n.listIconError)})}):t.jsx("span",{className:n.blankIcon}),(y==null?void 0:y.id)||"Untitled"]},I)})]},p))},O=()=>t.jsxs(t.Fragment,{children:[t.jsx(k,{className:n.button,startIcon:t.jsx(Dt,{}),onClick:U,children:"New JSON Editor"}),t.jsx("div",{className:n.fileTreeContent,children:V()})]}),D=s.length>0?s[r].def:null,P=`${s.length>0?s[r].id:"Untitled"}`;return t.jsxs(t.Fragment,{children:[t.jsx(_e,{name:`FHIR JSON: ${P}`,value:D,initialText:i,updateTextValue:T,mode:"application/json",placeholder:e.isWaiting?"Loading...":`Paste or edit single FHIR JSON artifact here... 
Create additional FHIR JSON artifacts to the right.`,renderDrawer:O,isExamples:!1,delete:z,save:()=>q(D,P),isLineWrapped:e.isLineWrapped}),v&&te()]})}function ln(e){const[n,i]=d.useState(!1),o=()=>{i(!n)},s=()=>{i(!1),e.setInitialText("")},l=()=>{Ue.saveAs(new Blob([e.text]),"FSH.fsh")};return t.jsxs(t.Fragment,{children:[t.jsx(_e,{name:"FSH",isExamples:!1,value:e.text,initialText:e.initialText,updateTextValue:e.updateTextValue,mode:"fsh",placeholder:e.isWaiting?"Loading...":"Paste or edit FSH here...",delete:o,save:l,config:e.config,isLineWrapped:e.isLineWrapped}),n&&t.jsx(ut,{title:"FHIR Shorthand",item:"all FSH",isOpen:n,handleCloseModal:o,handleDelete:s})]})}const cn=ae(e=>({consoleControls:{background:e.palette.common.darkestGrey,height:"34px",boxSizing:"border-box",display:"flex;",alignItems:"center",justifyContent:"left"},box:{paddingLeft:"29px",color:e.palette.common.white,background:e.palette.common.darkestGrey,height:"calc(100% - 34px)",overflow:"scroll",boxSizing:"border-box"},button:{marginRight:"10px",color:e.palette.common.white,textTransform:"none",padding:0},problemsButton:{padding:0,color:e.palette.common.white,textTransform:"none"},expandIcon:{width:"29px",color:e.palette.common.white,padding:0},pre:{margin:"0px"},circle:{"border-radius":"50%","border-style":"solid","border-width":"2px","min-width":"20px",height:"20px",paddingLeft:1,paddingRight:1,background:"#263238","align-items":"center",display:"flex",marginLeft:4,"justify-content":"center",padding:0}}));function dn(e){const n=cn(),[i,o]=d.useState(!1),{problemCount:s,setExpandConsole:l}=e;d.useEffect(()=>{s&&l(!0)},[s,l]);const f=()=>{e.setExpandConsole(!e.expandConsole)},a=()=>{o(!1),e.setExpandConsole(!0)},r=()=>{o(!0),e.setExpandConsole(!0)};return t.jsxs(t.Fragment,{children:[t.jsxs(R,{className:n.consoleControls,children:[t.jsx(fe,{onClick:f,"aria-label":e.expandConsole?"collapse console":"expand console",className:n.expandIcon,children:e.expandConsole?t.jsx(lt,{}):t.jsx($t,{})}),t.jsx(k,{onClick:a,className:n.button,children:t.jsx("p",{style:{borderBottom:e.expandConsole&&!i?"1px solid white":"none",margin:"0"},children:"Console"})}),t.jsxs(k,{onClick:r,className:n.problemsButton,children:[t.jsx("p",{style:{borderBottom:e.expandConsole&&i?`1px solid ${e.problemCount?e.problemColor:"white"}`:"none",margin:"0"},children:"Problems"}),t.jsx("div",{className:n.circle,style:{borderColor:`${e.problemCount?e.problemColor:"white"}`},children:e.problemCount})]})]}),t.jsx(R,{style:{display:e.expandConsole?"block":"none"},className:n.box,children:i?e.problemMessages.map((c,u)=>t.jsx("pre",{className:n.pre,children:c},u)):e.consoleMessages.map((c,u)=>t.jsx("pre",{className:n.pre,children:c},u))})]})}let A=ze.logger;function ht(e,n){e==="sushi"?A=ze.logger:e==="gofsh"&&(A=Ce.logger),A.level=n}const{FSHTank:un,RawFSH:hn}=Gt,{exportFHIR:pn}=Bt,{createFHIRDefinitions:gn,FHIRDefinitions:fn}=Mt,{AUTOMATIC_DEPENDENCIES:xn,fillTank:mn,getFHIRVersionInfo:Sn,getRandomPun:pt,loadExternalDependencies:Cn,stats:Ae,Type:yn}=ze,{loadExternalDependencies:wn,stats:oe}=Ce;async function bn(e,n,i){oe.reset(),ht("gofsh",i);const o=[];e.forEach((x,v)=>{const b=`Input_${v}`;try{x=JSON.parse(x),x.resourceType||A.error(`FHIR JSON ${x.id??b} is missing the required "resourceType" property`)}catch{A.error(`Could not parse ${b} to JSON`);return}Ce.isProcessableContent(x,b)&&o.push(new ke.WildFHIR({content:x},b))}),await ct({locateFile:()=>dt});const s=new ke.LakeOfFHIR(o);await s.prepareDefs();const l=await kn(s,n.dependencies),f=await gt(l.config.dependencies,l,!1),a=new Ce.MasterFisher(s,f),r=new ke.FHIRProcessor(s,a),c=await Ce.getResources(r,l,{indent:n.indent}),u=new Wt.FSHExporter(c).apiExport("string");return A.info("Done converting definitions"),In(c),{fsh:u,config:(l==null?void 0:l.config)??{}}}async function jn(e,n,i=[],o){Ae.reset(),ht("sushi",o),await ct({locateFile:()=>dt});const s=await gt(i,n,!0);let l=un;try{const c=[new hn(e)];l=mn(c,n)}catch{A.error("Something went wrong when importing the FSH definitions");return}const f=s.fishForFHIR("StructureDefinition",yn.Resource);if((f==null?void 0:f.version)!==n.fhirVersion[0]){A.error("StructureDefinition resource not found. The FHIR package in the browser cache may be corrupt. Clear cookies and site data on this webpage to reload the FHIR package.");return}A.info("Converting FSH to FHIR resources...");const a=pn(l,s),r=a.profiles.length+a.extensions.length+a.logicals.length+a.resources.length+a.instances.filter(c=>c._instanceMeta.usage!=="Inline").length+a.valueSets.length+a.codeSystems.length;return A.info(`Exported ${r} FHIR resources as JSON.`),console.log(" "),vn(a),a.profiles=a.profiles.map(c=>c.toJSON(!1)),a.extensions=a.extensions.map(c=>c.toJSON(!1)),a.logicals=a.logicals.map(c=>c.toJSON(!1)),a.resources=a.resources.map(c=>c.toJSON(!1)),a.instances=a.instances.filter(c=>c._instanceMeta.usage!=="Inline"),a}function vn(e){const n=Ae.numError,i=Ae.numWarn,o=w.pad(e.profiles.length.toString(),13),s=w.pad(e.extensions.length.toString(),12),l=w.pad(e.logicals.length.toString(),12),f=w.pad(e.resources.length.toString(),13),a=w.pad(e.valueSets.length.toString(),18),r=w.pad(e.codeSystems.length.toString(),17),c=w.pad(e.instances.length.toString(),18),u=w.pad(`${n} Error${n!==1?"s":""}`,13),x=w.padStart(`${i} Warning${i!==1?"s":""}`,12),v=w.padEnd(pt(n,i),36);["╔════════════════════════ SUSHI RESULTS ══════════════════════════╗","║ ╭───────────────┬──────────────┬──────────────┬───────────────╮ ║","║ │    Profiles   │  Extensions  │   Logicals   │   Resources   │ ║","║ ├───────────────┼──────────────┼──────────────┼───────────────┤ ║",`║ │ ${o} │ ${s} │ ${l} │ ${f} │ ║`,"║ ╰───────────────┴──────────────┴──────────────┴───────────────╯ ║","║ ╭────────────────────┬───────────────────┬────────────────────╮ ║","║ │      ValueSets     │    CodeSystems    │     Instances      │ ║","║ ├────────────────────┼───────────────────┼────────────────────┤ ║",`║ │ ${a} │ ${r} │ ${c} │ ║`,"║ ╰────────────────────┴───────────────────┴────────────────────╯ ║","║                                                                 ║","╠═════════════════════════════════════════════════════════════════╣",`║ ${v} ${u} ${x} ║`,"╚═════════════════════════════════════════════════════════════════╝"].forEach(T=>console.log(T))}function In(e){const n=w.pad(e.profiles.length.toString(),18),i=w.pad(e.extensions.length.toString(),17),o=w.pad(e.logicals.length.toString(),18),s=w.pad(e.resources.length.toString(),18),l=w.pad(e.valueSets.length.toString(),17),f=w.pad(e.codeSystems.length.toString(),18),a=w.pad(e.instances.length.toString(),18),r=w.pad(e.invariants.length.toString(),17),c=w.pad(e.mappings.length.toString(),18),u=w.pad(`${oe.numError} Error${oe.numError!==1?"s":""}`,12),x=w.padStart(`${oe.numWarn} Warning${oe.numWarn!==1?"s":""}`,12),v=w.padEnd(pt(oe.numError,oe.numWarn),37),b=["╔═════════════════════════ GoFSH RESULTS ═════════════════════════╗","║ ╭────────────────────┬───────────────────┬────────────────────╮ ║","║ │      Profiles      │    Extensions     │      Logicals      │ ║","║ ├────────────────────┼───────────────────┼────────────────────┤ ║",`║ │ ${n} │ ${i} │ ${o} │ ║`,"║ ╰────────────────────┴───────────────────┴────────────────────╯ ║","║ ╭────────────────────┬───────────────────┬────────────────────╮ ║","║ │     Resources      │     ValueSets     │     CodeSystems    │ ║","║ ├────────────────────┼───────────────────┼────────────────────┤ ║",`║ │ ${s} │ ${l} │ ${f} │ ║`,"║ ╰────────────────────┴───────────────────┴────────────────────╯ ║","║ ╭────────────────────┬───────────────────┬────────────────────╮ ║","║ │     Instances      │    Invariants     │      Mappings      │ ║","║ ├────────────────────┼───────────────────┼────────────────────┤ ║",`║ │ ${a} │ ${r} │ ${c} │ ║`,"║ ╰────────────────────┴───────────────────┴────────────────────╯ ║","║                                                                 ║","╠═════════════════════════════════════════════════════════════════╣",`║ ${v} ${u} ${x} ║`,"╚═════════════════════════════════════════════════════════════════╝"];console.log(" "),b.forEach(T=>console.log(T))}async function gt(e,n,i){const o=(u,x)=>{A.log(u,x)},s=new De.FHIRRegistryClient("https://packages.fhir.org",{log:o,isBrowserEnvironment:!0}),f=(await Fn(i?e:n.config.dependencies??[],i?n.fhirVersion[0]:n.config.fhirVersion[0],s)).map(u=>({name:u.packageId,version:u.version})),a=new De.SQLJSPackageDB;await a.initialize();const r=new De.BrowserBasedPackageCache("FSHOnline Dependencies",{log:o});await r.initialize(f);const c=await gn(!1,null,{packageCache:r,packageDB:a,registryClient:s,options:{log:o}});return i?(n.dependencies=e.filter(nt),await Cn(c,n)):(n.config.dependencies!=null&&(n.config.dependencies=n.config.dependencies.filter(nt)),await wn(c,n)),c.optimize(),c}async function kn(e,n){const i=new fn;await i.initialize();const o=new Ce.MasterFisher(e,i),s=new ke.FHIRProcessor(e,o),l=n.map(a=>a.replace("#","@"));return s.processConfig(l??[])}async function Fn(e,n,i){const o=[];for(const a of e){const{packageId:r}=a,c=await i.resolveVersion(r,a.version);o.push({packageId:r,version:c})}const s=Sn(n),l={packageId:s.packageId,version:n};st(o,l)||o.push(l);const f=xn.filter(a=>a.version!=="current");for(const a of f){if(a.fhirVersions&&!a.fhirVersions.includes(s.name))continue;const{packageId:r}=a,c=await i.resolveVersion(r,a.version);st(o,a)||o.push({packageId:r,version:c})}return o}function nt(e){return e.version==null&&A.warn(`Skipping ${e.packageId} because it does not include a version. Use format packageId#version.`),e.version!=null}function st(e,n,i=!1){return e.some(o=>o.packageId===n.packageId&&(i||o.version===n.version))}function Tn(e){return e.split(",").map(i=>{const o=i.trim();if(o==="")return o;const[s,l]=o.split("#");return{packageId:s,version:l}}).filter(i=>i)}const Nn=ae(e=>({box:{padding:e.spacing(1),color:e.palette.text.primary,background:e.palette.background.paper,display:"flex;",alignItems:"center",justifyContent:"center"},rightControls:{position:"absolute",right:"24px"},leftControls:{position:"absolute",left:"28px"},secondaryButton:{color:e.palette.success.main,"&:hover":{background:e.palette.common.lighterBlue}},progressContainer:{width:"24px",height:"24px"},progress:{height:"1em !important",width:"1em !important",verticalAlign:"middle",color:e.palette.common.white},button:{color:e.palette.common.white,background:e.palette.success.main,borderRadius:"0",paddingRight:"15px",paddingLeft:"15px","&:hover":{background:e.palette.success.dark}},buttonLeft:{float:"right",left:"-3.33px"},buttonRight:{float:"left",right:"-0.67px"},runIcon:{padding:"0px"},dialogPaper:{maxHeight:"80vh",minHeight:"80vh"},dialogActions:{justifyContent:"space-between"},dialogActionsMessage:{fontStyle:"italic",padding:"6px 8px"}}));function Hn(e,n){if(e!=="config")return n}function En(e){const n=Nn(),[i,o]=d.useState(!1),[s,l]=d.useState(!1),[f,a]=d.useState(""),[r,c]=d.useState(""),[u,x]=d.useState(""),[v,b]=d.useState(""),[T,U]=d.useState(!1),[Y,z]=d.useState(!1),[ee,q]=d.useState(!1),[te,V]=d.useState(!1),[O,D]=d.useState(""),[P,m]=d.useState("");d.useEffect(()=>{var h,C,F,$,L;a(((h=e.config)==null?void 0:h.canonical)||""),c(((C=e.config)==null?void 0:C.version)||""),x((($=(F=e.config)==null?void 0:F.fhirVersion)==null?void 0:$.length)>0?e.config.fhirVersion.at(0):""),b(((L=e.config)==null?void 0:L.dependencies)||"")},[e.config]);const S=()=>{o(!0)},p=()=>{o(!1),D("")},y=()=>{l(!0)},I=()=>{l(!1),e.onConfigChange({canonical:f,version:r,fhirVersion:[u],dependencies:v,isGoFSHIndented:T})},N=h=>{const C=h.target.value;a(C)},J=h=>{const C=h.target.value;c(C)},K=h=>{const C=h.target.value;x(C)},_=h=>{const C=h.target.value;b(C)},Z=h=>{const C=h.target.checked;U(C)},re=h=>{const C=h.target.checked;e.setIsLineWrapped(C)},le=h=>{const C=h.target.checked;e.setIsDebugConsoleChecked(C)};async function ce(){if(e.isWaiting)return;e.resetLogMessages(),e.onSUSHIClick(!0,[""],!0),z(!0);const h=Tn(v),C={canonical:f||"http://example.org",version:r||"1.0.0",FSHOnly:!0,fhirVersion:u?[u]:["4.0.1"]},F=await jn(e.fshText,C,h,e.isDebugConsoleChecked?"debug":"info");let $=JSON.stringify(F,Hn,2);F&&F.codeSystems?!F.codeSystems.length&&!F.extensions.length&&!F.instances.length&&!F.profiles.length&&!F.logicals.length&&!F.resources.length&&!F.valueSets.length&&($=[""]):$=[""],e.onSUSHIClick(!0,$,!1),z(!1)}async function de(){if(e.isWaiting)return;e.resetLogMessages(),e.onGoFSHClick("",!0),q(!0);const h=e.gofshText.map(W=>W.def).filter(W=>W),C=v===""?[]:v.split(",").map(W=>W.trim());if(f||r||u!==""){const W={resourceType:"ImplementationGuide",fhirVersion:u?[u]:["4.0.1"],id:"1",...f&&{url:`${f}/ImplementationGuide/1`},...r&&{version:r}};h.push(JSON.stringify(W,null,2))}const F={dependencies:C,indent:T},{fsh:$,config:L}=await bn(h,F,e.isDebugConsoleChecked?"debug":"info");e.onGoFSHClick($,!1),q(!1),f===""&&L.canonical&&a(L.canonical),r===""&&L.version&&c(L.version),u===""&&L.fhirVersion&&x(L.fhirVersion.at(0))}async function ue(h,C){if(!C.endsWith(".fsh"))return;const F=e.exampleMetadata[C];V(!0),m(F.name);const $=new TextDecoder("utf-8");let L=await fetch(F.path).then(Ie=>Ie.body.getReader()),W="";const{value:He}=await L.read();W+=$.decode(He),V(!1),D(W)}function he(h){D(h)}function pe(){navigator.clipboard.writeText(O)}const Ne=h=>t.jsx(ge,{title:e.exampleMetadata[h.id]&&e.exampleMetadata[h.id].description?e.exampleMetadata[h.id].description:h.name,placement:"bottom",arrow:!0,children:t.jsx(et,{nodeId:h.id,label:h.name,className:n.treeItem},h.id)},h.id),ye=h=>t.jsx(et,{nodeId:h.id,label:h.name,children:h.children?h.children.map(C=>C.children?ye(C):Ne(C)):null},h.id);return t.jsxs(R,{className:n.box,children:[t.jsx("div",{className:n.leftControls,children:t.jsxs(k,{name:"Examples",className:n.button,onClick:S,children:[t.jsx(At,{}),"   FSH Examples"]})}),t.jsxs(X,{container:!0,children:[t.jsx(X,{item:!0,xs:5,children:t.jsxs(k,{className:M(n.button,n.buttonLeft),onClick:ce,testid:"Button",children:["Convert to JSON",Y?t.jsx("div",{className:n.progressContainer,children:t.jsx(Qe,{className:n.progress})}):t.jsx(Ye,{className:n.runIcon})]})}),t.jsx(X,{item:!0,xs:7,children:t.jsxs(k,{className:M(n.button,n.buttonRight),onClick:de,testid:"GoFSH-button",children:[ee?t.jsx("div",{className:n.progressContainer,children:t.jsx(Qe,{className:n.progress})}):t.jsx(Ye,{className:n.runIcon,style:{transform:"scaleX(-1)"}}),"Convert to FSH"]})})]}),t.jsxs("div",{className:n.rightControls,children:[t.jsxs(k,{name:"SaveAll",className:n.secondaryButton,onClick:e.saveAll,children:[t.jsx(at,{})," Save All"]}),t.jsxs(k,{name:"Configuration",className:n.secondaryButton,onClick:y,children:[t.jsx(Vt,{})," Configuration"]})]}),t.jsxs(xe,{open:s,onClose:I,"aria-labelledby":"form-dialog-title",children:[t.jsx(me,{id:"form-dialog-title",children:"Configuration Settings"}),t.jsxs(ie,{children:[t.jsx(Fe,{children:"Change the Implementation Guide configuration to use when processing FSH and FHIR JSON"}),t.jsx(be,{id:"canonical",margin:"dense",fullWidth:!0,label:"Canonical URL",helperText:"Default: http://example.org",defaultValue:f,onChange:N}),t.jsx(be,{id:"version",margin:"dense",fullWidth:!0,label:"Version",helperText:"Default: 1.0.0",defaultValue:r,onChange:J}),t.jsxs(be,{id:"fhir-version-select",margin:"dense",fullWidth:!0,select:!0,label:"FHIR Version",helperText:"Default: 4.0.1 (R4)",value:u,onChange:K,children:[t.jsx(Le,{value:"4.0.1",children:"4.0.1 (R4)"}),t.jsx(Le,{value:"4.3.0",children:"4.3.0 (R4B)"}),t.jsx(Le,{value:"5.0.0",children:"5.0.0 (R5)"})]}),t.jsx(be,{id:"dependencies",margin:"dense",fullWidth:!0,label:"Dependencies",helperText:"Format: packageId#version, packageId#version (e.g., hl7.fhir.us.core#6.0.0)",defaultValue:v,onChange:_}),t.jsx(Re,{id:"goFSHIndent",margin:"dense",control:t.jsx(Oe,{checked:T,color:"primary"}),label:"Indent output of Convert to FSH",onChange:Z}),t.jsx($e,{children:"If set, Convert to FSH will output FSH using path rules"}),t.jsx(Re,{id:"lineWrap",margin:"dense",control:t.jsx(Oe,{checked:e.isLineWrapped,color:"primary"}),label:"Line wrap within code editors",onChange:re}),t.jsx($e,{children:"If set, FSH Online will display code with line wrapping"}),t.jsx(Re,{id:"debugLevelConsole",margin:"dense",control:t.jsx(Oe,{checked:e.isDebugConsoleChecked,color:"primary"}),label:"Debug level console messages",onChange:le}),t.jsx($e,{children:"If set, FSH Online will display debug level messages within the console"})]}),t.jsx(Se,{children:t.jsx(k,{onClick:I,color:"primary",children:"Done"})})]}),t.jsxs(xe,{open:i,onClose:p,"aria-labelledby":"form-dialog-title",maxWidth:"lg",fullWidth:!0,scroll:"paper",classes:{paper:n.dialogPaper},children:[t.jsx(me,{id:"form-dialog-title",children:"FSH Examples"}),t.jsx(ie,{children:t.jsxs(X,{container:!0,style:{overflow:"scroll",minHeight:"64vh"},children:[t.jsx(X,{item:!0,xs:4,children:t.jsx(Pt,{className:n.treeView,defaultCollapseIcon:t.jsx(lt,{}),defaultExpandIcon:t.jsx(rt,{}),onNodeSelect:ue,children:e.exampleConfig.map(h=>ye(h))})}),t.jsx(X,{item:!0,xs:8,children:t.jsx(_e,{name:O?P:"",isExamples:!0,value:O,initialText:O,updateTextValue:he,mode:"fsh",placeholder:te?"Fetching example...":"Select an example",isLineWrapped:e.isLineWrapped})})]})}),t.jsxs(Se,{className:n.dialogActions,children:[t.jsxs("div",{className:n.dialogActionsMessage,children:["Have an example that might be bene-fish-al? Seas the day and add to our collection on"," ",t.jsx(it,{href:"https://github.com/FHIR/FSHOnline-Examples#readme",children:"GitHub"}),"!"]}),t.jsxs("div",{children:[t.jsxs(k,{onClick:pe,color:"primary",children:[t.jsx(Ut,{})," Copy to clipboard"]}),t.jsx(k,{onClick:p,color:"secondary",children:"Close"})]})]})]})]})}const Dn=ae(()=>({container:{height:"100%",flexGrow:1},fullHeightGrid:{height:"100%"},editorPane:{flexGrow:"0"},resize:{height:"100%",width:"4px",cursor:"col-resize","&:hover":{background:Je.palette.common.lightBlue}},resizeBlue:{background:"#487AA2"},resizeCursor:{cursor:"col-resize"},collapsedMain:{width:"100%",height:"calc(100vh - 116px - 300px)"},expandedMain:{width:"100%",height:"calc(100vh - 116px - 34px)"},collapsedConsole:{height:"25px",width:"100%"},expandedConsole:{height:"300px",width:"100%"},top:{height:"116px"}})),ft="https://raw.githubusercontent.com/FHIR/FSHOnline-Examples/main",Xe="There are no messages to display in the console.",qe="There are no problems to display in the console.";let je=[Xe],ve=[qe],Ve=0,Pe="#FDD835",xt={};console._stdout={};console.log=console._stdout.write=function(n){n&&(n.startsWith("error")||n.startsWith("warn"))&&(ve[0]===qe&&(ve=[]),Ve++,ve.push(n),n.startsWith("error")&&(Pe="#FD6668")),je[0]===Xe&&(je=[]),je.push(n)};function mt(e){e.forEach(n=>{n.type==="category"&&mt(n.children),n.id=n.path.replaceAll("%20","-"),n.type==="file"&&(xt[n.id]={path:`${ft}/Examples/${n.path}`,description:n.description,name:n.name}),delete n.type,delete n.path})}async function Ln(){let e=await fetch(`${ft}/index.json`).then(n=>n.json());return mt(e.children),[...e.children]}async function Rn(e){if(e==null||e=="")return"";if(e.length===7){const n=await fetch(`/shares/${e}`,{headers:{Accept:"application/text"}}).then(i=>i.ok?i.text():null).catch(()=>null);return n!=null?Te.inflateSync(tt.from(n,"base64")).toString("utf-8"):""}else return Te.inflateSync(tt.from(e,"base64")).toString("utf-8")}async function On(e){const n=await fetch(`https://api.github.com/gists/${e}`).then(o=>o.json());let i="";for(let o of Object.values((n==null?void 0:n.files)||{}))o.truncated?i+=await fetch(o.raw_url).then(s=>s.text()):i+=o.content,i+=`

`;return i.trim()}const St=d.createContext(!1);function Ge(e){const n=Dn(),i=zt(),[o,s]=d.useState(!1),[l,f]=d.useState(""),[a,r]=d.useState([""]),[c,u]=d.useState(""),[x,v]=d.useState(!1),[b,T]=d.useState(!1),[U,Y]=d.useState(!1),[z,ee]=d.useState([]),[q,te]=d.useState({}),[V,O]=d.useState(41.666667),[D,P]=d.useState(!1),[m,S]=d.useState({canonical:"",version:"",fhirVersion:[],dependencies:""}),[p,y]=d.useState({}),[I,N]=d.useState(!1),[J,K]=d.useState(!1),[_,Z]=d.useState(!1);d.useEffect(()=>{async function g(){if(e.path==="share"){const H=await Rn(i["*"]),Q=H.indexOf(`
`),E=H.slice(0,Q);let G,ne=H;try{const B=JSON.parse(E);B.c!=null&&B.v!=null&&B.d!=null&&(G={canonical:B.c,version:B.v,fhirVersion:B.f||[],dependencies:B.d},ne=H.slice(Q+1))}catch{}y(G||{}),u(ne)}else if(e.path==="gist"){const H=await On(i.id);u(H)}}async function j(){ee(await Ln()),te(xt)}g(),j()},[i,e.path]);function re(){je=[Xe],ve=[qe],Ve=0,Pe="#FDD835"}function le(g,j,H){s(g),r(j),v(H)}function ce(g,j){T(j),u(g===""?null:g)}function de(g){(c===""||c===null)&&u(g),f(g)}function ue(g){r(g)}function he(g){S(g),!_&&g.canonical==="ahoy to fsh"&&(console.log("🐟 ahoy to you too! thanks for using FSH ONLINE!"),Z(!0))}function pe(){O(41.666667)}function Ne(g){g.preventDefault(),P(!0)}function ye(g){g.preventDefault(),P(!1)}function h(){P(!0)}function C(){P(!1)}function F(g){N(g)}function $(g){K(g)}function L(g){if(D){const j=g/window.innerWidth*100;j>10&&j<76&&O(j)}}function W(g){const j=g.clientX;D&&w.debounce(()=>L(j),10)()}function He(g){const j=g.touches[0].clientX;D&&w.debounce(()=>L(j),10)()}function Ie(g,j){if(j.get(g)){let H=j.get(g),Q=`${g}-${H}`;for(;j.get(Q);)H=H+1,Q=`${g}-${H}`;j.set(g,H+1),g=Q,j.set(Q,1)}else j.set(g,1);return g}function Ct(){const g=new Map,j=new _t;j.file("FSH.fsh",l);const[H,Q]=w.partition(a,E=>E.id&&E.id!=="Untitled");H.forEach(E=>{let G;try{G=JSON.parse(E.def)}catch{}const ne=Ie(G!=null&&G.resourceType?`${G.resourceType}-${E.id}`:E.id,g),B=E.def??null;j.file(`${ne}.json`,B)}),Q.forEach(E=>{let G;try{G=JSON.parse(E.def)}catch{}const ne=E.id??"Untitled",B=Ie(G.resourceType?`${G.resourceType}-${ne}`:ne,g),yt=E.def??null;j.file(`${B}.json`,yt)}),j.generateAsync({type:"blob"}).then(E=>{Ue.saveAs(E,"fshonline.zip")})}return t.jsx(Jt,{theme:Je,children:t.jsxs("div",{className:"root",style:{height:"100vh"},children:[t.jsxs("div",{className:n.top,children:[t.jsx(en,{sayAhoy:_}),t.jsx(En,{onSUSHIClick:le,onGoFSHClick:ce,onConfigChange:he,config:p,fshText:l,gofshText:a,resetLogMessages:re,exampleConfig:z,exampleMetadata:q,isWaiting:b||x,saveAll:Ct,setIsLineWrapped:F,isLineWrapped:I,setIsDebugConsoleChecked:$,isDebugConsoleChecked:J})]}),t.jsx("div",{className:U?n.collapsedMain:n.expandedMain,children:t.jsx(St.Provider,{value:U,children:t.jsxs(X,{className:M(n.container,D&&n.resizeCursor),container:!0,onTouchMove:He,onMouseMove:W,onMouseUp:ye,onMouseLeave:ye,children:[t.jsx(X,{item:!0,className:M(n.fullHeightGrid,n.editorPane),style:{maxWidth:`calc(${V}% - 2px)`,flexBasis:`calc(${V}% - 2px)`},children:t.jsx(ln,{text:l,initialText:c,updateTextValue:de,isWaiting:b,setInitialText:u,config:m,isLineWrapped:I})}),t.jsx(X,{item:!0,className:M(n.resize,D&&n.resizeBlue),onTouchStart:h,onTouchEnd:C,onMouseDown:Ne,onDoubleClick:pe}),t.jsx(X,{item:!0,className:M(n.fullHeightGrid,n.editorPane),style:{maxWidth:`calc(${100-V}% - 2px)`,flexBasis:`calc(${100-V}% - 2px)`},children:t.jsx(rn,{text:a,showNewText:o,setShowNewText:s,isWaiting:x,updateTextValue:ue,isLineWrapped:I})})]})})}),t.jsx("div",{className:U?n.expandedConsole:n.collapsedConsole,children:t.jsx(dn,{consoleMessages:je,problemMessages:ve,problemCount:Ve,problemColor:Pe,expandConsole:U,setExpandConsole:Y})})]})})}function $n(){return t.jsxs(Xt,{children:[t.jsx(We,{path:"/share/*",element:t.jsx(Ge,{path:"share"})}),t.jsx(We,{path:"/gist/:id",element:t.jsx(Ge,{path:"gist"})}),t.jsx(We,{path:"/*",element:t.jsx(Ge,{})})]})}qt.render(t.jsx(Kt.StrictMode,{children:t.jsx(Zt,{basename:"/",children:t.jsx($n,{})})}),document.getElementById("root"));

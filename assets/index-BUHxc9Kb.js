import{m as re,j as t,A as vt,T as It,B as G,c as V,S as Ye,a as Ke,b as F,E as kt,d as Tt,r as h,e as ge,I as fe,L as Ft,D as xe,f as me,g as ie,h as Te,l as $e,F as ot,C as Nt,i as Se,k as it,n as be,o as Fe,p as Dt,U as Ht,q as rt,s as $t,t as Et,u as Rt,v as at,w as j,x as Je,y as Lt,z as Ot,G as Wt,H as Gt,J as lt,K as At,M as Ie,N as we,O as ct,P as Bt,Q as Mt,R as dt,V as Ne,W as Pt,X as Ee,Y as Vt,Z as Ut,_ as q,$ as Ze,a0 as Qe,a1 as Jt,a2 as Re,a3 as Le,a4 as Oe,a5 as We,a6 as zt,a7 as _t,a8 as et,a9 as Xt,aa as qt,ab as Yt,ac as tt,ad as Kt,ae as Ge,af as Zt,ag as Qt,ah as en}from"./vendor-DUVY72wt.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))o(r);new MutationObserver(r=>{for(const a of r)if(a.type==="childList")for(const c of a.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&o(c)}).observe(document,{childList:!0,subtree:!0});function i(r){const a={};return r.integrity&&(a.integrity=r.integrity),r.referrerPolicy&&(a.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?a.credentials="include":r.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function o(r){if(r.ep)return;r.ep=!0;const a=i(r);fetch(r.href,a)}})();const tn="/assets/FSH-online-logo-BTt1RVAN.png",nn=re(e=>({root:{background:e.palette.common.blue,position:"static",boxShadow:"0"},title:{fontSize:20,fontWeight:700},logo:{height:"55px",width:"63px"},"@keyframes spin-once":{"0%":{rotate:"0deg"},"100%":{rotate:"360deg"}},logoSpin:{animation:"$spin-once 1000ms",animationIterationCount:1},toolbarBox:{alignItems:"center"},exitIcon:{paddingLeft:"3px",transform:"scaleX(-1)"},docButton:{color:e.palette.common.white,backgroundColor:e.palette.common.blue,fontSize:"0.875rem",fontWeight:700,"&:hover":{background:e.palette.common.lightBlue}},versionText:{color:e.palette.common.white,fontSize:"0.8rem",fontStyle:"italic",marginTop:"-5px"}}));function sn(e){const n=nn();return t.jsx(vt,{className:n.root,children:t.jsx(It,{children:t.jsxs(G,{className:n.toolbarBox,display:"flex",flexGrow:1,flexDirection:"row",children:[t.jsxs(G,{order:1,display:"flex",flexGrow:1,flexDirection:"row",children:[t.jsx(G,{order:1,alignSelf:"center",display:"flex",children:t.jsx("img",{src:tn,alt:"logo",className:V(n.logo,{[n.logoSpin]:e.sayAhoy})})}),t.jsx(G,{order:2,alignSelf:"center",m:1,children:t.jsxs(Ye,{injectFirst:!0,children:[t.jsx(Ke,{order:1,className:n.title,children:"FSH ONLINE"}),t.jsx(Ke,{order:2,className:n.versionText,children:"Powered by SUSHI v3.12.0 and GoFSH v2.3.1"})]})})]}),t.jsx(G,{order:1,children:t.jsx(Ye,{injectFirst:!0,children:t.jsxs(F,{className:n.docButton,href:"https://fshschool.org/",target:"_blank",children:[t.jsx(kt,{className:n.exitIcon,fontSize:"small"}),"Back to School"]})})})]})})})}const se={lighterBlue:"#D8E2EA",lightBlue:"#487AA2",blue:"#30638e",darkerBlue:"#143E61",editorGrey:"#263238",lightestGrey:"#E7ECEE",lightGrey:"#D0D9DD",grey:"#575B5C",darkerGrey:"#3D4345",darkestGrey:"#121D21",red:"#FD6668"},ze=Tt({palette:{success:{main:se.blue,dark:se.darkerBlue,light:se.lightBlue},common:se},typography:{fontFamily:"Open Sans"},overrides:{MuiTooltip:{tooltip:{backgroundColor:se.darkestGrey,fontSize:"13px"},arrow:{color:se.darkestGrey}},MuiButton:{text:{textTransform:"none",fontWeight:600}},MuiIconButton:{root:{"&:hover":{backgroundColor:se.grey}}}}}),on=re(e=>({iconButton:{color:e.palette.common.white,padding:"3px"},textArea:{width:"100%",color:e.palette.text.primary,fontWeight:"bold"},copyBox:{backgroundColor:e.palette.common.lightestGrey,borderRadius:2,display:"flex",justifyContent:"space-between",alignItems:"center",paddingLeft:"15px",paddingRight:"5px"},linkBox:{paddingTop:"15px",paddingBottom:"15px",paddingRight:"5px",whiteSpace:"nowrap",overflowX:"scroll",textOverflow:"ellipsis"},copyButton:{padding:"8px",borderRadius:0,"&:hover":{background:e.palette.common.lightGrey}}}));function rn(e){const n=on(),[i,o]=h.useState(!1),[r,a]=h.useState(!1),[c,d]=h.useState(!1),[s,u]=h.useState(!1),[l,p]=h.useState("Copy to Clipboard"),[C,b]=h.useState("Copy Formatted Link to Clipboard"),[{fshCopied:v,fshCopyButton:y},L]=h.useState({fshCopied:!1,fshCopyButton:"Copy FSH to Clipboard"}),[E,Y]=h.useState(),[K,te]=h.useState(),[U,A]=h.useState(!0),O=Z=>{var Q;const _=(Q=Z.target.value.match(/gist\.github\.com\/[^/]+\/(.+)/))==null?void 0:Q[1];_&&te(`https://fshonline.fshschool.org/#/gist/${_}`)},J=()=>{a(!0),m()},m=()=>{o(!1),d(!0),te(""),L({fshCopied:!1,fshCopyButton:"Copy FSH to Clipboard"})},S=()=>{d(!1),a(!1)},f=()=>{K?(S(),Y(K),o(!0),p("Copy to Clipboard"),b("Copy Formatted Link to Clipboard"),A(!1)):u(!0)},I=()=>{u(!1)},T=async()=>{var Q,ae,le,ce,de,ue,he,pe;let Z;(Q=e.config)!=null&&Q.canonical||(ae=e.config)!=null&&ae.version||((le=e.config)==null?void 0:le.fhirVersion.length)>0||(ce=e.config)!=null&&ce.dependencies?Z=Fe.deflateSync(JSON.stringify({c:(de=e.config)==null?void 0:de.canonical,v:(ue=e.config)==null?void 0:ue.version,f:(he=e.config)==null?void 0:he.fhirVersion,d:(pe=e.config)==null?void 0:pe.dependencies})+`
`+e.shareText).toString("base64"):Z=Fe.deflateSync(e.shareText).toString("base64");const _=`https://fshonline.fshschool.org/#/share/${Z}`;_.length>2048?J():(Y(_),o(!0),p("Copy to Clipboard"),b("Copy Formatted Link to Clipboard"),A(!0))},H=()=>{o(!1),a(!1)},z=()=>{L({fshCopied:!0,fshCopyButton:"FSH Copied to Clipboard"})};return t.jsxs(t.Fragment,{children:[t.jsx(ge,{title:"Share FSH",placement:"top",arrow:!0,children:t.jsx(fe,{name:"Share FSH",className:n.iconButton,onClick:T,children:t.jsx(Ft,{fontSize:"small",style:{transform:"rotate(-45deg)"}})})}),t.jsxs(xe,{open:i,onClose:H,"aria-labelledby":"form-dialog-title",maxWidth:"md",fullWidth:!0,children:[t.jsx(me,{id:"form-dialog-title",children:"Share"}),t.jsxs(ie,{children:[t.jsx(Te,{children:"Use this link to share your FSH with others!"}),t.jsxs(G,{className:n.copyBox,children:[t.jsx(G,{className:n.linkBox,children:E}),t.jsxs(G,{sx:{display:"flex",flexWrap:"nowrap"},children:[t.jsx(ge,{title:l,placement:"top",arrow:!0,children:t.jsx(fe,{className:n.copyButton,children:t.jsx($e.CopyToClipboard,{text:E,onCopy:()=>p("Link Copied"),children:t.jsx(ot,{fontSize:"small"})})})}),t.jsx(ge,{title:C,placement:"top",arrow:!0,children:t.jsx(fe,{className:n.copyButton,children:t.jsx($e.CopyToClipboard,{text:`[FSH Online Link](${E})`,onCopy:()=>b("Link Copied"),options:{format:"text/plain"},children:t.jsx(Nt,{fontSize:"small"})})})})]})]})]}),t.jsxs(Se,{children:[U&&t.jsx(F,{onClick:m,color:"primary",style:{align:"left"},children:"Create Link with Gist"}),t.jsx(G,{style:{flex:"1 0 0",hidden:!0}}),t.jsx(F,{onClick:H,color:"primary",children:"Done"})]})]}),t.jsxs(xe,{open:c,onClose:S,"aria-labelledby":"alert-dialog-title",maxWidth:"md",fullWidth:!0,children:[t.jsx(me,{id:"alert-dialog-title",children:"Share with Gist"}),r&&t.jsx(ie,{style:{color:ze.palette.common.red},children:"Your FSH content is too long to share directly. Please use a Gist to share."}),t.jsxs(ie,{children:["Create a"," ",t.jsx(it,{id:"gistURL",href:"https://gist.github.com/",target:"_blank",children:"Gist"})," ","and paste the URL below to generate a shareable FSH Online link.",t.jsx(be,{id:"gistURLText",label:"Gist URL",fullWidth:!0,onChange:O})]}),t.jsxs(Se,{style:{bottom:0,right:0},children:[t.jsx(F,{onClick:S,color:"primary",children:"Cancel"}),t.jsx(G,{style:{flex:"1 0 0",hidden:!0}}),t.jsx($e.CopyToClipboard,{text:e.shareText,onCopy:z,style:{align:"left"},children:t.jsx(F,{color:v?"secondary":"primary",children:y})}),t.jsx(F,{color:"primary",onClick:f,style:{align:"left"},children:"Generate Link from Gist"})]})]}),t.jsxs(xe,{open:s,onClose:I,"aria-labelledby":"alert-dialog-title",maxWidth:"lg",children:[t.jsx(me,{id:"alert-dialog-title",children:"Error Creating Gist Link"}),t.jsx(ie,{children:t.jsx(Te,{children:"Could not generate a link from your Gist URL. Ensure the URL is valid."})}),t.jsx(Se,{children:t.jsx(F,{onClick:I,color:"primary",children:"Keep Swimming!"})})]})]})}Dt.defineSimpleMode("fsh",{meta:{lineComment:"//"},start:[{regex:/"(?:[^\\]|\\.)*?(?:"|$)/,token:"atom"},{regex:/\b(Alias|Characteristics|Context|CodeSystem|Expression|Extension|Description|Id|Instance|InstanceOf|Invariant|Logical|Mapping|Mixins|Parent|Profile|Resource|RuleSet|Severity|Source|Target|Title|Usage|ValueSet|XPath)(?=\s*:)\b/,token:"keyword"},{regex:/(\s|^)(and|codes|contains|descendent-of|exclude|exists|from system|from|generalizes|include|in|insert|is-a|is-not-a|named|not-in|obeys|only|or|regex|units|valueset|where|D|MS|N|SU|TU|\\?!)(\s|$)/,token:"def"},{regex:/(\(\s*)(exactly|example|extensible|preferred|required)(\s*\))/,token:"def"},{regex:/\b(CodeableReference|Reference|Canonical)\s*\(/,push:"closingParen",token:"atom"},{regex:/\*|->|=|\+|:/,token:"def"},{regex:/\b(https?:\/\/(www\.)?[-a-zA-Z0-9@:%._+~#=]{2,256}\.[a-z]{2,6}\b([-a-zA-Z0-9@:%_+.~#?&//=]*))\b/,token:"atom"},{regex:/(\s|^)(true|false)(\s|$)/,token:"string"},{regex:/(\s|^)(-?\d+(\.\d+)?)(\s|^)/,token:"string"},{regex:/#"(?:\\.|[^\\"])*"/,token:"string"},{regex:/#[^\s]*/,token:"string"},{regex:/'.*'/,token:"string"},{regex:/\s\/\/.*/,token:"comment"},{regex:/\/\/.*/,token:"comment",sol:!0},{regex:/\/\*/,token:"comment",next:"comment"}],closingParen:[{regex:/\)/,pop:!0,token:"atom"}],comment:[{regex:/.*?\*\//,token:"comment",next:"start"},{regex:/.*/,token:"comment"}]});const Ce=200,an=re(e=>({box:{height:"100%"},header:{fontFamily:"Open Sans",color:e.palette.common.white,background:e.palette.common.darkerGrey,padding:"0px",paddingLeft:"29px",height:"34px",display:"flex",justifyContent:"space-between",transition:e.transitions.create(["margin","width"],{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen})},headerShift:{width:`calc(100% - ${Ce}px - 29px)`,transition:e.transitions.create(["margin","width"],{easing:e.transitions.easing.easeOut,duration:e.transitions.duration.enteringScreen}),marginRight:Ce},headerLabel:{lineHeight:"34px",float:"left",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},headerActionGroup:{paddingRight:"10px"},headerActions:{alignItems:"center",display:"flex"},iconButton:{color:e.palette.common.white,padding:"3px"},drawer:{width:Ce,flexShrink:0},drawerPaper:{width:Ce,border:"none",height:"calc(100vh - 116px - 34px)",top:"116px"},drawerPaperExpandedConsole:{height:"calc(100vh - 116px - 300px)"},drawerHeader:{display:"flex",alignItems:"center",justifyContent:"flex-start",color:e.palette.common.white,background:e.palette.common.darkerGrey,height:"34px",minHeight:"34px"},drawerHeaderIcon:{padding:"0px",color:e.palette.common.white,background:e.palette.success.main,"&:hover":{background:e.palette.success.light},borderRadius:0,height:"100%",width:"34px",minWidth:"34px"},content:{flexGrow:1,width:"100%",transition:e.transitions.create(["margin","width"],{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen})},contentShift:{width:`calc(100% - ${Ce}px)`,transition:e.transitions.create(["margin","width"],{easing:e.transitions.easing.easeOut,duration:e.transitions.duration.enteringScreen}),marginRight:0}}));function _e(e){const n=an(),i=h.useContext(bt),[o,r]=h.useState(!0),a=()=>{r(!0)},c=()=>{r(!1)};function d(p){e.updateTextValue(p)}const s=(p,C,b,v={})=>t.jsx(ge,{title:j.upperFirst(C),placement:"top",arrow:!0,children:t.jsx(fe,{name:C,className:n.iconButton,"aria-label":C,onClick:b,children:t.jsx(p,{fontSize:"small",style:v})})}),u=()=>t.jsxs("div",{className:n.headerActions,children:[t.jsxs("div",{className:n.headerActionGroup,children:[e.mode==="fsh"&&!e.isExamples&&t.jsx(rn,{shareText:e.value,config:e.config}),e.copy&&s(ot,"copy",()=>{}),e.save&&s(rt,"save",e.save),e.delete&&s($t,"delete",e.delete)]}),e.renderDrawer&&!o&&t.jsx(fe,{name:"expand",className:n.drawerHeaderIcon,"aria-label":"expand",onClick:a,children:t.jsx(Et,{})})]}),l=()=>t.jsxs(Rt,{className:n.drawer,"data-testid":"editor-drawer",variant:"persistent",anchor:"right",open:o,classes:{paper:V(n.drawerPaper,i&&n.drawerPaperExpandedConsole)},children:[t.jsx("div",{className:n.drawerHeader,children:t.jsx(F,{name:"collapse","aria-label":"collapse",className:n.drawerHeaderIcon,onClick:c,children:t.jsx(at,{})})}),e.renderDrawer()]});return t.jsxs(G,{className:n.box,children:[t.jsxs("div",{className:V(n.header,{[n.headerShift]:e.renderDrawer&&o}),children:[t.jsx("div",{title:e.name,className:n.headerLabel,children:e.name}),u()]}),t.jsx(Ht,{className:V("react-codemirror2",e.renderDrawer&&n.content,{[n.contentShift]:e.renderDrawer&&o}),value:e.initialText,options:{mode:e.mode,theme:"material",placeholder:e.placeholder,scrollbarStyle:"overlay",autoCloseBrackets:!0,lineNumbers:!0,foldGutter:!0,readOnly:e.isExamples,gutters:["CodeMirror-linenumbers","CodeMirror-foldgutter"],extraKeys:{Tab:p=>{p.replaceSelection("  ")},"Ctrl-/":"toggleComment","Cmd-/":"toggleComment","Ctrl-Q":p=>{p.foldCode(p.getCursor())}},lineWrapping:e.isLineWrapped},onChange:(p,C,b)=>{d(b)}}),e.renderDrawer&&l()]})}function ut(e){return t.jsxs(xe,{open:e.isOpen,onClose:e.handleCloseModal,"aria-labelledby":"delete-confirmation-dialog",children:[t.jsxs(me,{id:"delete-confirmation-dialog-title",children:["Delete ",e.title]}),t.jsx(ie,{children:t.jsxs(Te,{children:["Are you sure you want to delete ",e.item,"? This action cannot be undone."]})}),t.jsxs(Se,{children:[t.jsx(F,{onClick:e.handleCloseModal,color:"primary",children:"Cancel"}),t.jsx(F,{onClick:e.handleDelete,color:"secondary",children:"Delete"})]})]})}const ln=re(e=>({fileTreeContent:{overflowY:"scroll",height:"100%"},button:{color:e.palette.common.white,background:e.palette.success.main,"&:hover":{background:e.palette.success.dark},border:"8px solid white",fontSize:"13px",width:"100%"},list:{padding:"8px",paddingLeft:"0px",paddingBottom:"0px",fontSize:"13px"},listItemError:{paddingTop:"5px",paddingBottom:"5px",margin:0},listItem:{background:e.palette.common.lightestGrey,paddingTop:"5px",paddingBottom:"5px",marginTop:"5px",marginBottom:"5px",paddingLeft:"5px",margin:0,"&:hover":{background:e.palette.common.lightGrey},display:"block",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},listItemSelected:{background:e.palette.common.editorGrey,color:e.palette.common.white,"&:hover":{background:e.palette.common.darkestGrey}},listHeader:{padding:"5px",paddingLeft:"15px"},listIcon:{color:e.palette.success.main,verticalAlign:"middle",fontSize:"13px",paddingLeft:"3px",paddingRight:"3px"},listIconError:{color:e.palette.common.red},blankIcon:{paddingLeft:"19px"}})),Be=e=>{if(e.resourceType==="ValueSet"||e.resourceType==="CodeSystem")return e.resourceType;if(e.resourceType==="StructureDefinition"){if(e.derivation==="specialization"){if(e.kind==="resource")return"Resource";if(e.kind==="logical")return"Logical Model"}else if(e.derivation==="constraint"){if(e.kind==="complex-type"&&e.type==="Extension")return"Extension";if(["resource","complex-type","primitive-type","logical"].includes(e.kind))return"Profile"}}return e.resourceType!=null?"Instance":null},Me=e=>{if(e.id)if(typeof e.id=="object"){if(e.id.value)return e.id.value}else return e.id;return e.resourceType?`Instance of ${e.resourceType.substring(e.resourceType.lastIndexOf("/")+1)}`:"Untitled"},cn=e=>[...e.profiles,...e.extensions,...e.logicals,...e.resources,...e.instances,...e.valueSets,...e.codeSystems].map(i=>({resourceType:Be(i),id:Me(i),def:JSON.stringify(i,null,2)}));function dn(e){const n=ln(),[i,o]=h.useState(""),[r,a]=h.useState([{resourceType:null,id:"Untitled",def:null}]),{setShowNewText:c,updateTextValue:d}=e,[s,u]=h.useState(0),[l,p]=h.useState([]),[C,b]=h.useState(!1);h.useEffect(()=>{if(e.showNewText&&!j.isEqual(e.text,[""])){c(!1);let m;try{m=JSON.parse(e.text)}catch{m={profiles:[],extensions:[],logicals:[],resources:[],instances:[],valueSets:[],codeSystems:[]}}const S=cn(m);a(S),u(0),o(S.length>0?S[0].def:""),d(S)}else e.isWaiting&&(o(null),a([]))},[e.text,e.showNewText,e.isWaiting,d,c]);const v=m=>{if(e.isWaiting)return;const S=[...r];try{const f=m===""?{}:JSON.parse(m);if(l.includes(s)){const I=[...l];I.splice(l.indexOf(s),1),p(I)}r[s]||(S[s]={resourceType:Be(f),id:Me(f)}),(!r[s]||f.resourceType!==r[s].resourceType)&&(S[s].resourceType=Be(f)),(!r[s]||f.id!==r[s].id)&&(S[s].id=Me(f))}catch{if(!l.includes(s)){const I=[...l];I.push(s),p(I)}}S[s]&&(S[s].def=m),a(S),e.updateTextValue(S),i===null&&o(m)},y=()=>{const m=[...r];m.push({resourceType:null,id:"Untitled",def:null}),u(m.length-1),a(m),o(null),e.updateTextValue(m)},L=()=>{const m=s,S=[...r];if(S.splice(m,1),S.length===0&&S.push({resourceType:null,id:"Untitled",def:null}),a(S),m<=s){let T=0;m<s&&(T=s-1),u(T);const H=S.length>0?S[T].def:null;o(H)}const f=[...l];l.includes(m)&&f.splice(l.indexOf(m),1);const I=f.map(T=>T<m?T:T-1);p(I),b(!1),e.updateTextValue(S)},E=()=>{b(!0)},Y=()=>{b(!1)},K=(m,S)=>{let f;try{f=JSON.parse(m)}catch{}Je.saveAs(new Blob([m]),f!=null&&f.resourceType&&(f!=null&&f.id)?`${f.resourceType}-${f.id}.json`:`${S}.json`)},te=()=>{const m=r[s];if(!m)return;const S=m.resourceType||"Unknown Type",f=m.id||"Untitled";return t.jsx(ut,{title:"FHIR JSON",item:`${S} ${f}`,isOpen:C,handleCloseModal:Y,handleDelete:L})},U=()=>{const m=["Profiles","Extensions","Logical Models","Resources","ValueSets","CodeSystems","Instances","Unknown Type"],S=j.groupBy(r,f=>f&&f.resourceType?`${f.resourceType}s`:"Unknown Type");return Object.keys(S).sort((f,I)=>m.indexOf(f)-m.indexOf(I)).map(f=>t.jsxs(Ot,{component:"nav",className:n.list,children:[t.jsx("div",{className:n.listHeader,children:f}),S[f].sort((I,T)=>{const H=I.id?I.id:"Untitled",z=T.id?T.id:"Untitled";return H.toLowerCase()<z.toLowerCase()?-1:H.toLowerCase()>z.toLowerCase()?1:0}).map((I,T)=>{const H=r.indexOf(I),z=l.includes(H);return t.jsxs(Wt,{button:!0,title:(I==null?void 0:I.id)||"Untitled","data-testid":`${f}-defId`,className:V(n.listItem,z&&n.listItemError,H===s&&n.listItemSelected),onClick:()=>{u(H),o(I.def)},children:[l.includes(H)?t.jsx(ge,{title:"Invalid JSON",placement:"top",arrow:!0,children:t.jsx(Gt,{className:V(n.listIcon,n.listIconError)})}):t.jsx("span",{className:n.blankIcon}),(I==null?void 0:I.id)||"Untitled"]},T)})]},f))},A=()=>t.jsxs(t.Fragment,{children:[t.jsx(F,{className:n.button,startIcon:t.jsx(Lt,{}),onClick:y,children:"New JSON Editor"}),t.jsx("div",{className:n.fileTreeContent,children:U()})]}),O=r.length>0?r[s].def:null,J=`${r.length>0?r[s].id:"Untitled"}`;return t.jsxs(t.Fragment,{children:[t.jsx(_e,{name:`FHIR JSON: ${J}`,value:O,initialText:i,updateTextValue:v,mode:"application/json",placeholder:e.isWaiting?"Loading...":`Paste or edit single FHIR JSON artifact here... 
Create additional FHIR JSON artifacts to the right.`,renderDrawer:A,isExamples:!1,delete:E,save:()=>K(O,J),isLineWrapped:e.isLineWrapped}),C&&te()]})}function un(e){const[n,i]=h.useState(!1),o=()=>{i(!n)},r=()=>{i(!1),e.setInitialText("")},a=()=>{Je.saveAs(new Blob([e.text]),"FSH.fsh")};return t.jsxs(t.Fragment,{children:[t.jsx(_e,{name:"FSH",isExamples:!1,value:e.text,initialText:e.initialText,updateTextValue:e.updateTextValue,mode:"fsh",placeholder:e.isWaiting?"Loading...":"Paste or edit FSH here...",delete:o,save:a,config:e.config,isLineWrapped:e.isLineWrapped}),n&&t.jsx(ut,{title:"FHIR Shorthand",item:"all FSH",isOpen:n,handleCloseModal:o,handleDelete:r})]})}const hn=re(e=>({consoleControls:{background:e.palette.common.darkestGrey,height:"34px",boxSizing:"border-box",display:"flex;",alignItems:"center",justifyContent:"left"},box:{paddingLeft:"29px",color:e.palette.common.white,background:e.palette.common.darkestGrey,height:"calc(100% - 34px)",overflow:"scroll",boxSizing:"border-box"},button:{marginRight:"10px",color:e.palette.common.white,textTransform:"none",padding:0},problemsButton:{padding:0,color:e.palette.common.white,textTransform:"none"},expandIcon:{width:"29px",color:e.palette.common.white,padding:0},pre:{margin:"0px"},circle:{"border-radius":"50%","border-style":"solid","border-width":"2px","min-width":"20px",height:"20px",paddingLeft:1,paddingRight:1,background:"#263238","align-items":"center",display:"flex",marginLeft:4,"justify-content":"center",padding:0}}));function pn(e){const n=hn(),[i,o]=h.useState(!1),{problemCount:r,setExpandConsole:a}=e;h.useEffect(()=>{r&&a(!0)},[r,a]);const c=()=>{e.setExpandConsole(!e.expandConsole)},d=()=>{o(!1),e.setExpandConsole(!0)},s=()=>{o(!0),e.setExpandConsole(!0)};return t.jsxs(t.Fragment,{children:[t.jsxs(G,{className:n.consoleControls,children:[t.jsx(fe,{onClick:c,"aria-label":e.expandConsole?"collapse console":"expand console",className:n.expandIcon,children:e.expandConsole?t.jsx(lt,{}):t.jsx(At,{})}),t.jsx(F,{onClick:d,className:n.button,children:t.jsx("p",{style:{borderBottom:e.expandConsole&&!i?"1px solid white":"none",margin:"0"},children:"Console"})}),t.jsxs(F,{onClick:s,className:n.problemsButton,children:[t.jsx("p",{style:{borderBottom:e.expandConsole&&i?`1px solid ${e.problemCount?e.problemColor:"white"}`:"none",margin:"0"},children:"Problems"}),t.jsx("div",{className:n.circle,style:{borderColor:`${e.problemCount?e.problemColor:"white"}`},children:e.problemCount})]})]}),t.jsx(G,{style:{display:e.expandConsole?"block":"none"},className:n.box,children:i?e.problemMessages.map((u,l)=>t.jsx("pre",{className:n.pre,children:u},l)):e.consoleMessages.map((u,l)=>t.jsx("pre",{className:n.pre,children:u},l))})]})}let D=Ie.logger;function ht(e,n){e==="sushi"?D=Ie.logger:e==="gofsh"&&(D=we.logger),D.level=n}function gn(e,n,i){let o={resourceArr:e,emptyDependencies:[]};return new Promise(r=>{ct.get(`https://packages.fhir.org/${n}/${i}`,function(a){const c=Bt.extract();c.on("entry",function(d,s,u){let l="";s.on("data",function(p){l+=p.toString()}),s.on("end",function(){try{const p=JSON.parse(l);p.resourceType&&o.resourceArr.push(p)}catch{}u()}),s.resume()}),c.on("finish",function(){r(o)}),a.statusCode<400?(a.pipe(Mt.createGunzip()).pipe(c),D.info(`Downloaded ${n}#${i}`)):(i==="current"||i==="dev"?D.error('FSHOnline does not currently support "current" or "dev" package versions'):(D.error(`Your dependency ${n}#${i} could not be loaded. Your output may be invalid.`),o.emptyDependencies.push(`${n}${i}`)),r(o))}).on("error",a=>{D.error("An error occurred while downloading FHIR packages. Your output may be invalid: ",a),o.emptyDependencies.push(`${n}${i}`),r(o)})})}function fn(e,n,i,o){return new Promise((r,a)=>{const c=e.transaction([`${i}${o}`],"readwrite");c.oncomplete=()=>{r()},c.onerror=s=>{a(s)};const d=c.objectStore(`${i}${o}`,{keyPath:["id","resourceType"]});n.forEach(s=>{s.id&&s.resourceType&&d.put(s)})})}function xn(e,n,i,o){return new Promise((r,a)=>{let c=!1;const d=n.transaction([`${i}${o}`],"readonly").objectStore(`${i}${o}`,{keyPath:["id","resourceType"]}).openCursor();d.onerror=function(){a("There is an error getting data out!")},d.onsuccess=function(){const s=d.result;s?(c=!0,e.add(s.value),s.continue()):(c&&D.info(`Loaded package ${i}#${o}`),r(e))}})}function mn(e){return new Promise((n,i)=>{const{packageId:o,isAutomatic:r}=e;ct.get(`https://packages.fhir.org/${o}`,function(a){let c="";a.on("data",function(d){c+=d}),a.on("end",function(){var s,u;const d=JSON.parse(c);(u=(s=d==null?void 0:d["dist-tags"])==null?void 0:s.latest)!=null&&u.length?n(d["dist-tags"].latest):(D.error(`Could not determine latest released version of ${r?"automatically-loaded dependency ":""}${o}.`),i("no latest version found"))})})})}const Sn=dt.FHIRDefinitions,yn=Ne.FSHTank,Cn=Ne.importText;function bn(e,n){D.info("Importing FSH text...");const i=Cn(e);return new yn(i,n)}async function pt(e,n){n=await vn(n);let i=await jn(n),o={defs:e,emptyDependencies:[]};return i.shouldUpdate?(o=await nt(e,i.version+1,n),e=o.defs):(o=await nt(e,i.version,n),e=o.defs),await wn(o.emptyDependencies,i.version+2),e}function wn(e,n,i="FSH Playground Dependencies"){const o=j.flatten(e);return new Promise((r,a)=>{let c=null;const d=indexedDB.open(i,n);d.onsuccess=function(s){c=s.target.result,c.close(),r()},d.onupgradeneeded=async function(s){c=s.target.result;let u=c.objectStoreNames;for(let l of u)await new Promise(p=>{const b=s.target.transaction.objectStore(`${l}`).getAll();b.onsuccess=v=>{v.target.result.length===0&&!o.includes(l)&&o.push(l),p()}});for(let l=0;l<o.length;l++)u.contains(o[l])&&c.deleteObjectStore(o[l])},d.onerror=function(s){a(s)}})}function jn(e,n="FSH Playground Dependencies"){let i={shouldUpdate:!1,version:1};return new Promise((o,r)=>{let a=null;const c=indexedDB.open(n);c.onsuccess=function(d){a=d.target.result;let s=a.objectStoreNames;i.version=a.version,s.length===0||e.length===0||s.contains("resources")?(i.shouldUpdate=!0,a.close(),o(i)):(e.forEach(u=>{const{packageId:l,version:p}=u;s.contains(`${l}${p}`)||(i.shouldUpdate=!0)}),a.close(),o(i))},c.onupgradeneeded=function(d){a=d.target.result},c.onerror=function(d){r(d)}})}async function nt(e,n,i,o="FSH Playground Dependencies",r=!1){return new Promise((a,c)=>{let d=null,s=[],u={defs:Sn,emptyDependencies:[]};const l=indexedDB.open(o,n);l.onsuccess=async function(p){d=p.target.result;for(let C=0;C<i.length;C++){let b=[];r=!1;const{packageId:v,version:y}=i[C];if(s.includes(`${v}${y}`)&&(r=!0),r){let L=await gn(b,v,y);L.emptyDependencies.length!==0&&u.emptyDependencies.push(L.emptyDependencies),await fn(d,L.resourceArr,v,y)}u.defs=await xn(e,d,v,y)}d.close(),a(u)},l.onupgradeneeded=function(p){d=p.target.result;let C=d.objectStoreNames;C.contains("resources")&&d.deleteObjectStore("resources");for(let b=0;b<i.length;b++){const{packageId:v,version:y}=i[b];C.contains(`${v}${y}`)||(d.createObjectStore(`${v}${y}`,{keyPath:["id","resourceType"]}),s.push(`${v}${y}`))}},l.onerror=function(p){c(p)}})}async function vn(e){return(await Promise.all(e.map(async o=>In(o)))).filter(o=>o.version!==null)}async function In(e){const{packageId:n,version:i}=e;let o=i;return i==="latest"&&await mn(e).then(r=>{o=r}).catch(()=>{o=null}),{packageId:n,version:o}}function gt(e){return e.split(",").map(i=>{const o=i.trim();if(o==="")return o;const[r,a]=o.split("#");return{packageId:r,version:a}}).filter(i=>i)}const kn=Ne.FSHTank,Tn=Ne.RawFSH,Fn=Pt.exportFHIR,Pe=Ie.stats,oe=we.stats,ft=Ie.getRandomPun,Nn=Ie.Type,xt=dt.FHIRDefinitions;async function Dn(e,n,i){oe.reset(),ht("gofsh",i);const o=[];e.forEach((y,L)=>{const E=`Input_${L}`;try{y=JSON.parse(y),y.resourceType||D.error(`FHIR JSON ${y.id??E} is missing the required "resourceType" property`)}catch{D.error(`Could not parse ${E} to JSON`);return}we.isProcessableContent(y,E)&&o.push(new Ee.WildFHIR({content:y},E))});const r=new Ee.LakeOfFHIR(o);let a=new xt;const c=new we.MasterFisher(r,a),d=new Ee.FHIRProcessor(r,c),s=n.dependencies.map(y=>y.replace("#","@")),u=d.processConfig(s??[]);let l=u!=null&&u.config.dependencies?u==null?void 0:u.config.dependencies.map(y=>`${y.packageId}#${y.version}`):[];l=gt(l.join(","));const p=(u==null?void 0:u.config.fhirVersion[0])??"4.0.1",C=mt(l,p);l.push(...C),a=await pt(a,l);const b=await we.getResources(d,u,{indent:n.indent}),v=new Vt.FSHExporter(b).apiExport("string");return D.info("Done converting definitions"),En(b),{fsh:v,config:(u==null?void 0:u.config)??{}}}async function Hn(e,n,i=[],o){Pe.reset(),ht("sushi",o);let r=new xt;const a=mt(i,n.fhirVersion[0]);i.push(...a),r=await pt(r,i);let c=kn;try{const l=[new Tn(e)];c=bn(l,n)}catch{D.error("Something went wrong when importing the FSH definitions");return}const d=r.fishForFHIR("StructureDefinition",Nn.Resource);if((d==null?void 0:d.version)!==n.fhirVersion[0]){D.error("StructureDefinition resource not found. The FHIR package in the browser cache may be corrupt. Clear cookies and site data on this webpage to reload the FHIR package.");return}D.info("Converting FSH to FHIR resources...");const s=Fn(c,r),u=s.profiles.length+s.extensions.length+s.logicals.length+s.resources.length+s.instances.filter(l=>l._instanceMeta.usage!=="Inline").length+s.valueSets.length+s.codeSystems.length;return D.info(`Exported ${u} FHIR resources as JSON.`),console.log(" "),$n(s),s.profiles=s.profiles.map(l=>l.toJSON(!1)),s.extensions=s.extensions.map(l=>l.toJSON(!1)),s.logicals=s.logicals.map(l=>l.toJSON(!1)),s.resources=s.resources.map(l=>l.toJSON(!1)),s.instances=s.instances.filter(l=>l._instanceMeta.usage!=="Inline"),s}function $n(e){const n=Pe.numError,i=Pe.numWarn,o=j.pad(e.profiles.length.toString(),13),r=j.pad(e.extensions.length.toString(),12),a=j.pad(e.logicals.length.toString(),12),c=j.pad(e.resources.length.toString(),13),d=j.pad(e.valueSets.length.toString(),18),s=j.pad(e.codeSystems.length.toString(),17),u=j.pad(e.instances.length.toString(),18),l=j.pad(`${n} Error${n!==1?"s":""}`,13),p=j.padStart(`${i} Warning${i!==1?"s":""}`,12),C=j.padEnd(ft(n,i),36);["â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• SUSHI RESULTS â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—","â•‘ â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•® â•‘","â•‘ â”‚    Profiles   â”‚  Extensions  â”‚   Logicals   â”‚   Resources   â”‚ â•‘","â•‘ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â•‘",`â•‘ â”‚ ${o} â”‚ ${r} â”‚ ${a} â”‚ ${c} â”‚ â•‘`,"â•‘ â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯ â•‘","â•‘ â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•® â•‘","â•‘ â”‚      ValueSets     â”‚    CodeSystems    â”‚     Instances      â”‚ â•‘","â•‘ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â•‘",`â•‘ â”‚ ${d} â”‚ ${s} â”‚ ${u} â”‚ â•‘`,"â•‘ â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯ â•‘","â•‘                                                                 â•‘","â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£",`â•‘ ${C} ${l} ${p} â•‘`,"â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"].forEach(v=>console.log(v))}function En(e){const n=j.pad(e.profiles.length.toString(),18),i=j.pad(e.extensions.length.toString(),17),o=j.pad(e.logicals.length.toString(),18),r=j.pad(e.resources.length.toString(),18),a=j.pad(e.valueSets.length.toString(),17),c=j.pad(e.codeSystems.length.toString(),18),d=j.pad(e.instances.length.toString(),18),s=j.pad(e.invariants.length.toString(),17),u=j.pad(e.mappings.length.toString(),18),l=j.pad(`${oe.numError} Error${oe.numError!==1?"s":""}`,12),p=j.padStart(`${oe.numWarn} Warning${oe.numWarn!==1?"s":""}`,12),C=j.padEnd(ft(oe.numError,oe.numWarn),37),b=["â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• GoFSH RESULTS â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—","â•‘ â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•® â•‘","â•‘ â”‚      Profiles      â”‚    Extensions     â”‚      Logicals      â”‚ â•‘","â•‘ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â•‘",`â•‘ â”‚ ${n} â”‚ ${i} â”‚ ${o} â”‚ â•‘`,"â•‘ â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯ â•‘","â•‘ â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•® â•‘","â•‘ â”‚     Resources      â”‚     ValueSets     â”‚     CodeSystems    â”‚ â•‘","â•‘ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â•‘",`â•‘ â”‚ ${r} â”‚ ${a} â”‚ ${c} â”‚ â•‘`,"â•‘ â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯ â•‘","â•‘ â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•® â•‘","â•‘ â”‚     Instances      â”‚    Invariants     â”‚      Mappings      â”‚ â•‘","â•‘ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â•‘",`â•‘ â”‚ ${d} â”‚ ${s} â”‚ ${u} â”‚ â•‘`,"â•‘ â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯ â•‘","â•‘                                                                 â•‘","â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£",`â•‘ ${C} ${l} ${p} â•‘`,"â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"];console.log(" "),b.forEach(v=>console.log(v))}function mt(e,n){const i=[],o={packageId:Rn(n),version:n};return st(e,o)||i.push(o),Ln.filter(a=>a.fhirVersions==null||a.fhirVersions.some(c=>o.version.startsWith(c))).forEach(a=>{const c={packageId:a.packageId,version:a.version,isAutomatic:!0};st(e,c,!0)||i.push(c)}),i}function st(e,n,i=!1){return e.some(o=>o.packageId===n.packageId&&(i||o.version===n.version))}function Rn(e){return/^4\.0\.1$/.test(e)?"hl7.fhir.r4.core":/^4\.3\.\d+$/.test(e)?"hl7.fhir.r4b.core":/^5\.0\.\d+$/.test(e)?"hl7.fhir.r5.core":"hl7.fhir.r4.core"}const Ln=[{packageId:"hl7.fhir.uv.tools",version:"latest"},{packageId:"hl7.terminology.r4",version:"latest",fhirVersions:["4.0","4.3"]},{packageId:"hl7.terminology.r5",version:"latest",fhirVersions:["5.0"]},{packageId:"hl7.fhir.uv.extensions.r4",version:"latest",fhirVersions:["4.0","4.3"]},{packageId:"hl7.fhir.uv.extensions.r5",version:"latest",fhirVersions:["5.0"]}],On=re(e=>({box:{padding:e.spacing(1),color:e.palette.text.primary,background:e.palette.background.paper,display:"flex;",alignItems:"center",justifyContent:"center"},rightControls:{position:"absolute",right:"24px"},leftControls:{position:"absolute",left:"28px"},secondaryButton:{color:e.palette.success.main,"&:hover":{background:e.palette.common.lighterBlue}},progressContainer:{width:"24px",height:"24px"},progress:{height:"1em !important",width:"1em !important",verticalAlign:"middle",color:e.palette.common.white},button:{color:e.palette.common.white,background:e.palette.success.main,borderRadius:"0",paddingRight:"15px",paddingLeft:"15px","&:hover":{background:e.palette.success.dark}},buttonLeft:{float:"right",left:"-3.33px"},buttonRight:{float:"left",right:"-0.67px"},runIcon:{padding:"0px"},dialogPaper:{maxHeight:"80vh",minHeight:"80vh"},dialogActions:{justifyContent:"space-between"},dialogActionsMessage:{fontStyle:"italic",padding:"6px 8px"}}));function Wn(e,n){if(e!=="config")return n}function Gn(e){const n=On(),[i,o]=h.useState(!1),[r,a]=h.useState(!1),[c,d]=h.useState(""),[s,u]=h.useState(""),[l,p]=h.useState(""),[C,b]=h.useState(""),[v,y]=h.useState(!1),[L,E]=h.useState(!1),[Y,K]=h.useState(!1),[te,U]=h.useState(!1),[A,O]=h.useState(""),[J,m]=h.useState("");h.useEffect(()=>{var g,w,N,B,W;d(((g=e.config)==null?void 0:g.canonical)||""),u(((w=e.config)==null?void 0:w.version)||""),p(((B=(N=e.config)==null?void 0:N.fhirVersion)==null?void 0:B.length)>0?e.config.fhirVersion.at(0):""),b(((W=e.config)==null?void 0:W.dependencies)||"")},[e.config]);const S=()=>{o(!0)},f=()=>{o(!1),O("")},I=()=>{a(!0)},T=()=>{a(!1),e.onConfigChange({canonical:c,version:s,fhirVersion:[l],dependencies:C,isGoFSHIndented:v})},H=g=>{const w=g.target.value;d(w)},z=g=>{const w=g.target.value;u(w)},Z=g=>{const w=g.target.value;p(w)},_=g=>{const w=g.target.value;b(w)},Q=g=>{const w=g.target.checked;y(w)},ae=g=>{const w=g.target.checked;e.setIsLineWrapped(w)},le=g=>{const w=g.target.checked;e.setIsDebugConsoleChecked(w)};async function ce(){if(e.isWaiting)return;e.resetLogMessages(),e.onSUSHIClick(!0,[""],!0),E(!0);const g=gt(C),w={canonical:c||"http://example.org",version:s||"1.0.0",FSHOnly:!0,fhirVersion:l?[l]:["4.0.1"]},N=await Hn(e.fshText,w,g,e.isDebugConsoleChecked?"debug":"info");let B=JSON.stringify(N,Wn,2);N&&N.codeSystems?!N.codeSystems.length&&!N.extensions.length&&!N.instances.length&&!N.profiles.length&&!N.logicals.length&&!N.resources.length&&!N.valueSets.length&&(B=[""]):B=[""],e.onSUSHIClick(!0,B,!1),E(!1)}async function de(){if(e.isWaiting)return;e.resetLogMessages(),e.onGoFSHClick("",!0),K(!0);const g=e.gofshText.map(X=>X.def).filter(X=>X),w=C===""?[]:C.split(",");if(c||s||l!==""){const X={resourceType:"ImplementationGuide",fhirVersion:l?[l]:["4.0.1"],id:"1",...c&&{url:`${c}/ImplementationGuide/1`},...s&&{version:s}};g.push(JSON.stringify(X,null,2))}const N={dependencies:w,indent:v},{fsh:B,config:W}=await Dn(g,N,e.isDebugConsoleChecked?"debug":"info");e.onGoFSHClick(B,!1),K(!1),c===""&&W.canonical&&d(W.canonical),s===""&&W.version&&u(W.version),l===""&&W.fhirVersion&&p(W.fhirVersion.at(0))}async function ue(g,w){if(!w.endsWith(".fsh"))return;const N=e.exampleMetadata[w];U(!0),m(N.name);const B=new TextDecoder("utf-8");let W=await fetch(N.path).then(ke=>ke.body.getReader()),X="";const{value:He}=await W.read();X+=B.decode(He),U(!1),O(X)}function he(g){O(g)}function pe(){navigator.clipboard.writeText(A)}const De=g=>t.jsx(ge,{title:e.exampleMetadata[g.id]&&e.exampleMetadata[g.id].description?e.exampleMetadata[g.id].description:g.name,placement:"bottom",arrow:!0,children:t.jsx(et,{nodeId:g.id,label:g.name,className:n.treeItem},g.id)},g.id),ye=g=>t.jsx(et,{nodeId:g.id,label:g.name,children:g.children?g.children.map(w=>w.children?ye(w):De(w)):null},g.id);return t.jsxs(G,{className:n.box,children:[t.jsx("div",{className:n.leftControls,children:t.jsxs(F,{name:"Examples",className:n.button,onClick:S,children:[t.jsx(Ut,{})," Â  FSH Examples"]})}),t.jsxs(q,{container:!0,children:[t.jsx(q,{item:!0,xs:5,children:t.jsxs(F,{className:V(n.button,n.buttonLeft),onClick:ce,testid:"Button",children:["Convert to JSON",L?t.jsx("div",{className:n.progressContainer,children:t.jsx(Ze,{className:n.progress})}):t.jsx(Qe,{className:n.runIcon})]})}),t.jsx(q,{item:!0,xs:7,children:t.jsxs(F,{className:V(n.button,n.buttonRight),onClick:de,testid:"GoFSH-button",children:[Y?t.jsx("div",{className:n.progressContainer,children:t.jsx(Ze,{className:n.progress})}):t.jsx(Qe,{className:n.runIcon,style:{transform:"scaleX(-1)"}}),"Convert to FSH"]})})]}),t.jsxs("div",{className:n.rightControls,children:[t.jsxs(F,{name:"SaveAll",className:n.secondaryButton,onClick:e.saveAll,children:[t.jsx(rt,{})," Save All"]}),t.jsxs(F,{name:"Configuration",className:n.secondaryButton,onClick:I,children:[t.jsx(Jt,{})," Configuration"]})]}),t.jsxs(xe,{open:r,onClose:T,"aria-labelledby":"form-dialog-title",children:[t.jsx(me,{id:"form-dialog-title",children:"Configuration Settings"}),t.jsxs(ie,{children:[t.jsx(Te,{children:"Change the Implementation Guide configuration to use when processing FSH and FHIR JSON"}),t.jsx(be,{id:"canonical",margin:"dense",fullWidth:!0,label:"Canonical URL",helperText:"Default: http://example.org",defaultValue:c,onChange:H}),t.jsx(be,{id:"version",margin:"dense",fullWidth:!0,label:"Version",helperText:"Default: 1.0.0",defaultValue:s,onChange:z}),t.jsxs(be,{id:"fhir-version-select",margin:"dense",fullWidth:!0,select:!0,label:"FHIR Version",helperText:"Default: 4.0.1 (R4)",value:l,onChange:Z,children:[t.jsx(Re,{value:"4.0.1",children:"4.0.1 (R4)"}),t.jsx(Re,{value:"4.3.0",children:"4.3.0 (R4B)"}),t.jsx(Re,{value:"5.0.0",children:"5.0.0 (R5)"})]}),t.jsx(be,{id:"dependencies",margin:"dense",fullWidth:!0,label:"Dependencies",helperText:"Format: packageId#version, packageId#version (e.g., hl7.fhir.us.core#6.0.0)",defaultValue:C,onChange:_}),t.jsx(Le,{id:"goFSHIndent",margin:"dense",control:t.jsx(Oe,{checked:v,color:"primary"}),label:"Indent output of Convert to FSH",onChange:Q}),t.jsx(We,{children:"If set, Convert to FSH will output FSH using path rules"}),t.jsx(Le,{id:"lineWrap",margin:"dense",control:t.jsx(Oe,{checked:e.isLineWrapped,color:"primary"}),label:"Line wrap within code editors",onChange:ae}),t.jsx(We,{children:"If set, FSH Online will display code with line wrapping"}),t.jsx(Le,{id:"debugLevelConsole",margin:"dense",control:t.jsx(Oe,{checked:e.isDebugConsoleChecked,color:"primary"}),label:"Debug level console messages",onChange:le}),t.jsx(We,{children:"If set, FSH Online will display debug level messages within the console"})]}),t.jsx(Se,{children:t.jsx(F,{onClick:T,color:"primary",children:"Done"})})]}),t.jsxs(xe,{open:i,onClose:f,"aria-labelledby":"form-dialog-title",maxWidth:"lg",fullWidth:!0,scroll:"paper",classes:{paper:n.dialogPaper},children:[t.jsx(me,{id:"form-dialog-title",children:"FSH Examples"}),t.jsx(ie,{children:t.jsxs(q,{container:!0,style:{overflow:"scroll",minHeight:"64vh"},children:[t.jsx(q,{item:!0,xs:4,children:t.jsx(zt,{className:n.treeView,defaultCollapseIcon:t.jsx(lt,{}),defaultExpandIcon:t.jsx(at,{}),onNodeSelect:ue,children:e.exampleConfig.map(g=>ye(g))})}),t.jsx(q,{item:!0,xs:8,children:t.jsx(_e,{name:A?J:"",isExamples:!0,value:A,initialText:A,updateTextValue:he,mode:"fsh",placeholder:te?"Fetching example...":"Select an example",isLineWrapped:e.isLineWrapped})})]})}),t.jsxs(Se,{className:n.dialogActions,children:[t.jsxs("div",{className:n.dialogActionsMessage,children:["Have an example that might be bene-fish-al? Seas the day and add to our collection on"," ",t.jsx(it,{href:"https://github.com/FHIR/FSHOnline-Examples#readme",children:"GitHub"}),"!"]}),t.jsxs("div",{children:[t.jsxs(F,{onClick:pe,color:"primary",children:[t.jsx(_t,{})," Copy to clipboard"]}),t.jsx(F,{onClick:f,color:"secondary",children:"Close"})]})]})]})]})}const An=re(()=>({container:{height:"100%",flexGrow:1},fullHeightGrid:{height:"100%"},editorPane:{flexGrow:"0"},resize:{height:"100%",width:"4px",cursor:"col-resize","&:hover":{background:ze.palette.common.lightBlue}},resizeBlue:{background:"#487AA2"},resizeCursor:{cursor:"col-resize"},collapsedMain:{width:"100%",height:"calc(100vh - 116px - 300px)"},expandedMain:{width:"100%",height:"calc(100vh - 116px - 34px)"},collapsedConsole:{height:"25px",width:"100%"},expandedConsole:{height:"300px",width:"100%"},top:{height:"116px"}})),St="https://raw.githubusercontent.com/FHIR/FSHOnline-Examples/main",Xe="There are no messages to display in the console.",qe="There are no problems to display in the console.";let je=[Xe],ve=[qe],Ve=0,Ue="#FDD835",yt={};console._stdout={};console.log=console._stdout.write=function(n){n&&(n.startsWith("error")||n.startsWith("warn"))&&(ve[0]===qe&&(ve=[]),Ve++,ve.push(n),n.startsWith("error")&&(Ue="#FD6668")),je[0]===Xe&&(je=[]),je.push(n)};function Ct(e){e.forEach(n=>{n.type==="category"&&Ct(n.children),n.id=n.path.replaceAll("%20","-"),n.type==="file"&&(yt[n.id]={path:`${St}/Examples/${n.path}`,description:n.description,name:n.name}),delete n.type,delete n.path})}async function Bn(){let e=await fetch(`${St}/index.json`).then(n=>n.json());return Ct(e.children),[...e.children]}async function Mn(e){if(e==null||e=="")return"";if(e.length===7){const n=await fetch(`/shares/${e}`,{headers:{Accept:"application/text"}}).then(i=>i.ok?i.text():null).catch(()=>null);return n!=null?Fe.inflateSync(tt.from(n,"base64")).toString("utf-8"):""}else return Fe.inflateSync(tt.from(e,"base64")).toString("utf-8")}async function Pn(e){const n=await fetch(`https://api.github.com/gists/${e}`).then(o=>o.json());let i="";for(let o of Object.values((n==null?void 0:n.files)||{}))o.truncated?i+=await fetch(o.raw_url).then(r=>r.text()):i+=o.content,i+=`

`;return i.trim()}const bt=h.createContext(!1);function Ae(e){const n=An(),i=Xt(),[o,r]=h.useState(!1),[a,c]=h.useState(""),[d,s]=h.useState([""]),[u,l]=h.useState(""),[p,C]=h.useState(!1),[b,v]=h.useState(!1),[y,L]=h.useState(!1),[E,Y]=h.useState([]),[K,te]=h.useState({}),[U,A]=h.useState(41.666667),[O,J]=h.useState(!1),[m,S]=h.useState({canonical:"",version:"",fhirVersion:[],dependencies:""}),[f,I]=h.useState({}),[T,H]=h.useState(!1),[z,Z]=h.useState(!1),[_,Q]=h.useState(!1);h.useEffect(()=>{async function x(){if(e.path==="share"){const $=await Mn(i["*"]),ee=$.indexOf(`
`),R=$.slice(0,ee);let M,ne=$;try{const P=JSON.parse(R);P.c!=null&&P.v!=null&&P.d!=null&&(M={canonical:P.c,version:P.v,fhirVersion:P.f||[],dependencies:P.d},ne=$.slice(ee+1))}catch{}I(M||{}),l(ne)}else if(e.path==="gist"){const $=await Pn(i.id);l($)}}async function k(){Y(await Bn()),te(yt)}x(),k()},[i,e.path]);function ae(){je=[Xe],ve=[qe],Ve=0,Ue="#FDD835"}function le(x,k,$){r(x),s(k),C($)}function ce(x,k){v(k),l(x===""?null:x)}function de(x){(u===""||u===null)&&l(x),c(x)}function ue(x){s(x)}function he(x){S(x),!_&&x.canonical==="ahoy to fsh"&&(console.log("ðŸŸ ahoy to you too! thanks for using FSH ONLINE!"),Q(!0))}function pe(){A(41.666667)}function De(x){x.preventDefault(),J(!0)}function ye(x){x.preventDefault(),J(!1)}function g(){J(!0)}function w(){J(!1)}function N(x){H(x)}function B(x){Z(x)}function W(x){if(O){const k=x/window.innerWidth*100;k>10&&k<76&&A(k)}}function X(x){const k=x.clientX;O&&j.debounce(()=>W(k),10)()}function He(x){const k=x.touches[0].clientX;O&&j.debounce(()=>W(k),10)()}function ke(x,k){if(k.get(x)){let $=k.get(x),ee=`${x}-${$}`;for(;k.get(ee);)$=$+1,ee=`${x}-${$}`;k.set(x,$+1),x=ee,k.set(ee,1)}else k.set(x,1);return x}function wt(){const x=new Map,k=new Yt;k.file("FSH.fsh",a);const[$,ee]=j.partition(d,R=>R.id&&R.id!=="Untitled");$.forEach(R=>{let M;try{M=JSON.parse(R.def)}catch{}const ne=ke(M!=null&&M.resourceType?`${M.resourceType}-${R.id}`:R.id,x),P=R.def??null;k.file(`${ne}.json`,P)}),ee.forEach(R=>{let M;try{M=JSON.parse(R.def)}catch{}const ne=R.id??"Untitled",P=ke(M.resourceType?`${M.resourceType}-${ne}`:ne,x),jt=R.def??null;k.file(`${P}.json`,jt)}),k.generateAsync({type:"blob"}).then(R=>{Je.saveAs(R,"fshonline.zip")})}return t.jsx(qt,{theme:ze,children:t.jsxs("div",{className:"root",style:{height:"100vh"},children:[t.jsxs("div",{className:n.top,children:[t.jsx(sn,{sayAhoy:_}),t.jsx(Gn,{onSUSHIClick:le,onGoFSHClick:ce,onConfigChange:he,config:f,fshText:a,gofshText:d,resetLogMessages:ae,exampleConfig:E,exampleMetadata:K,isWaiting:b||p,saveAll:wt,setIsLineWrapped:N,isLineWrapped:T,setIsDebugConsoleChecked:B,isDebugConsoleChecked:z})]}),t.jsx("div",{className:y?n.collapsedMain:n.expandedMain,children:t.jsx(bt.Provider,{value:y,children:t.jsxs(q,{className:V(n.container,O&&n.resizeCursor),container:!0,onTouchMove:He,onMouseMove:X,onMouseUp:ye,onMouseLeave:ye,children:[t.jsx(q,{item:!0,className:V(n.fullHeightGrid,n.editorPane),style:{maxWidth:`calc(${U}% - 2px)`,flexBasis:`calc(${U}% - 2px)`},children:t.jsx(un,{text:a,initialText:u,updateTextValue:de,isWaiting:b,setInitialText:l,config:m,isLineWrapped:T})}),t.jsx(q,{item:!0,className:V(n.resize,O&&n.resizeBlue),onTouchStart:g,onTouchEnd:w,onMouseDown:De,onDoubleClick:pe}),t.jsx(q,{item:!0,className:V(n.fullHeightGrid,n.editorPane),style:{maxWidth:`calc(${100-U}% - 2px)`,flexBasis:`calc(${100-U}% - 2px)`},children:t.jsx(dn,{text:d,showNewText:o,setShowNewText:r,isWaiting:p,updateTextValue:ue,isLineWrapped:T})})]})})}),t.jsx("div",{className:y?n.expandedConsole:n.collapsedConsole,children:t.jsx(pn,{consoleMessages:je,problemMessages:ve,problemCount:Ve,problemColor:Ue,expandConsole:y,setExpandConsole:L})})]})})}function Vn(){return t.jsxs(Kt,{children:[t.jsx(Ge,{path:"/share/*",element:t.jsx(Ae,{path:"share"})}),t.jsx(Ge,{path:"/gist/:id",element:t.jsx(Ae,{path:"gist"})}),t.jsx(Ge,{path:"/*",element:t.jsx(Ae,{})})]})}Zt.render(t.jsx(Qt.StrictMode,{children:t.jsx(en,{basename:"/",children:t.jsx(Vn,{})})}),document.getElementById("root"));

import{m as re,j as t,A as yt,T as wt,B as R,c as B,S as qe,a as Ke,b as k,E as bt,d as jt,r as c,e as fe,I as xe,L as vt,D as me,f as Se,g as ae,h as Fe,l as He,F as st,C as It,i as Ce,k as ot,n as je,o as Te,p as kt,q as Ft,s as it,t as Tt,u as Nt,v as Et,w as at,x as j,y as Ue,z as Ht,G as Dt,H as Lt,J as Rt,K as rt,M as Ot,N as ye,O as U,P as lt,Q as ct,R as De,U as $t,V as q,W as Ze,X as Qe,Y as Mt,Z as Le,_ as Re,$ as Oe,a0 as $e,a1 as Wt,a2 as Gt,a3 as Ye,a4 as Bt,a5 as At,a6 as Vt,a7 as et,a8 as Pt,a9 as Me,aa as Ut,ab as zt,ac as Jt}from"./vendor-Dp7iwa-0.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))o(s);new MutationObserver(s=>{for(const l of s)if(l.type==="childList")for(const f of l.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&o(f)}).observe(document,{childList:!0,subtree:!0});function i(s){const l={};return s.integrity&&(l.integrity=s.integrity),s.referrerPolicy&&(l.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?l.credentials="include":s.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function o(s){if(s.ep)return;s.ep=!0;const l=i(s);fetch(s.href,l)}})();const _t="/assets/FSH-online-logo-BTt1RVAN.png",Xt=re(e=>({root:{background:e.palette.common.blue,position:"static",boxShadow:"0"},title:{fontSize:20,fontWeight:700},logo:{height:"55px",width:"63px"},"@keyframes spin-once":{"0%":{rotate:"0deg"},"100%":{rotate:"360deg"}},logoSpin:{animation:"$spin-once 1000ms",animationIterationCount:1},toolbarBox:{alignItems:"center"},exitIcon:{paddingLeft:"3px",transform:"scaleX(-1)"},docButton:{color:e.palette.common.white,backgroundColor:e.palette.common.blue,fontSize:"0.875rem",fontWeight:700,"&:hover":{background:e.palette.common.lightBlue}},versionText:{color:e.palette.common.white,fontSize:"0.8rem",fontStyle:"italic",marginTop:"-5px"}}));function qt(e){const n=Xt();return t.jsx(yt,{className:n.root,children:t.jsx(wt,{children:t.jsxs(R,{className:n.toolbarBox,display:"flex",flexGrow:1,flexDirection:"row",children:[t.jsxs(R,{order:1,display:"flex",flexGrow:1,flexDirection:"row",children:[t.jsx(R,{order:1,alignSelf:"center",display:"flex",children:t.jsx("img",{src:_t,alt:"logo",className:B(n.logo,{[n.logoSpin]:e.sayAhoy})})}),t.jsx(R,{order:2,alignSelf:"center",m:1,children:t.jsxs(qe,{injectFirst:!0,children:[t.jsx(Ke,{order:1,className:n.title,children:"FSH ONLINE"}),t.jsx(Ke,{order:2,className:n.versionText,children:"Powered by SUSHI v3.15.0 and GoFSH v2.5.1"})]})})]}),t.jsx(R,{order:1,children:t.jsx(qe,{injectFirst:!0,children:t.jsxs(k,{className:n.docButton,href:"https://fshschool.org/",target:"_blank",children:[t.jsx(bt,{className:n.exitIcon,fontSize:"small"}),"Back to School"]})})})]})})})}const oe={lighterBlue:"#D8E2EA",lightBlue:"#487AA2",blue:"#30638e",darkerBlue:"#143E61",editorGrey:"#263238",lightestGrey:"#E7ECEE",lightGrey:"#D0D9DD",grey:"#575B5C",darkerGrey:"#3D4345",darkestGrey:"#121D21",red:"#FD6668",green:"#50C878",orange:"#FFB347"},ze=jt({palette:{success:{main:oe.blue,dark:oe.darkerBlue,light:oe.lightBlue},common:oe},typography:{fontFamily:"Open Sans"},overrides:{MuiTooltip:{tooltip:{backgroundColor:oe.darkestGrey,fontSize:"13px"},arrow:{color:oe.darkestGrey}},MuiButton:{text:{textTransform:"none",fontWeight:600}},MuiIconButton:{root:{"&:hover":{backgroundColor:oe.grey}}}}}),Kt=re(e=>({iconButton:{color:e.palette.common.white,padding:"3px"},textArea:{width:"100%",color:e.palette.text.primary,fontWeight:"bold"},copyBox:{backgroundColor:e.palette.common.lightestGrey,borderRadius:2,display:"flex",justifyContent:"space-between",alignItems:"center",paddingLeft:"15px",paddingRight:"5px"},linkBox:{paddingTop:"15px",paddingBottom:"15px",paddingRight:"5px",whiteSpace:"nowrap",overflowX:"scroll",textOverflow:"ellipsis"},copyButton:{padding:"8px",borderRadius:0,"&:hover":{background:e.palette.common.lightGrey}}}));function Zt(e){const n=Kt(),[i,o]=c.useState(!1),[s,l]=c.useState(!1),[f,a]=c.useState(!1),[r,d]=c.useState(!1),[h,x]=c.useState("Copy to Clipboard"),[y,m]=c.useState("Copy Formatted Link to Clipboard"),[{fshCopied:T,fshCopyButton:z},ee]=c.useState({fshCopied:!1,fshCopyButton:"Copy FSH to Clipboard"}),[J,te]=c.useState(),[K,ne]=c.useState(),[V,O]=c.useState(!0),D=Z=>{var Q;const X=(Q=Z.target.value.match(/gist\.github\.com\/[^/]+\/(.+)/))==null?void 0:Q[1];X&&ne(`https://fshonline.fshschool.org/#/gist/${X}`)},P=()=>{l(!0),S()},S=()=>{o(!1),a(!0),ne(""),ee({fshCopied:!1,fshCopyButton:"Copy FSH to Clipboard"})},C=()=>{a(!1),l(!1)},p=()=>{K?(C(),te(K),o(!0),x("Copy to Clipboard"),m("Copy Formatted Link to Clipboard"),O(!1)):d(!0)},b=()=>{d(!1)},I=async()=>{var Q,le,ce,de,ue,he,pe,ge;let Z;(Q=e.config)!=null&&Q.canonical||(le=e.config)!=null&&le.version||((ce=e.config)==null?void 0:ce.fhirVersion.length)>0||(de=e.config)!=null&&de.dependencies?Z=Te.deflateSync(JSON.stringify({c:(ue=e.config)==null?void 0:ue.canonical,v:(he=e.config)==null?void 0:he.version,f:(pe=e.config)==null?void 0:pe.fhirVersion,d:(ge=e.config)==null?void 0:ge.dependencies})+`
`+e.shareText).toString("base64"):Z=Te.deflateSync(e.shareText).toString("base64");const X=`https://fshonline.fshschool.org/#/share/${Z}`;X.length>2048?P():(te(X),o(!0),x("Copy to Clipboard"),m("Copy Formatted Link to Clipboard"),O(!0))},N=()=>{o(!1),l(!1)},_=()=>{ee({fshCopied:!0,fshCopyButton:"FSH Copied to Clipboard"})};return t.jsxs(t.Fragment,{children:[t.jsx(fe,{title:"Share FSH",placement:"top",arrow:!0,children:t.jsx(xe,{name:"Share FSH",className:n.iconButton,onClick:I,children:t.jsx(vt,{fontSize:"small",style:{transform:"rotate(-45deg)"}})})}),t.jsxs(me,{open:i,onClose:N,"aria-labelledby":"form-dialog-title",maxWidth:"md",fullWidth:!0,children:[t.jsx(Se,{id:"form-dialog-title",children:"Share"}),t.jsxs(ae,{children:[t.jsx(Fe,{children:"Use this link to share your FSH with others!"}),t.jsxs(R,{className:n.copyBox,children:[t.jsx(R,{className:n.linkBox,children:J}),t.jsxs(R,{sx:{display:"flex",flexWrap:"nowrap"},children:[t.jsx(fe,{title:h,placement:"top",arrow:!0,children:t.jsx(xe,{className:n.copyButton,children:t.jsx(He.CopyToClipboard,{text:J,onCopy:()=>x("Link Copied"),children:t.jsx(st,{fontSize:"small"})})})}),t.jsx(fe,{title:y,placement:"top",arrow:!0,children:t.jsx(xe,{className:n.copyButton,children:t.jsx(He.CopyToClipboard,{text:`[FSH Online Link](${J})`,onCopy:()=>m("Link Copied"),options:{format:"text/plain"},children:t.jsx(It,{fontSize:"small"})})})})]})]})]}),t.jsxs(Ce,{children:[V&&t.jsx(k,{onClick:S,color:"primary",style:{align:"left"},children:"Create Link with Gist"}),t.jsx(R,{style:{flex:"1 0 0",hidden:!0}}),t.jsx(k,{onClick:N,color:"primary",children:"Done"})]})]}),t.jsxs(me,{open:f,onClose:C,"aria-labelledby":"alert-dialog-title",maxWidth:"md",fullWidth:!0,children:[t.jsx(Se,{id:"alert-dialog-title",children:"Share with Gist"}),s&&t.jsx(ae,{style:{color:ze.palette.common.red},children:"Your FSH content is too long to share directly. Please use a Gist to share."}),t.jsxs(ae,{children:["Create a"," ",t.jsx(ot,{id:"gistURL",href:"https://gist.github.com/",target:"_blank",children:"Gist"})," ","and paste the URL below to generate a shareable FSH Online link.",t.jsx(je,{id:"gistURLText",label:"Gist URL",fullWidth:!0,onChange:D})]}),t.jsxs(Ce,{style:{bottom:0,right:0},children:[t.jsx(k,{onClick:C,color:"primary",children:"Cancel"}),t.jsx(R,{style:{flex:"1 0 0",hidden:!0}}),t.jsx(He.CopyToClipboard,{text:e.shareText,onCopy:_,style:{align:"left"},children:t.jsx(k,{color:T?"secondary":"primary",children:z})}),t.jsx(k,{color:"primary",onClick:p,style:{align:"left"},children:"Generate Link from Gist"})]})]}),t.jsxs(me,{open:r,onClose:b,"aria-labelledby":"alert-dialog-title",maxWidth:"lg",children:[t.jsx(Se,{id:"alert-dialog-title",children:"Error Creating Gist Link"}),t.jsx(ae,{children:t.jsx(Fe,{children:"Could not generate a link from your Gist URL. Ensure the URL is valid."})}),t.jsx(Ce,{children:t.jsx(k,{onClick:b,color:"primary",children:"Keep Swimming!"})})]})]})}kt.defineSimpleMode("fsh",{meta:{lineComment:"//"},start:[{regex:/"(?:[^\\]|\\.)*?(?:"|$)/,token:"atom"},{regex:/\b(Alias|Characteristics|Context|CodeSystem|Expression|Extension|Description|Id|Instance|InstanceOf|Invariant|Logical|Mapping|Mixins|Parent|Profile|Resource|RuleSet|Severity|Source|Target|Title|Usage|ValueSet|XPath)(?=\s*:)\b/,token:"keyword"},{regex:/(\s|^)(and|codes|contains|descendent-of|exclude|exists|from system|from|generalizes|include|in|insert|is-a|is-not-a|named|not-in|obeys|only|or|regex|units|valueset|where|D|MS|N|SU|TU|\\?!)(\s|$)/,token:"def"},{regex:/(\(\s*)(exactly|example|extensible|preferred|required)(\s*\))/,token:"def"},{regex:/\b(CodeableReference|Reference|Canonical)\s*\(/,push:"closingParen",token:"atom"},{regex:/\*|->|=|\+|:/,token:"def"},{regex:/\b(https?:\/\/(www\.)?[-a-zA-Z0-9@:%._+~#=]{2,256}\.[a-z]{2,6}\b([-a-zA-Z0-9@:%_+.~#?&//=]*))\b/,token:"atom"},{regex:/(\s|^)(true|false)(\s|$)/,token:"string"},{regex:/(\s|^)(-?\d+(\.\d+)?)(\s|^)/,token:"string"},{regex:/#"(?:\\.|[^\\"])*"/,token:"string"},{regex:/#[^\s]*/,token:"string"},{regex:/'.*'/,token:"string"},{regex:/\s\/\/.*/,token:"comment"},{regex:/\/\/.*/,token:"comment",sol:!0},{regex:/\/\*/,token:"comment",next:"comment"}],closingParen:[{regex:/\)/,pop:!0,token:"atom"}],comment:[{regex:/.*?\*\//,token:"comment",next:"start"},{regex:/.*/,token:"comment"}]});const be=200,Qt=re(e=>({box:{height:"100%"},header:{fontFamily:"Open Sans",color:e.palette.common.white,background:e.palette.common.darkerGrey,padding:"0px",paddingLeft:"29px",height:"34px",display:"flex",justifyContent:"space-between",transition:e.transitions.create(["margin","width"],{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen})},headerShift:{width:`calc(100% - ${be}px - 29px)`,transition:e.transitions.create(["margin","width"],{easing:e.transitions.easing.easeOut,duration:e.transitions.duration.enteringScreen}),marginRight:be},headerLabel:{lineHeight:"34px",float:"left",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},headerActionGroup:{paddingRight:"10px"},headerActions:{alignItems:"center",display:"flex"},iconButton:{color:e.palette.common.white,padding:"3px"},drawer:{width:be,flexShrink:0},drawerPaper:{width:be,border:"none",height:"calc(100vh - 116px - 34px)",top:"116px"},drawerPaperExpandedConsole:{height:"calc(100vh - 116px - 300px)"},drawerHeader:{display:"flex",alignItems:"center",justifyContent:"flex-start",color:e.palette.common.white,background:e.palette.common.darkerGrey,height:"34px",minHeight:"34px"},drawerHeaderIcon:{padding:"0px",color:e.palette.common.white,background:e.palette.success.main,"&:hover":{background:e.palette.success.light},borderRadius:0,height:"100%",width:"34px",minWidth:"34px"},content:{flexGrow:1,width:"100%",transition:e.transitions.create(["margin","width"],{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen})},contentShift:{width:`calc(100% - ${be}px)`,transition:e.transitions.create(["margin","width"],{easing:e.transitions.easing.easeOut,duration:e.transitions.duration.enteringScreen}),marginRight:0}}));function Je(e){const n=Qt(),i=c.useContext(mt),[o,s]=c.useState(!0),l=()=>{s(!0)},f=()=>{s(!1)};function a(x){e.updateTextValue(x)}const r=(x,y,m,T={})=>t.jsx(fe,{title:j.upperFirst(y),placement:"top",arrow:!0,children:t.jsx(xe,{name:y,className:n.iconButton,"aria-label":y,onClick:m,children:t.jsx(x,{fontSize:"small",style:T})})}),d=()=>t.jsxs("div",{className:n.headerActions,children:[t.jsxs("div",{className:n.headerActionGroup,children:[e.mode==="fsh"&&!e.isExamples&&t.jsx(Zt,{shareText:e.value,config:e.config}),e.copy&&r(st,"copy",()=>{}),e.save&&r(it,"save",e.save),e.delete&&r(Tt,"delete",e.delete)]}),e.renderDrawer&&!o&&t.jsx(xe,{name:"expand",className:n.drawerHeaderIcon,"aria-label":"expand",onClick:l,children:t.jsx(Nt,{})})]}),h=()=>t.jsxs(Et,{className:n.drawer,"data-testid":"editor-drawer",variant:"persistent",anchor:"right",open:o,classes:{paper:B(n.drawerPaper,i&&n.drawerPaperExpandedConsole)},children:[t.jsx("div",{className:n.drawerHeader,children:t.jsx(k,{name:"collapse","aria-label":"collapse",className:n.drawerHeaderIcon,onClick:f,children:t.jsx(at,{})})}),e.renderDrawer()]});return t.jsxs(R,{className:n.box,children:[t.jsxs("div",{className:B(n.header,{[n.headerShift]:e.renderDrawer&&o}),children:[t.jsx("div",{title:e.name,className:n.headerLabel,children:e.name}),d()]}),t.jsx(Ft.UnControlled,{className:B("react-codemirror2",e.renderDrawer&&n.content,{[n.contentShift]:e.renderDrawer&&o}),value:e.initialText,options:{mode:e.mode,theme:"material",placeholder:e.placeholder,scrollbarStyle:"overlay",autoCloseBrackets:!0,lineNumbers:!0,foldGutter:!0,readOnly:e.isExamples,gutters:["CodeMirror-linenumbers","CodeMirror-foldgutter"],extraKeys:{Tab:x=>{x.replaceSelection("  ")},"Ctrl-/":"toggleComment","Cmd-/":"toggleComment","Ctrl-Q":x=>{x.foldCode(x.getCursor())}},lineWrapping:e.isLineWrapped},onChange:(x,y,m)=>{a(m)}}),e.renderDrawer&&h()]})}function dt(e){return t.jsxs(me,{open:e.isOpen,onClose:e.handleCloseModal,"aria-labelledby":"delete-confirmation-dialog",children:[t.jsxs(Se,{id:"delete-confirmation-dialog-title",children:["Delete ",e.title]}),t.jsx(ae,{children:t.jsxs(Fe,{children:["Are you sure you want to delete ",e.item,"? This action cannot be undone."]})}),t.jsxs(Ce,{children:[t.jsx(k,{onClick:e.handleCloseModal,color:"primary",children:"Cancel"}),t.jsx(k,{onClick:e.handleDelete,color:"secondary",children:"Delete"})]})]})}const Yt=re(e=>({fileTreeContent:{overflowY:"scroll",height:"100%"},button:{color:e.palette.common.white,background:e.palette.success.main,"&:hover":{background:e.palette.success.dark},border:"8px solid white",fontSize:"13px",width:"100%"},list:{padding:"8px",paddingLeft:"0px",paddingBottom:"0px",fontSize:"13px"},listItemError:{paddingTop:"5px",paddingBottom:"5px",margin:0},listItem:{background:e.palette.common.lightestGrey,paddingTop:"5px",paddingBottom:"5px",marginTop:"5px",marginBottom:"5px",paddingLeft:"5px",margin:0,"&:hover":{background:e.palette.common.lightGrey},display:"block",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},listItemSelected:{background:e.palette.common.editorGrey,color:e.palette.common.white,"&:hover":{background:e.palette.common.darkestGrey}},listHeader:{padding:"5px",paddingLeft:"15px"},listIcon:{color:e.palette.success.main,verticalAlign:"middle",fontSize:"13px",paddingLeft:"3px",paddingRight:"3px"},listIconError:{color:e.palette.common.red},blankIcon:{paddingLeft:"19px"}})),Ge=e=>{if(e.resourceType==="ValueSet"||e.resourceType==="CodeSystem")return e.resourceType;if(e.resourceType==="StructureDefinition"){if(e.derivation==="specialization"){if(e.kind==="resource")return"Resource";if(e.kind==="logical")return"Logical Model"}else if(e.derivation==="constraint"){if(e.kind==="complex-type"&&e.type==="Extension")return"Extension";if(["resource","complex-type","primitive-type","logical"].includes(e.kind))return"Profile"}}return e.resourceType!=null?"Instance":null},Be=e=>{if(e.id)if(typeof e.id=="object"){if(e.id.value)return e.id.value}else return e.id;return e.resourceType?`Instance of ${e.resourceType.substring(e.resourceType.lastIndexOf("/")+1)}`:"Untitled"},en=e=>[...e.profiles,...e.extensions,...e.logicals,...e.resources,...e.instances,...e.valueSets,...e.codeSystems].map(i=>({resourceType:Ge(i),id:Be(i),def:JSON.stringify(i,null,2)}));function tn(e){const n=Yt(),[i,o]=c.useState(""),[s,l]=c.useState([{resourceType:null,id:"Untitled",def:null}]),{setShowNewText:f,updateTextValue:a}=e,[r,d]=c.useState(0),[h,x]=c.useState([]),[y,m]=c.useState(!1);c.useEffect(()=>{if(e.showNewText&&!j.isEqual(e.text,[""])){f(!1);let S;try{S=JSON.parse(e.text)}catch{S={profiles:[],extensions:[],logicals:[],resources:[],instances:[],valueSets:[],codeSystems:[]}}const C=en(S);l(C),d(0),o(C.length>0?C[0].def:""),a(C)}else e.isWaiting&&(o(null),l([]))},[e.text,e.showNewText,e.isWaiting,a,f]);const T=S=>{if(e.isWaiting)return;const C=[...s];try{const p=S===""?{}:JSON.parse(S);if(h.includes(r)){const b=[...h];b.splice(h.indexOf(r),1),x(b)}s[r]||(C[r]={resourceType:Ge(p),id:Be(p)}),(!s[r]||p.resourceType!==s[r].resourceType)&&(C[r].resourceType=Ge(p)),(!s[r]||p.id!==s[r].id)&&(C[r].id=Be(p))}catch{if(!h.includes(r)){const b=[...h];b.push(r),x(b)}}C[r]&&(C[r].def=S),l(C),e.updateTextValue(C),i===null&&o(S)},z=()=>{const S=[...s];S.push({resourceType:null,id:"Untitled",def:null}),d(S.length-1),l(S),o(null),e.updateTextValue(S)},ee=()=>{const S=r,C=[...s];if(C.splice(S,1),C.length===0&&C.push({resourceType:null,id:"Untitled",def:null}),l(C),S<=r){let I=0;S<r&&(I=r-1),d(I);const N=C.length>0?C[I].def:null;o(N)}const p=[...h];h.includes(S)&&p.splice(h.indexOf(S),1);const b=p.map(I=>I<S?I:I-1);x(b),m(!1),e.updateTextValue(C)},J=()=>{m(!0)},te=()=>{m(!1)},K=(S,C)=>{let p;try{p=JSON.parse(S)}catch{}Ue.saveAs(new Blob([S]),p!=null&&p.resourceType&&(p!=null&&p.id)?`${p.resourceType}-${p.id}.json`:`${C}.json`)},ne=()=>{const S=s[r];if(!S)return;const C=S.resourceType||"Unknown Type",p=S.id||"Untitled";return t.jsx(dt,{title:"FHIR JSON",item:`${C} ${p}`,isOpen:y,handleCloseModal:te,handleDelete:ee})},V=()=>{const S=["Profiles","Extensions","Logical Models","Resources","ValueSets","CodeSystems","Instances","Unknown Type"],C=j.groupBy(s,p=>p&&p.resourceType?`${p.resourceType}s`:"Unknown Type");return Object.keys(C).sort((p,b)=>S.indexOf(p)-S.indexOf(b)).map(p=>t.jsxs(Dt,{component:"nav",className:n.list,children:[t.jsx("div",{className:n.listHeader,children:p}),C[p].sort((b,I)=>{const N=b.id?b.id:"Untitled",_=I.id?I.id:"Untitled";return N.toLowerCase()<_.toLowerCase()?-1:N.toLowerCase()>_.toLowerCase()?1:0}).map((b,I)=>{const N=s.indexOf(b),_=h.includes(N);return t.jsxs(Lt,{button:!0,title:(b==null?void 0:b.id)||"Untitled","data-testid":`${p}-defId`,className:B(n.listItem,_&&n.listItemError,N===r&&n.listItemSelected),onClick:()=>{d(N),o(b.def)},children:[h.includes(N)?t.jsx(fe,{title:"Invalid JSON",placement:"top",arrow:!0,children:t.jsx(Rt,{className:B(n.listIcon,n.listIconError)})}):t.jsx("span",{className:n.blankIcon}),(b==null?void 0:b.id)||"Untitled"]},I)})]},p))},O=()=>t.jsxs(t.Fragment,{children:[t.jsx(k,{className:n.button,startIcon:t.jsx(Ht,{}),onClick:z,children:"New JSON Editor"}),t.jsx("div",{className:n.fileTreeContent,children:V()})]}),D=s.length>0?s[r].def:null,P=`${s.length>0?s[r].id:"Untitled"}`;return t.jsxs(t.Fragment,{children:[t.jsx(Je,{name:`FHIR JSON: ${P}`,value:D,initialText:i,updateTextValue:T,mode:"application/json",placeholder:e.isWaiting?"Loading...":`Paste or edit single FHIR JSON artifact here... 
Create additional FHIR JSON artifacts to the right.`,renderDrawer:O,isExamples:!1,delete:J,save:()=>K(D,P),isLineWrapped:e.isLineWrapped}),y&&ne()]})}function nn(e){const[n,i]=c.useState(!1),o=()=>{i(!n)},s=()=>{i(!1),e.setInitialText("")},l=()=>{Ue.saveAs(new Blob([e.text]),"FSH.fsh")};return t.jsxs(t.Fragment,{children:[t.jsx(Je,{name:"FSH",isExamples:!1,value:e.text,initialText:e.initialText,updateTextValue:e.updateTextValue,mode:"fsh",placeholder:e.isWaiting?"Loading...":"Paste or edit FSH here...",delete:o,save:l,config:e.config,isLineWrapped:e.isLineWrapped}),n&&t.jsx(dt,{title:"FHIR Shorthand",item:"all FSH",isOpen:n,handleCloseModal:o,handleDelete:s})]})}const sn=re(e=>({consoleControls:{background:e.palette.common.darkestGrey,height:"34px",boxSizing:"border-box",display:"flex;",alignItems:"center",justifyContent:"left"},box:{paddingLeft:"29px",color:e.palette.common.white,background:e.palette.common.darkestGrey,height:"calc(100% - 34px)",overflow:"scroll",boxSizing:"border-box"},button:{marginRight:"10px",color:e.palette.common.white,textTransform:"none",padding:0},problemsButton:{padding:0,color:e.palette.common.white,textTransform:"none"},expandIcon:{width:"29px",color:e.palette.common.white,padding:0},pre:{margin:"0px"},error:{background:e.palette.common.red,paddingRight:"0.4em",paddingLeft:"0.2em"},warn:{background:e.palette.common.orange,paddingRight:"1em",paddingLeft:"0.2em"},info:{background:e.palette.common.green,paddingRight:"1em",paddingLeft:"0.2em"},debug:{background:e.palette.common.blue,paddingRight:"0.4em",paddingLeft:"0.2em"},circle:{"border-radius":"50%","border-style":"solid","border-width":"2px","min-width":"20px",height:"20px",paddingLeft:1,paddingRight:1,background:"#263238","align-items":"center",display:"flex",marginLeft:4,"justify-content":"center",padding:0}}));function on(e){const n=sn(),[i,o]=c.useState(!1),[s,l]=c.useState([]),{problemCount:f,setExpandConsole:a}=e;c.useEffect(()=>{f&&a(!0)},[f,a]),c.useEffect(()=>{const y=(i?e.problemMessages:e.consoleMessages).map(m=>m.startsWith("error")?{logLevel:"error",consoleMessage:m.slice(5)}:m.startsWith("warn")?{logLevel:"warn",consoleMessage:m.slice(4)}:m.startsWith("info")?{logLevel:"info",consoleMessage:m.slice(4)}:m.startsWith("debug")?{logLevel:"debug",consoleMessage:m.slice(5)}:{logLevel:"",consoleMessage:m});l(y)},[e.consoleMessages,e.problemMessages,i]);const r=()=>{e.setExpandConsole(!e.expandConsole)},d=()=>{o(!1),e.setExpandConsole(!0)},h=()=>{o(!0),e.setExpandConsole(!0)},x=(y,m)=>t.jsxs("pre",{className:n.pre,children:[y.logLevel&&t.jsx("span",{className:n[y.logLevel],children:y.logLevel}),y.consoleMessage]},m);return t.jsxs(t.Fragment,{children:[t.jsxs(R,{className:n.consoleControls,children:[t.jsx(xe,{onClick:r,"aria-label":e.expandConsole?"collapse console":"expand console",className:n.expandIcon,children:e.expandConsole?t.jsx(rt,{}):t.jsx(Ot,{})}),t.jsx(k,{onClick:d,className:n.button,children:t.jsx("p",{style:{borderBottom:e.expandConsole&&!i?"1px solid white":"none",margin:"0"},children:"Console"})}),t.jsxs(k,{onClick:h,className:n.problemsButton,children:[t.jsx("p",{style:{borderBottom:e.expandConsole&&i?`1px solid ${e.problemCount?e.problemColor:"white"}`:"none",margin:"0"},children:"Problems"}),t.jsx("div",{className:n.circle,style:{borderColor:`${e.problemCount?e.problemColor:"white"}`},children:e.problemCount})]})]}),t.jsx(R,{style:{display:e.expandConsole?"block":"none"},className:n.box,children:s.map((y,m)=>x(y,m))})]})}let A=ye.utils.logger;function ut(e,n){e==="sushi"?A=ye.utils.logger:e==="gofsh"&&(A=U.utils.logger),A.level=n}const{FSHTank:an,RawFSH:rn}=ye.sushiImport,{exportFHIR:ln}=ye.sushiExport,{createFHIRDefinitions:cn,FHIRDefinitions:dn}=ye.fhirdefs,{AUTOMATIC_DEPENDENCIES:un,fillTank:hn,getFHIRVersionInfo:pn,getRandomPun:ht,loadExternalDependencies:gn,stats:Ae,Type:fn}=ye.utils,{loadExternalDependencies:xn,stats:ie}=U.utils;async function mn(e,n,i){ie.reset(),ut("gofsh",i);const o=[];e.forEach((x,y)=>{const m=`Input_${y}`;try{x=JSON.parse(x),x.resourceType||A.error(`FHIR JSON ${x.id??m} is missing the required "resourceType" property`)}catch{A.error(`Could not parse ${m} to JSON`);return}U.utils.isProcessableContent(x,m)&&o.push(new U.processor.WildFHIR({content:x},m))}),await lt({locateFile:()=>ct});const s=new U.processor.LakeOfFHIR(o);await s.prepareDefs();const l=await wn(s,n.dependencies),f=await pt(l.config.dependencies,l,!1),a=new U.utils.MasterFisher(s,f),r=new U.processor.FHIRProcessor(s,a),d=await U.utils.getResources(r,l,{indent:n.indent}),h=new U.gofshExport.FSHExporter(d).apiExport("string");return A.info("Done converting definitions"),yn(d),{fsh:h,config:(l==null?void 0:l.config)??{}}}async function Sn(e,n,i=[],o){Ae.reset(),ut("sushi",o),await lt({locateFile:()=>ct});const s=await pt(i,n,!0);let l=an;try{const d=[new rn(e)];l=hn(d,n)}catch{A.error("Something went wrong when importing the FSH definitions");return}const f=s.fishForFHIR("StructureDefinition",fn.Resource);if((f==null?void 0:f.version)!==n.fhirVersion[0]){A.error("StructureDefinition resource not found. The FHIR package in the browser cache may be corrupt. Clear cookies and site data on this webpage to reload the FHIR package.");return}A.info("Converting FSH to FHIR resources...");const a=ln(l,s),r=a.profiles.length+a.extensions.length+a.logicals.length+a.resources.length+a.instances.filter(d=>d._instanceMeta.usage!=="Inline").length+a.valueSets.length+a.codeSystems.length;return A.info(`Exported ${r} FHIR resources as JSON.`),console.log(" "),Cn(a),a.profiles=a.profiles.map(d=>d.toJSON(!1)),a.extensions=a.extensions.map(d=>d.toJSON(!1)),a.logicals=a.logicals.map(d=>d.toJSON(!1)),a.resources=a.resources.map(d=>d.toJSON(!1)),a.instances=a.instances.filter(d=>d._instanceMeta.usage!=="Inline"),a}function Cn(e){const n=Ae.numError,i=Ae.numWarn,o=j.pad(e.profiles.length.toString(),13),s=j.pad(e.extensions.length.toString(),12),l=j.pad(e.logicals.length.toString(),12),f=j.pad(e.resources.length.toString(),13),a=j.pad(e.valueSets.length.toString(),18),r=j.pad(e.codeSystems.length.toString(),17),d=j.pad(e.instances.length.toString(),18),h=j.pad(`${n} Error${n!==1?"s":""}`,13),x=j.padStart(`${i} Warning${i!==1?"s":""}`,12),y=j.padEnd(ht(n,i),36);["â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• SUSHI RESULTS â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—","â•‘ â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•® â•‘","â•‘ â”‚    Profiles   â”‚  Extensions  â”‚   Logicals   â”‚   Resources   â”‚ â•‘","â•‘ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â•‘",`â•‘ â”‚ ${o} â”‚ ${s} â”‚ ${l} â”‚ ${f} â”‚ â•‘`,"â•‘ â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯ â•‘","â•‘ â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•® â•‘","â•‘ â”‚      ValueSets     â”‚    CodeSystems    â”‚     Instances      â”‚ â•‘","â•‘ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â•‘",`â•‘ â”‚ ${a} â”‚ ${r} â”‚ ${d} â”‚ â•‘`,"â•‘ â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯ â•‘","â•‘                                                                 â•‘","â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£",`â•‘ ${y} ${h} ${x} â•‘`,"â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"].forEach(T=>console.log(T))}function yn(e){const n=j.pad(e.profiles.length.toString(),18),i=j.pad(e.extensions.length.toString(),17),o=j.pad(e.logicals.length.toString(),18),s=j.pad(e.resources.length.toString(),18),l=j.pad(e.valueSets.length.toString(),17),f=j.pad(e.codeSystems.length.toString(),18),a=j.pad(e.instances.length.toString(),18),r=j.pad(e.invariants.length.toString(),17),d=j.pad(e.mappings.length.toString(),18),h=j.pad(`${ie.numError} Error${ie.numError!==1?"s":""}`,12),x=j.padStart(`${ie.numWarn} Warning${ie.numWarn!==1?"s":""}`,12),y=j.padEnd(ht(ie.numError,ie.numWarn),37),m=["â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• GoFSH RESULTS â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—","â•‘ â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•® â•‘","â•‘ â”‚      Profiles      â”‚    Extensions     â”‚      Logicals      â”‚ â•‘","â•‘ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â•‘",`â•‘ â”‚ ${n} â”‚ ${i} â”‚ ${o} â”‚ â•‘`,"â•‘ â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯ â•‘","â•‘ â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•® â•‘","â•‘ â”‚     Resources      â”‚     ValueSets     â”‚     CodeSystems    â”‚ â•‘","â•‘ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â•‘",`â•‘ â”‚ ${s} â”‚ ${l} â”‚ ${f} â”‚ â•‘`,"â•‘ â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯ â•‘","â•‘ â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•® â•‘","â•‘ â”‚     Instances      â”‚    Invariants     â”‚      Mappings      â”‚ â•‘","â•‘ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â•‘",`â•‘ â”‚ ${a} â”‚ ${r} â”‚ ${d} â”‚ â•‘`,"â•‘ â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯ â•‘","â•‘                                                                 â•‘","â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£",`â•‘ ${y} ${h} ${x} â•‘`,"â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"];console.log(" "),m.forEach(T=>console.log(T))}async function pt(e,n,i){const o=(h,x)=>{A.log(h,x)},s=new De.FHIRRegistryClient("https://packages.fhir.org",{log:o,isBrowserEnvironment:!0}),f=(await bn(i?e:n.config.dependencies??[],i?n.fhirVersion[0]:n.config.fhirVersion[0],s)).map(h=>({name:h.packageId,version:h.version})),a=new De.SQLJSPackageDB;await a.initialize();const r=new De.BrowserBasedPackageCache("FSHOnline Dependencies",{log:o});await r.initialize(f);const d=await cn(!1,null,{packageCache:r,packageDB:a,registryClient:s,options:{log:o}});return i?(n.dependencies=e.filter(tt),await gn(d,n)):(n.config.dependencies!=null&&(n.config.dependencies=n.config.dependencies.filter(tt)),await xn(d,n)),d.optimize(),d}async function wn(e,n){const i=new dn;await i.initialize();const o=new U.utils.MasterFisher(e,i),s=new U.processor.FHIRProcessor(e,o),l=n.map(a=>a.replace("#","@"));return s.processConfig(l??[])}async function bn(e,n,i){const o=[];for(const a of e){const{packageId:r}=a,d=await i.resolveVersion(r,a.version);o.push({packageId:r,version:d})}const s=pn(n),l={packageId:s.packageId,version:n};nt(o,l)||o.push(l);const f=un.filter(a=>a.version!=="current");for(const a of f){if(a.fhirVersions&&!a.fhirVersions.includes(s.name))continue;const{packageId:r}=a,d=await i.resolveVersion(r,a.version);nt(o,a)||o.push({packageId:r,version:d})}return o}function tt(e){return e.version==null&&A.warn(`Skipping ${e.packageId} because it does not include a version. Use format packageId#version.`),e.version!=null}function nt(e,n,i=!1){return e.some(o=>o.packageId===n.packageId&&(i||o.version===n.version))}function jn(e){return e.split(",").map(i=>{const o=i.trim();if(o==="")return o;const[s,l]=o.split("#");return{packageId:s,version:l}}).filter(i=>i)}const vn=re(e=>({box:{padding:e.spacing(1),color:e.palette.text.primary,background:e.palette.background.paper,display:"flex;",alignItems:"center",justifyContent:"center"},rightControls:{position:"absolute",right:"24px"},leftControls:{position:"absolute",left:"28px"},secondaryButton:{color:e.palette.success.main,"&:hover":{background:e.palette.common.lighterBlue}},progressContainer:{width:"24px",height:"24px"},progress:{height:"1em !important",width:"1em !important",verticalAlign:"middle",color:e.palette.common.white},button:{color:e.palette.common.white,background:e.palette.success.main,borderRadius:"0",paddingRight:"15px",paddingLeft:"15px","&:hover":{background:e.palette.success.dark}},buttonLeft:{float:"right",left:"-3.33px"},buttonRight:{float:"left",right:"-0.67px"},runIcon:{padding:"0px"},dialogPaper:{maxHeight:"80vh",minHeight:"80vh"},dialogActions:{justifyContent:"space-between"},dialogActionsMessage:{fontStyle:"italic",padding:"6px 8px"}}));function In(e,n){if(e!=="config")return n}function kn(e){const n=vn(),[i,o]=c.useState(!1),[s,l]=c.useState(!1),[f,a]=c.useState(""),[r,d]=c.useState(""),[h,x]=c.useState(""),[y,m]=c.useState(""),[T,z]=c.useState(!1),[ee,J]=c.useState(!1),[te,K]=c.useState(!1),[ne,V]=c.useState(!1),[O,D]=c.useState(""),[P,S]=c.useState("");c.useEffect(()=>{var u,w,F,$,L;a(((u=e.config)==null?void 0:u.canonical)||""),d(((w=e.config)==null?void 0:w.version)||""),x((($=(F=e.config)==null?void 0:F.fhirVersion)==null?void 0:$.length)>0?e.config.fhirVersion.at(0):""),m(((L=e.config)==null?void 0:L.dependencies)||"")},[e.config]);const C=()=>{o(!0)},p=()=>{o(!1),D("")},b=()=>{l(!0)},I=()=>{l(!1),e.onConfigChange({canonical:f,version:r,fhirVersion:[h],dependencies:y,isGoFSHIndented:T})},N=u=>{const w=u.target.value;a(w)},_=u=>{const w=u.target.value;d(w)},Z=u=>{const w=u.target.value;x(w)},X=u=>{const w=u.target.value;m(w)},Q=u=>{const w=u.target.checked;z(w)},le=u=>{const w=u.target.checked;e.setIsLineWrapped(w)},ce=u=>{const w=u.target.checked;e.setIsDebugConsoleChecked(w)};async function de(){if(e.isWaiting)return;e.resetLogMessages(),e.onSUSHIClick(!0,[""],!0),J(!0);const u=jn(y),w={canonical:f||"http://example.org",version:r||"1.0.0",FSHOnly:!0,fhirVersion:h?[h]:["4.0.1"]},F=await Sn(e.fshText,w,u,e.isDebugConsoleChecked?"debug":"info");let $=JSON.stringify(F,In,2);F&&F.codeSystems?!F.codeSystems.length&&!F.extensions.length&&!F.instances.length&&!F.profiles.length&&!F.logicals.length&&!F.resources.length&&!F.valueSets.length&&($=[""]):$=[""],e.onSUSHIClick(!0,$,!1),J(!1)}async function ue(){if(e.isWaiting)return;e.resetLogMessages(),e.onGoFSHClick("",!0),K(!0);const u=e.gofshText.map(M=>M.def).filter(M=>M),w=y===""?[]:y.split(",").map(M=>M.trim());if(f||r||h!==""){const M={resourceType:"ImplementationGuide",fhirVersion:h?[h]:["4.0.1"],id:"1",...f&&{url:`${f}/ImplementationGuide/1`},...r&&{version:r}};u.push(JSON.stringify(M,null,2))}const F={dependencies:w,indent:T},{fsh:$,config:L}=await mn(u,F,e.isDebugConsoleChecked?"debug":"info");e.onGoFSHClick($,!1),K(!1),f===""&&L.canonical&&a(L.canonical),r===""&&L.version&&d(L.version),h===""&&L.fhirVersion&&x(L.fhirVersion.at(0))}async function he(u,w){if(!w.endsWith(".fsh"))return;const F=e.exampleMetadata[w];V(!0),S(F.name);const $=new TextDecoder("utf-8");let L=await fetch(F.path).then(ke=>ke.body.getReader()),M="";const{value:Ee}=await L.read();M+=$.decode(Ee),V(!1),D(M)}function pe(u){D(u)}function ge(){navigator.clipboard.writeText(O)}const Ne=u=>t.jsx(fe,{title:e.exampleMetadata[u.id]&&e.exampleMetadata[u.id].description?e.exampleMetadata[u.id].description:u.name,placement:"bottom",arrow:!0,children:t.jsx(Ye,{nodeId:u.id,label:u.name,className:n.treeItem},u.id)},u.id),we=u=>t.jsx(Ye,{nodeId:u.id,label:u.name,children:u.children?u.children.map(w=>w.children?we(w):Ne(w)):null},u.id);return t.jsxs(R,{className:n.box,children:[t.jsx("div",{className:n.leftControls,children:t.jsxs(k,{name:"Examples",className:n.button,onClick:C,children:[t.jsx($t,{})," Â  FSH Examples"]})}),t.jsxs(q,{container:!0,children:[t.jsx(q,{item:!0,xs:5,children:t.jsxs(k,{className:B(n.button,n.buttonLeft),onClick:de,testid:"Button",children:["Convert to JSON",ee?t.jsx("div",{className:n.progressContainer,children:t.jsx(Ze,{className:n.progress})}):t.jsx(Qe,{className:n.runIcon})]})}),t.jsx(q,{item:!0,xs:7,children:t.jsxs(k,{className:B(n.button,n.buttonRight),onClick:ue,testid:"GoFSH-button",children:[te?t.jsx("div",{className:n.progressContainer,children:t.jsx(Ze,{className:n.progress})}):t.jsx(Qe,{className:n.runIcon,style:{transform:"scaleX(-1)"}}),"Convert to FSH"]})})]}),t.jsxs("div",{className:n.rightControls,children:[t.jsxs(k,{name:"SaveAll",className:n.secondaryButton,onClick:e.saveAll,children:[t.jsx(it,{})," Save All"]}),t.jsxs(k,{name:"Configuration",className:n.secondaryButton,onClick:b,children:[t.jsx(Mt,{})," Configuration"]})]}),t.jsxs(me,{open:s,onClose:I,"aria-labelledby":"form-dialog-title",children:[t.jsx(Se,{id:"form-dialog-title",children:"Configuration Settings"}),t.jsxs(ae,{children:[t.jsx(Fe,{children:"Change the Implementation Guide configuration to use when processing FSH and FHIR JSON"}),t.jsx(je,{id:"canonical",margin:"dense",fullWidth:!0,label:"Canonical URL",helperText:"Default: http://example.org",defaultValue:f,onChange:N}),t.jsx(je,{id:"version",margin:"dense",fullWidth:!0,label:"Version",helperText:"Default: 1.0.0",defaultValue:r,onChange:_}),t.jsxs(je,{id:"fhir-version-select",margin:"dense",fullWidth:!0,select:!0,label:"FHIR Version",helperText:"Default: 4.0.1 (R4)",value:h,onChange:Z,children:[t.jsx(Le,{value:"4.0.1",children:"4.0.1 (R4)"}),t.jsx(Le,{value:"4.3.0",children:"4.3.0 (R4B)"}),t.jsx(Le,{value:"5.0.0",children:"5.0.0 (R5)"})]}),t.jsx(je,{id:"dependencies",margin:"dense",fullWidth:!0,label:"Dependencies",helperText:"Format: packageId#version, packageId#version (e.g., hl7.fhir.us.core#6.0.0)",defaultValue:y,onChange:X}),t.jsx(Re,{id:"goFSHIndent",margin:"dense",control:t.jsx(Oe,{checked:T,color:"primary"}),label:"Indent output of Convert to FSH",onChange:Q}),t.jsx($e,{children:"If set, Convert to FSH will output FSH using path rules"}),t.jsx(Re,{id:"lineWrap",margin:"dense",control:t.jsx(Oe,{checked:e.isLineWrapped,color:"primary"}),label:"Line wrap within code editors",onChange:le}),t.jsx($e,{children:"If set, FSH Online will display code with line wrapping"}),t.jsx(Re,{id:"debugLevelConsole",margin:"dense",control:t.jsx(Oe,{checked:e.isDebugConsoleChecked,color:"primary"}),label:"Debug level console messages",onChange:ce}),t.jsx($e,{children:"If set, FSH Online will display debug level messages within the console"})]}),t.jsx(Ce,{children:t.jsx(k,{onClick:I,color:"primary",children:"Done"})})]}),t.jsxs(me,{open:i,onClose:p,"aria-labelledby":"form-dialog-title",maxWidth:"lg",fullWidth:!0,scroll:"paper",classes:{paper:n.dialogPaper},children:[t.jsx(Se,{id:"form-dialog-title",children:"FSH Examples"}),t.jsx(ae,{children:t.jsxs(q,{container:!0,style:{overflow:"scroll",minHeight:"64vh"},children:[t.jsx(q,{item:!0,xs:4,children:t.jsx(Wt,{className:n.treeView,defaultCollapseIcon:t.jsx(rt,{}),defaultExpandIcon:t.jsx(at,{}),onNodeSelect:he,children:e.exampleConfig.map(u=>we(u))})}),t.jsx(q,{item:!0,xs:8,children:t.jsx(Je,{name:O?P:"",isExamples:!0,value:O,initialText:O,updateTextValue:pe,mode:"fsh",placeholder:ne?"Fetching example...":"Select an example",isLineWrapped:e.isLineWrapped})})]})}),t.jsxs(Ce,{className:n.dialogActions,children:[t.jsxs("div",{className:n.dialogActionsMessage,children:["Have an example that might be bene-fish-al? Seas the day and add to our collection on"," ",t.jsx(ot,{href:"https://github.com/FHIR/FSHOnline-Examples#readme",children:"GitHub"}),"!"]}),t.jsxs("div",{children:[t.jsxs(k,{onClick:ge,color:"primary",children:[t.jsx(Gt,{})," Copy to clipboard"]}),t.jsx(k,{onClick:p,color:"secondary",children:"Close"})]})]})]})]})}const Fn=re(()=>({container:{height:"100%",flexGrow:1},fullHeightGrid:{height:"100%"},editorPane:{flexGrow:"0"},resize:{height:"100%",width:"4px",cursor:"col-resize","&:hover":{background:ze.palette.common.lightBlue}},resizeBlue:{background:"#487AA2"},resizeCursor:{cursor:"col-resize"},collapsedMain:{width:"100%",height:"calc(100vh - 116px - 300px)"},expandedMain:{width:"100%",height:"calc(100vh - 116px - 34px)"},collapsedConsole:{height:"25px",width:"100%"},expandedConsole:{height:"300px",width:"100%"},top:{height:"116px"}})),gt="https://raw.githubusercontent.com/FHIR/FSHOnline-Examples/main",_e="There are no messages to display in the console.",Xe="There are no problems to display in the console.";let ve=[_e],Ie=[Xe],Ve=0,Pe="#FDD835",ft={};console._stdout={};console.log=console._stdout.write=function(n){n&&(n.startsWith("error")||n.startsWith("warn"))&&(Ie[0]===Xe&&(Ie=[]),Ve++,Ie.push(n),n.startsWith("error")&&(Pe="#FD6668")),ve[0]===_e&&(ve=[]),ve.push(n)};function xt(e){e.forEach(n=>{n.type==="category"&&xt(n.children),n.id=n.path.replaceAll("%20","-"),n.type==="file"&&(ft[n.id]={path:`${gt}/Examples/${n.path}`,description:n.description,name:n.name}),delete n.type,delete n.path})}async function Tn(){let e=await fetch(`${gt}/index.json`).then(n=>n.json());return xt(e.children),[...e.children]}async function Nn(e){if(e==null||e=="")return"";if(e.length===7){const n=await fetch(`/shares/${e}`,{headers:{Accept:"application/text"}}).then(i=>i.ok?i.text():null).catch(()=>null);return n!=null?Te.inflateSync(et.from(n,"base64")).toString("utf-8"):""}else return Te.inflateSync(et.from(e,"base64")).toString("utf-8")}async function En(e){const n=await fetch(`https://api.github.com/gists/${e}`).then(o=>o.json());let i="";for(let o of Object.values((n==null?void 0:n.files)||{}))o.truncated?i+=await fetch(o.raw_url).then(s=>s.text()):i+=o.content,i+=`

`;return i.trim()}const mt=c.createContext(!1);function We(e){const n=Fn(),i=Bt(),[o,s]=c.useState(!1),[l,f]=c.useState(""),[a,r]=c.useState([""]),[d,h]=c.useState(""),[x,y]=c.useState(!1),[m,T]=c.useState(!1),[z,ee]=c.useState(!1),[J,te]=c.useState([]),[K,ne]=c.useState({}),[V,O]=c.useState(41.666667),[D,P]=c.useState(!1),[S,C]=c.useState({canonical:"",version:"",fhirVersion:[],dependencies:""}),[p,b]=c.useState({}),[I,N]=c.useState(!1),[_,Z]=c.useState(!1),[X,Q]=c.useState(!1);c.useEffect(()=>{async function g(){if(e.path==="share"){const E=await Nn(i["*"]),Y=E.indexOf(`
`),H=E.slice(0,Y);let W,se=E;try{const G=JSON.parse(H);G.c!=null&&G.v!=null&&G.d!=null&&(W={canonical:G.c,version:G.v,fhirVersion:G.f||[],dependencies:G.d},se=E.slice(Y+1))}catch{}b(W||{}),h(se)}else if(e.path==="gist"){const E=await En(i.id);h(E)}}async function v(){te(await Tn()),ne(ft)}g(),v()},[i,e.path]);function le(){ve=[_e],Ie=[Xe],Ve=0,Pe="#FDD835"}function ce(g,v,E){s(g),r(v),y(E)}function de(g,v){T(v),h(g===""?null:g)}function ue(g){(d===""||d===null)&&h(g),f(g)}function he(g){r(g)}function pe(g){C(g),!X&&g.canonical==="ahoy to fsh"&&(console.log("ðŸŸ ahoy to you too! thanks for using FSH ONLINE!"),Q(!0))}function ge(){O(41.666667)}function Ne(g){g.preventDefault(),P(!0)}function we(g){g.preventDefault(),P(!1)}function u(){P(!0)}function w(){P(!1)}function F(g){N(g)}function $(g){Z(g)}function L(g){if(D){const v=g/window.innerWidth*100;v>10&&v<76&&O(v)}}function M(g){const v=g.clientX;D&&j.debounce(()=>L(v),10)()}function Ee(g){const v=g.touches[0].clientX;D&&j.debounce(()=>L(v),10)()}function ke(g,v){if(v.get(g)){let E=v.get(g),Y=`${g}-${E}`;for(;v.get(Y);)E=E+1,Y=`${g}-${E}`;v.set(g,E+1),g=Y,v.set(Y,1)}else v.set(g,1);return g}function St(){const g=new Map,v=new Vt;v.file("FSH.fsh",l);const[E,Y]=j.partition(a,H=>H.id&&H.id!=="Untitled");E.forEach(H=>{let W;try{W=JSON.parse(H.def)}catch{}const se=ke(W!=null&&W.resourceType?`${W.resourceType}-${H.id}`:H.id,g),G=H.def??null;v.file(`${se}.json`,G)}),Y.forEach(H=>{let W;try{W=JSON.parse(H.def)}catch{}const se=H.id??"Untitled",G=ke(W.resourceType?`${W.resourceType}-${se}`:se,g),Ct=H.def??null;v.file(`${G}.json`,Ct)}),v.generateAsync({type:"blob"}).then(H=>{Ue.saveAs(H,"fshonline.zip")})}return t.jsx(At,{theme:ze,children:t.jsxs("div",{className:"root",style:{height:"100vh"},children:[t.jsxs("div",{className:n.top,children:[t.jsx(qt,{sayAhoy:X}),t.jsx(kn,{onSUSHIClick:ce,onGoFSHClick:de,onConfigChange:pe,config:p,fshText:l,gofshText:a,resetLogMessages:le,exampleConfig:J,exampleMetadata:K,isWaiting:m||x,saveAll:St,setIsLineWrapped:F,isLineWrapped:I,setIsDebugConsoleChecked:$,isDebugConsoleChecked:_})]}),t.jsx("div",{className:z?n.collapsedMain:n.expandedMain,children:t.jsx(mt.Provider,{value:z,children:t.jsxs(q,{className:B(n.container,D&&n.resizeCursor),container:!0,onTouchMove:Ee,onMouseMove:M,onMouseUp:we,onMouseLeave:we,children:[t.jsx(q,{item:!0,className:B(n.fullHeightGrid,n.editorPane),style:{maxWidth:`calc(${V}% - 2px)`,flexBasis:`calc(${V}% - 2px)`},children:t.jsx(nn,{text:l,initialText:d,updateTextValue:ue,isWaiting:m,setInitialText:h,config:S,isLineWrapped:I})}),t.jsx(q,{item:!0,className:B(n.resize,D&&n.resizeBlue),onTouchStart:u,onTouchEnd:w,onMouseDown:Ne,onDoubleClick:ge}),t.jsx(q,{item:!0,className:B(n.fullHeightGrid,n.editorPane),style:{maxWidth:`calc(${100-V}% - 2px)`,flexBasis:`calc(${100-V}% - 2px)`},children:t.jsx(tn,{text:a,showNewText:o,setShowNewText:s,isWaiting:x,updateTextValue:he,isLineWrapped:I})})]})})}),t.jsx("div",{className:z?n.expandedConsole:n.collapsedConsole,children:t.jsx(on,{consoleMessages:ve,problemMessages:Ie,problemCount:Ve,problemColor:Pe,expandConsole:z,setExpandConsole:ee})})]})})}function Hn(){return t.jsxs(Pt,{children:[t.jsx(Me,{path:"/share/*",element:t.jsx(We,{path:"share"})}),t.jsx(Me,{path:"/gist/:id",element:t.jsx(We,{path:"gist"})}),t.jsx(Me,{path:"/*",element:t.jsx(We,{})})]})}Ut.render(t.jsx(zt.StrictMode,{children:t.jsx(Jt,{basename:"/",children:t.jsx(Hn,{})})}),document.getElementById("root"));

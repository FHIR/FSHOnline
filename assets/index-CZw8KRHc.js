import{m as ae,j as t,A as yt,T as bt,B as L,c as M,S as qe,a as Ke,b as k,E as wt,d as jt,r as c,e as re,I as le,L as vt,D as ce,f as de,g as ie,h as Ce,l as He,F as st,C as It,i as ue,k as ot,n as fe,o as ye,p as kt,q as Ft,s as it,t as Tt,u as Nt,v as Et,w as at,x as b,y as Ue,z as Ht,G as Dt,H as Lt,J as Rt,K as rt,M as Ot,N as he,O as V,P as lt,Q as ct,R as De,U as $t,V as X,W as Ze,X as Qe,Y as Mt,Z as Le,_ as Re,$ as Oe,a0 as $e,a1 as Wt,a2 as Gt,a3 as Ye,a4 as Bt,a5 as At,a6 as Vt,a7 as et,a8 as Pt,a9 as Me,aa as Ut,ab as zt,ac as Jt}from"./vendor-GmnuDfcP.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))o(s);new MutationObserver(s=>{for(const l of s)if(l.type==="childList")for(const S of l.addedNodes)S.tagName==="LINK"&&S.rel==="modulepreload"&&o(S)}).observe(document,{childList:!0,subtree:!0});function i(s){const l={};return s.integrity&&(l.integrity=s.integrity),s.referrerPolicy&&(l.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?l.credentials="include":s.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function o(s){if(s.ep)return;s.ep=!0;const l=i(s);fetch(s.href,l)}})();const _t="/assets/FSH-online-logo-BTt1RVAN.png",Xt=ae(e=>({root:{background:e.palette.common.blue,position:"static",boxShadow:"0"},title:{fontSize:20,fontWeight:700},logo:{height:"55px",width:"63px"},"@keyframes spin-once":{"0%":{rotate:"0deg"},"100%":{rotate:"360deg"}},logoSpin:{animation:"$spin-once 1000ms",animationIterationCount:1},toolbarBox:{alignItems:"center"},exitIcon:{paddingLeft:"3px",transform:"scaleX(-1)"},docButton:{color:e.palette.common.white,backgroundColor:e.palette.common.blue,fontSize:"0.875rem",fontWeight:700,"&:hover":{background:e.palette.common.lightBlue}},versionText:{color:e.palette.common.white,fontSize:"0.8rem",fontStyle:"italic",marginTop:"-5px"}}));function qt(e){const n=Xt();return t.jsx(yt,{className:n.root,children:t.jsx(bt,{children:t.jsxs(L,{className:n.toolbarBox,display:"flex",flexGrow:1,flexDirection:"row",children:[t.jsxs(L,{order:1,display:"flex",flexGrow:1,flexDirection:"row",children:[t.jsx(L,{order:1,alignSelf:"center",display:"flex",children:t.jsx("img",{src:_t,alt:"logo",className:M(n.logo,{[n.logoSpin]:e.sayAhoy})})}),t.jsx(L,{order:2,alignSelf:"center",m:1,children:t.jsxs(qe,{injectFirst:!0,children:[t.jsx(Ke,{order:1,className:n.title,children:"FSH ONLINE"}),t.jsx(Ke,{order:2,className:n.versionText,children:"Powered by SUSHI v3.16.3 and GoFSH v2.5.1"})]})})]}),t.jsx(L,{order:1,children:t.jsx(qe,{injectFirst:!0,children:t.jsxs(k,{className:n.docButton,href:"https://fshschool.org/",target:"_blank",children:[t.jsx(wt,{className:n.exitIcon,fontSize:"small"}),"Back to School"]})})})]})})})}const se={lighterBlue:"#D8E2EA",lightBlue:"#487AA2",blue:"#30638e",darkerBlue:"#143E61",editorGrey:"#263238",lightestGrey:"#E7ECEE",lightGrey:"#D0D9DD",grey:"#575B5C",darkerGrey:"#3D4345",darkestGrey:"#121D21",red:"#FD6668",green:"#50C878",orange:"#FFB347"},ze=jt({palette:{success:{main:se.blue,dark:se.darkerBlue,light:se.lightBlue},common:se},typography:{fontFamily:"Open Sans"},overrides:{MuiTooltip:{tooltip:{backgroundColor:se.darkestGrey,fontSize:"13px"},arrow:{color:se.darkestGrey}},MuiButton:{text:{textTransform:"none",fontWeight:600}},MuiIconButton:{root:{"&:hover":{backgroundColor:se.grey}}}}}),Kt=ae(e=>({iconButton:{color:e.palette.common.white,padding:"3px"},textArea:{width:"100%",color:e.palette.text.primary,fontWeight:"bold"},copyBox:{backgroundColor:e.palette.common.lightestGrey,borderRadius:2,display:"flex",justifyContent:"space-between",alignItems:"center",paddingLeft:"15px",paddingRight:"5px"},linkBox:{paddingTop:"15px",paddingBottom:"15px",paddingRight:"5px",whiteSpace:"nowrap",overflowX:"scroll",textOverflow:"ellipsis"},copyButton:{padding:"8px",borderRadius:0,"&:hover":{background:e.palette.common.lightGrey}}}));function Zt(e){const n=Kt(),[i,o]=c.useState(!1),[s,l]=c.useState(!1),[S,a]=c.useState(!1),[r,d]=c.useState(!1),[u,g]=c.useState("Copy to Clipboard"),[y,f]=c.useState("Copy Formatted Link to Clipboard"),[{fshCopied:T,fshCopyButton:P},Y]=c.useState({fshCopied:!1,fshCopyButton:"Copy FSH to Clipboard"}),[U,ee]=c.useState(),[q,te]=c.useState(),[G,R]=c.useState(!0),D=K=>{const J=K.target.value.match(/gist\.github\.com\/[^/]+\/(.+)/)?.[1];J&&te(`https://fshonline.fshschool.org/#/gist/${J}`)},B=()=>{l(!0),x()},x=()=>{o(!1),a(!0),te(""),Y({fshCopied:!1,fshCopyButton:"Copy FSH to Clipboard"})},C=()=>{a(!1),l(!1)},m=()=>{q?(C(),ee(q),o(!0),g("Copy to Clipboard"),f("Copy Formatted Link to Clipboard"),R(!1)):d(!0)},v=()=>{d(!1)},I=async()=>{let K;e.config?.canonical||e.config?.version||e.config?.fhirVersion.length>0||e.config?.dependencies?K=ye.deflateSync(JSON.stringify({c:e.config?.canonical,v:e.config?.version,f:e.config?.fhirVersion,d:e.config?.dependencies})+`
`+e.shareText).toString("base64"):K=ye.deflateSync(e.shareText).toString("base64");const J=`https://fshonline.fshschool.org/#/share/${K}`;J.length>2048?B():(ee(J),o(!0),g("Copy to Clipboard"),f("Copy Formatted Link to Clipboard"),R(!0))},N=()=>{o(!1),l(!1)},z=()=>{Y({fshCopied:!0,fshCopyButton:"FSH Copied to Clipboard"})};return t.jsxs(t.Fragment,{children:[t.jsx(re,{title:"Share FSH",placement:"top",arrow:!0,children:t.jsx(le,{name:"Share FSH",className:n.iconButton,onClick:I,children:t.jsx(vt,{fontSize:"small",style:{transform:"rotate(-45deg)"}})})}),t.jsxs(ce,{open:i,onClose:N,"aria-labelledby":"form-dialog-title",maxWidth:"md",fullWidth:!0,children:[t.jsx(de,{id:"form-dialog-title",children:"Share"}),t.jsxs(ie,{children:[t.jsx(Ce,{children:"Use this link to share your FSH with others!"}),t.jsxs(L,{className:n.copyBox,children:[t.jsx(L,{className:n.linkBox,children:U}),t.jsxs(L,{sx:{display:"flex",flexWrap:"nowrap"},children:[t.jsx(re,{title:u,placement:"top",arrow:!0,children:t.jsx(le,{className:n.copyButton,children:t.jsx(He.CopyToClipboard,{text:U,onCopy:()=>g("Link Copied"),children:t.jsx(st,{fontSize:"small"})})})}),t.jsx(re,{title:y,placement:"top",arrow:!0,children:t.jsx(le,{className:n.copyButton,children:t.jsx(He.CopyToClipboard,{text:`[FSH Online Link](${U})`,onCopy:()=>f("Link Copied"),options:{format:"text/plain"},children:t.jsx(It,{fontSize:"small"})})})})]})]})]}),t.jsxs(ue,{children:[G&&t.jsx(k,{onClick:x,color:"primary",style:{align:"left"},children:"Create Link with Gist"}),t.jsx(L,{style:{flex:"1 0 0",hidden:!0}}),t.jsx(k,{onClick:N,color:"primary",children:"Done"})]})]}),t.jsxs(ce,{open:S,onClose:C,"aria-labelledby":"alert-dialog-title",maxWidth:"md",fullWidth:!0,children:[t.jsx(de,{id:"alert-dialog-title",children:"Share with Gist"}),s&&t.jsx(ie,{style:{color:ze.palette.common.red},children:"Your FSH content is too long to share directly. Please use a Gist to share."}),t.jsxs(ie,{children:["Create a"," ",t.jsx(ot,{id:"gistURL",href:"https://gist.github.com/",target:"_blank",children:"Gist"})," ","and paste the URL below to generate a shareable FSH Online link.",t.jsx(fe,{id:"gistURLText",label:"Gist URL",fullWidth:!0,onChange:D})]}),t.jsxs(ue,{style:{bottom:0,right:0},children:[t.jsx(k,{onClick:C,color:"primary",children:"Cancel"}),t.jsx(L,{style:{flex:"1 0 0",hidden:!0}}),t.jsx(He.CopyToClipboard,{text:e.shareText,onCopy:z,style:{align:"left"},children:t.jsx(k,{color:T?"secondary":"primary",children:P})}),t.jsx(k,{color:"primary",onClick:m,style:{align:"left"},children:"Generate Link from Gist"})]})]}),t.jsxs(ce,{open:r,onClose:v,"aria-labelledby":"alert-dialog-title",maxWidth:"lg",children:[t.jsx(de,{id:"alert-dialog-title",children:"Error Creating Gist Link"}),t.jsx(ie,{children:t.jsx(Ce,{children:"Could not generate a link from your Gist URL. Ensure the URL is valid."})}),t.jsx(ue,{children:t.jsx(k,{onClick:v,color:"primary",children:"Keep Swimming!"})})]})]})}kt.defineSimpleMode("fsh",{meta:{lineComment:"//"},start:[{regex:/"(?:[^\\]|\\.)*?(?:"|$)/,token:"atom"},{regex:/\b(Alias|Characteristics|Context|CodeSystem|Expression|Extension|Description|Id|Instance|InstanceOf|Invariant|Logical|Mapping|Mixins|Parent|Profile|Resource|RuleSet|Severity|Source|Target|Title|Usage|ValueSet|XPath)(?=\s*:)\b/,token:"keyword"},{regex:/(\s|^)(and|codes|contains|descendent-of|exclude|exists|from system|from|generalizes|include|in|insert|is-a|is-not-a|named|not-in|obeys|only|or|regex|units|valueset|where|D|MS|N|SU|TU|\\?!)(\s|$)/,token:"def"},{regex:/(\(\s*)(exactly|example|extensible|preferred|required)(\s*\))/,token:"def"},{regex:/\b(CodeableReference|Reference|Canonical)\s*\(/,push:"closingParen",token:"atom"},{regex:/\*|->|=|\+|:/,token:"def"},{regex:/\b(https?:\/\/(www\.)?[-a-zA-Z0-9@:%._+~#=]{2,256}\.[a-z]{2,6}\b([-a-zA-Z0-9@:%_+.~#?&//=]*))\b/,token:"atom"},{regex:/(\s|^)(true|false)(\s|$)/,token:"string"},{regex:/(\s|^)(-?\d+(\.\d+)?)(\s|^)/,token:"string"},{regex:/#"(?:\\.|[^\\"])*"/,token:"string"},{regex:/#[^\s]*/,token:"string"},{regex:/'.*'/,token:"string"},{regex:/\s\/\/.*/,token:"comment"},{regex:/\/\/.*/,token:"comment",sol:!0},{regex:/\/\*/,token:"comment",next:"comment"}],closingParen:[{regex:/\)/,pop:!0,token:"atom"}],comment:[{regex:/.*?\*\//,token:"comment",next:"start"},{regex:/.*/,token:"comment"}]});const ge=200,Qt=ae(e=>({box:{height:"100%"},header:{fontFamily:"Open Sans",color:e.palette.common.white,background:e.palette.common.darkerGrey,padding:"0px",paddingLeft:"29px",height:"34px",display:"flex",justifyContent:"space-between",transition:e.transitions.create(["margin","width"],{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen})},headerShift:{width:`calc(100% - ${ge}px - 29px)`,transition:e.transitions.create(["margin","width"],{easing:e.transitions.easing.easeOut,duration:e.transitions.duration.enteringScreen}),marginRight:ge},headerLabel:{lineHeight:"34px",float:"left",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},headerActionGroup:{paddingRight:"10px"},headerActions:{alignItems:"center",display:"flex"},iconButton:{color:e.palette.common.white,padding:"3px"},drawer:{width:ge,flexShrink:0},drawerPaper:{width:ge,border:"none",height:"calc(100vh - 116px - 34px)",top:"116px"},drawerPaperExpandedConsole:{height:"calc(100vh - 116px - 300px)"},drawerHeader:{display:"flex",alignItems:"center",justifyContent:"flex-start",color:e.palette.common.white,background:e.palette.common.darkerGrey,height:"34px",minHeight:"34px"},drawerHeaderIcon:{padding:"0px",color:e.palette.common.white,background:e.palette.success.main,"&:hover":{background:e.palette.success.light},borderRadius:0,height:"100%",width:"34px",minWidth:"34px"},content:{flexGrow:1,width:"100%",transition:e.transitions.create(["margin","width"],{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen})},contentShift:{width:`calc(100% - ${ge}px)`,transition:e.transitions.create(["margin","width"],{easing:e.transitions.easing.easeOut,duration:e.transitions.duration.enteringScreen}),marginRight:0}}));function Je(e){const n=Qt(),i=c.useContext(mt),[o,s]=c.useState(!0),l=()=>{s(!0)},S=()=>{s(!1)};function a(g){e.updateTextValue(g)}const r=(g,y,f,T={})=>t.jsx(re,{title:b.upperFirst(y),placement:"top",arrow:!0,children:t.jsx(le,{name:y,className:n.iconButton,"aria-label":y,onClick:f,children:t.jsx(g,{fontSize:"small",style:T})})}),d=()=>t.jsxs("div",{className:n.headerActions,children:[t.jsxs("div",{className:n.headerActionGroup,children:[e.mode==="fsh"&&!e.isExamples&&t.jsx(Zt,{shareText:e.value,config:e.config}),e.copy&&r(st,"copy",()=>{}),e.save&&r(it,"save",e.save),e.delete&&r(Tt,"delete",e.delete)]}),e.renderDrawer&&!o&&t.jsx(le,{name:"expand",className:n.drawerHeaderIcon,"aria-label":"expand",onClick:l,children:t.jsx(Nt,{})})]}),u=()=>t.jsxs(Et,{className:n.drawer,"data-testid":"editor-drawer",variant:"persistent",anchor:"right",open:o,classes:{paper:M(n.drawerPaper,i&&n.drawerPaperExpandedConsole)},children:[t.jsx("div",{className:n.drawerHeader,children:t.jsx(k,{name:"collapse","aria-label":"collapse",className:n.drawerHeaderIcon,onClick:S,children:t.jsx(at,{})})}),e.renderDrawer()]});return t.jsxs(L,{className:n.box,children:[t.jsxs("div",{className:M(n.header,{[n.headerShift]:e.renderDrawer&&o}),children:[t.jsx("div",{title:e.name,className:n.headerLabel,children:e.name}),d()]}),t.jsx(Ft.UnControlled,{className:M("react-codemirror2",e.renderDrawer&&n.content,{[n.contentShift]:e.renderDrawer&&o}),value:e.initialText,options:{mode:e.mode,theme:"material",placeholder:e.placeholder,scrollbarStyle:"overlay",autoCloseBrackets:!0,lineNumbers:!0,foldGutter:!0,readOnly:e.isExamples,gutters:["CodeMirror-linenumbers","CodeMirror-foldgutter"],extraKeys:{Tab:g=>{g.replaceSelection("  ")},"Ctrl-/":"toggleComment","Cmd-/":"toggleComment","Ctrl-Q":g=>{g.foldCode(g.getCursor())}},lineWrapping:e.isLineWrapped},onChange:(g,y,f)=>{a(f)}}),e.renderDrawer&&u()]})}function dt(e){return t.jsxs(ce,{open:e.isOpen,onClose:e.handleCloseModal,"aria-labelledby":"delete-confirmation-dialog",children:[t.jsxs(de,{id:"delete-confirmation-dialog-title",children:["Delete ",e.title]}),t.jsx(ie,{children:t.jsxs(Ce,{children:["Are you sure you want to delete ",e.item,"? This action cannot be undone."]})}),t.jsxs(ue,{children:[t.jsx(k,{onClick:e.handleCloseModal,color:"primary",children:"Cancel"}),t.jsx(k,{onClick:e.handleDelete,color:"secondary",children:"Delete"})]})]})}const Yt=ae(e=>({fileTreeContent:{overflowY:"scroll",height:"100%"},button:{color:e.palette.common.white,background:e.palette.success.main,"&:hover":{background:e.palette.success.dark},border:"8px solid white",fontSize:"13px",width:"100%"},list:{padding:"8px",paddingLeft:"0px",paddingBottom:"0px",fontSize:"13px"},listItemError:{paddingTop:"5px",paddingBottom:"5px",margin:0},listItem:{background:e.palette.common.lightestGrey,paddingTop:"5px",paddingBottom:"5px",marginTop:"5px",marginBottom:"5px",paddingLeft:"5px",margin:0,"&:hover":{background:e.palette.common.lightGrey},display:"block",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},listItemSelected:{background:e.palette.common.editorGrey,color:e.palette.common.white,"&:hover":{background:e.palette.common.darkestGrey}},listHeader:{padding:"5px",paddingLeft:"15px"},listIcon:{color:e.palette.success.main,verticalAlign:"middle",fontSize:"13px",paddingLeft:"3px",paddingRight:"3px"},listIconError:{color:e.palette.common.red},blankIcon:{paddingLeft:"19px"}})),Ge=e=>{if(e.resourceType==="ValueSet"||e.resourceType==="CodeSystem")return e.resourceType;if(e.resourceType==="StructureDefinition"){if(e.derivation==="specialization"){if(e.kind==="resource")return"Resource";if(e.kind==="logical")return"Logical Model"}else if(e.derivation==="constraint"){if(e.kind==="complex-type"&&e.type==="Extension")return"Extension";if(["resource","complex-type","primitive-type","logical"].includes(e.kind))return"Profile"}}return e.resourceType!=null?"Instance":null},Be=e=>{if(e.id)if(typeof e.id=="object"){if(e.id.value)return e.id.value}else return e.id;return e.resourceType?`Instance of ${e.resourceType.substring(e.resourceType.lastIndexOf("/")+1)}`:"Untitled"},en=e=>[...e.profiles,...e.extensions,...e.logicals,...e.resources,...e.instances,...e.valueSets,...e.codeSystems].map(i=>({resourceType:Ge(i),id:Be(i),def:JSON.stringify(i,null,2)}));function tn(e){const n=Yt(),[i,o]=c.useState(""),[s,l]=c.useState([{resourceType:null,id:"Untitled",def:null}]),{setShowNewText:S,updateTextValue:a}=e,[r,d]=c.useState(0),[u,g]=c.useState([]),[y,f]=c.useState(!1);c.useEffect(()=>{if(e.showNewText&&!b.isEqual(e.text,[""])){S(!1);let x;try{x=JSON.parse(e.text)}catch{x={profiles:[],extensions:[],logicals:[],resources:[],instances:[],valueSets:[],codeSystems:[]}}const C=en(x);l(C),d(0),o(C.length>0?C[0].def:""),a(C)}else e.isWaiting&&(o(null),l([]))},[e.text,e.showNewText,e.isWaiting,a,S]);const T=x=>{if(e.isWaiting)return;const C=[...s];try{const m=x===""?{}:JSON.parse(x);if(u.includes(r)){const v=[...u];v.splice(u.indexOf(r),1),g(v)}s[r]||(C[r]={resourceType:Ge(m),id:Be(m)}),(!s[r]||m.resourceType!==s[r].resourceType)&&(C[r].resourceType=Ge(m)),(!s[r]||m.id!==s[r].id)&&(C[r].id=Be(m))}catch{if(!u.includes(r)){const v=[...u];v.push(r),g(v)}}C[r]&&(C[r].def=x),l(C),e.updateTextValue(C),i===null&&o(x)},P=()=>{const x=[...s];x.push({resourceType:null,id:"Untitled",def:null}),d(x.length-1),l(x),o(null),e.updateTextValue(x)},Y=()=>{const x=r,C=[...s];if(C.splice(x,1),C.length===0&&C.push({resourceType:null,id:"Untitled",def:null}),l(C),x<=r){let I=0;x<r&&(I=r-1),d(I);const N=C.length>0?C[I].def:null;o(N)}const m=[...u];u.includes(x)&&m.splice(u.indexOf(x),1);const v=m.map(I=>I<x?I:I-1);g(v),f(!1),e.updateTextValue(C)},U=()=>{f(!0)},ee=()=>{f(!1)},q=(x,C)=>{let m;try{m=JSON.parse(x)}catch{}Ue.saveAs(new Blob([x]),m?.resourceType&&m?.id?`${m.resourceType}-${m.id}.json`:`${C}.json`)},te=()=>{const x=s[r];if(!x)return;const C=x.resourceType||"Unknown Type",m=x.id||"Untitled";return t.jsx(dt,{title:"FHIR JSON",item:`${C} ${m}`,isOpen:y,handleCloseModal:ee,handleDelete:Y})},G=()=>{const x=["Profiles","Extensions","Logical Models","Resources","ValueSets","CodeSystems","Instances","Unknown Type"],C=b.groupBy(s,m=>m&&m.resourceType?`${m.resourceType}s`:"Unknown Type");return Object.keys(C).sort((m,v)=>x.indexOf(m)-x.indexOf(v)).map(m=>t.jsxs(Dt,{component:"nav",className:n.list,children:[t.jsx("div",{className:n.listHeader,children:m}),C[m].sort((v,I)=>{const N=v.id?v.id:"Untitled",z=I.id?I.id:"Untitled";return N.toLowerCase()<z.toLowerCase()?-1:N.toLowerCase()>z.toLowerCase()?1:0}).map((v,I)=>{const N=s.indexOf(v),z=u.includes(N);return t.jsxs(Lt,{button:!0,title:v?.id||"Untitled","data-testid":`${m}-defId`,className:M(n.listItem,z&&n.listItemError,N===r&&n.listItemSelected),onClick:()=>{d(N),o(v.def)},children:[u.includes(N)?t.jsx(re,{title:"Invalid JSON",placement:"top",arrow:!0,children:t.jsx(Rt,{className:M(n.listIcon,n.listIconError)})}):t.jsx("span",{className:n.blankIcon}),v?.id||"Untitled"]},I)})]},m))},R=()=>t.jsxs(t.Fragment,{children:[t.jsx(k,{className:n.button,startIcon:t.jsx(Ht,{}),onClick:P,children:"New JSON Editor"}),t.jsx("div",{className:n.fileTreeContent,children:G()})]}),D=s.length>0?s[r].def:null,B=`${s.length>0?s[r].id:"Untitled"}`;return t.jsxs(t.Fragment,{children:[t.jsx(Je,{name:`FHIR JSON: ${B}`,value:D,initialText:i,updateTextValue:T,mode:"application/json",placeholder:e.isWaiting?"Loading...":`Paste or edit single FHIR JSON artifact here... 
Create additional FHIR JSON artifacts to the right.`,renderDrawer:R,isExamples:!1,delete:U,save:()=>q(D,B),isLineWrapped:e.isLineWrapped}),y&&te()]})}function nn(e){const[n,i]=c.useState(!1),o=()=>{i(!n)},s=()=>{i(!1),e.setInitialText("")},l=()=>{Ue.saveAs(new Blob([e.text]),"FSH.fsh")};return t.jsxs(t.Fragment,{children:[t.jsx(Je,{name:"FSH",isExamples:!1,value:e.text,initialText:e.initialText,updateTextValue:e.updateTextValue,mode:"fsh",placeholder:e.isWaiting?"Loading...":"Paste or edit FSH here...",delete:o,save:l,config:e.config,isLineWrapped:e.isLineWrapped}),n&&t.jsx(dt,{title:"FHIR Shorthand",item:"all FSH",isOpen:n,handleCloseModal:o,handleDelete:s})]})}const sn=ae(e=>({consoleControls:{background:e.palette.common.darkestGrey,height:"34px",boxSizing:"border-box",display:"flex;",alignItems:"center",justifyContent:"left"},box:{paddingLeft:"29px",color:e.palette.common.white,background:e.palette.common.darkestGrey,height:"calc(100% - 34px)",overflow:"scroll",boxSizing:"border-box"},button:{marginRight:"10px",color:e.palette.common.white,textTransform:"none",padding:0},problemsButton:{padding:0,color:e.palette.common.white,textTransform:"none"},expandIcon:{width:"29px",color:e.palette.common.white,padding:0},pre:{margin:"0px"},error:{background:e.palette.common.red,paddingRight:"0.4em",paddingLeft:"0.2em"},warn:{background:e.palette.common.orange,paddingRight:"1em",paddingLeft:"0.2em"},info:{background:e.palette.common.green,paddingRight:"1em",paddingLeft:"0.2em"},debug:{background:e.palette.common.blue,paddingRight:"0.4em",paddingLeft:"0.2em"},circle:{"border-radius":"50%","border-style":"solid","border-width":"2px","min-width":"20px",height:"20px",paddingLeft:1,paddingRight:1,background:"#263238","align-items":"center",display:"flex",marginLeft:4,"justify-content":"center",padding:0}}));function on(e){const n=sn(),[i,o]=c.useState(!1),[s,l]=c.useState([]),{problemCount:S,setExpandConsole:a}=e;c.useEffect(()=>{S&&a(!0)},[S,a]),c.useEffect(()=>{const y=(i?e.problemMessages:e.consoleMessages).map(f=>f.startsWith("error")?{logLevel:"error",consoleMessage:f.slice(5)}:f.startsWith("warn")?{logLevel:"warn",consoleMessage:f.slice(4)}:f.startsWith("info")?{logLevel:"info",consoleMessage:f.slice(4)}:f.startsWith("debug")?{logLevel:"debug",consoleMessage:f.slice(5)}:{logLevel:"",consoleMessage:f});l(y)},[e.consoleMessages,e.problemMessages,i]);const r=()=>{e.setExpandConsole(!e.expandConsole)},d=()=>{o(!1),e.setExpandConsole(!0)},u=()=>{o(!0),e.setExpandConsole(!0)},g=(y,f)=>t.jsxs("pre",{className:n.pre,children:[y.logLevel&&t.jsx("span",{className:n[y.logLevel],children:y.logLevel}),y.consoleMessage]},f);return t.jsxs(t.Fragment,{children:[t.jsxs(L,{className:n.consoleControls,children:[t.jsx(le,{onClick:r,"aria-label":e.expandConsole?"collapse console":"expand console",className:n.expandIcon,children:e.expandConsole?t.jsx(rt,{}):t.jsx(Ot,{})}),t.jsx(k,{onClick:d,className:n.button,children:t.jsx("p",{style:{borderBottom:e.expandConsole&&!i?"1px solid white":"none",margin:"0"},children:"Console"})}),t.jsxs(k,{onClick:u,className:n.problemsButton,children:[t.jsx("p",{style:{borderBottom:e.expandConsole&&i?`1px solid ${e.problemCount?e.problemColor:"white"}`:"none",margin:"0"},children:"Problems"}),t.jsx("div",{className:n.circle,style:{borderColor:`${e.problemCount?e.problemColor:"white"}`},children:e.problemCount})]})]}),t.jsx(L,{style:{display:e.expandConsole?"block":"none"},className:n.box,children:s.map((y,f)=>g(y,f))})]})}let W=he.utils.logger;function ut(e,n){e==="sushi"?W=he.utils.logger:e==="gofsh"&&(W=V.utils.logger),W.level=n}const{FSHTank:an,RawFSH:rn}=he.sushiImport,{exportFHIR:ln}=he.sushiExport,{createFHIRDefinitions:cn,FHIRDefinitions:dn}=he.fhirdefs,{AUTOMATIC_DEPENDENCIES:un,fillTank:hn,getFHIRVersionInfo:pn,getRandomPun:ht,loadExternalDependencies:gn,stats:Ae,Type:fn}=he.utils,{loadExternalDependencies:xn,stats:oe}=V.utils;async function mn(e,n,i){oe.reset(),ut("gofsh",i);const o=[];e.forEach((g,y)=>{const f=`Input_${y}`;try{g=JSON.parse(g),g.resourceType||W.error(`FHIR JSON ${g.id??f} is missing the required "resourceType" property`)}catch{W.error(`Could not parse ${f} to JSON`);return}V.utils.isProcessableContent(g,f)&&o.push(new V.processor.WildFHIR({content:g},f))}),await lt({locateFile:()=>ct});const s=new V.processor.LakeOfFHIR(o);await s.prepareDefs();const l=await bn(s,n.dependencies),S=await pt(l.config.dependencies,l,!1),a=new V.utils.MasterFisher(s,S),r=new V.processor.FHIRProcessor(s,a),d=await V.utils.getResources(r,l,{indent:n.indent}),u=new V.gofshExport.FSHExporter(d).apiExport("string");return W.info("Done converting definitions"),yn(d),{fsh:u,config:l?.config??{}}}async function Sn(e,n,i=[],o){Ae.reset(),ut("sushi",o),await lt({locateFile:()=>ct});const s=await pt(i,n,!0);let l=an;try{const d=[new rn(e)];l=hn(d,n)}catch{W.error("Something went wrong when importing the FSH definitions");return}if(s.fishForFHIR("StructureDefinition",fn.Resource)?.version!==n.fhirVersion[0]){W.error("StructureDefinition resource not found. The FHIR package in the browser cache may be corrupt. Clear cookies and site data on this webpage to reload the FHIR package.");return}W.info("Converting FSH to FHIR resources...");const a=ln(l,s),r=a.profiles.length+a.extensions.length+a.logicals.length+a.resources.length+a.instances.filter(d=>d._instanceMeta.usage!=="Inline").length+a.valueSets.length+a.codeSystems.length;return W.info(`Exported ${r} FHIR resources as JSON.`),console.log(" "),Cn(a),a.profiles=a.profiles.map(d=>d.toJSON(!1)),a.extensions=a.extensions.map(d=>d.toJSON(!1)),a.logicals=a.logicals.map(d=>d.toJSON(!1)),a.resources=a.resources.map(d=>d.toJSON(!1)),a.instances=a.instances.filter(d=>d._instanceMeta.usage!=="Inline"),a}function Cn(e){const n=Ae.numError,i=Ae.numWarn,o=b.pad(e.profiles.length.toString(),13),s=b.pad(e.extensions.length.toString(),12),l=b.pad(e.logicals.length.toString(),12),S=b.pad(e.resources.length.toString(),13),a=b.pad(e.valueSets.length.toString(),18),r=b.pad(e.codeSystems.length.toString(),17),d=b.pad(e.instances.length.toString(),18),u=b.pad(`${n} Error${n!==1?"s":""}`,13),g=b.padStart(`${i} Warning${i!==1?"s":""}`,12),y=b.padEnd(ht(n,i),36);["â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• SUSHI RESULTS â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—","â•‘ â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•® â•‘","â•‘ â”‚    Profiles   â”‚  Extensions  â”‚   Logicals   â”‚   Resources   â”‚ â•‘","â•‘ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â•‘",`â•‘ â”‚ ${o} â”‚ ${s} â”‚ ${l} â”‚ ${S} â”‚ â•‘`,"â•‘ â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯ â•‘","â•‘ â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•® â•‘","â•‘ â”‚      ValueSets     â”‚    CodeSystems    â”‚     Instances      â”‚ â•‘","â•‘ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â•‘",`â•‘ â”‚ ${a} â”‚ ${r} â”‚ ${d} â”‚ â•‘`,"â•‘ â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯ â•‘","â•‘                                                                 â•‘","â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£",`â•‘ ${y} ${u} ${g} â•‘`,"â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"].forEach(T=>console.log(T))}function yn(e){const n=b.pad(e.profiles.length.toString(),18),i=b.pad(e.extensions.length.toString(),17),o=b.pad(e.logicals.length.toString(),18),s=b.pad(e.resources.length.toString(),18),l=b.pad(e.valueSets.length.toString(),17),S=b.pad(e.codeSystems.length.toString(),18),a=b.pad(e.instances.length.toString(),18),r=b.pad(e.invariants.length.toString(),17),d=b.pad(e.mappings.length.toString(),18),u=b.pad(`${oe.numError} Error${oe.numError!==1?"s":""}`,12),g=b.padStart(`${oe.numWarn} Warning${oe.numWarn!==1?"s":""}`,12),y=b.padEnd(ht(oe.numError,oe.numWarn),37),f=["â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• GoFSH RESULTS â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—","â•‘ â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•® â•‘","â•‘ â”‚      Profiles      â”‚    Extensions     â”‚      Logicals      â”‚ â•‘","â•‘ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â•‘",`â•‘ â”‚ ${n} â”‚ ${i} â”‚ ${o} â”‚ â•‘`,"â•‘ â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯ â•‘","â•‘ â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•® â•‘","â•‘ â”‚     Resources      â”‚     ValueSets     â”‚     CodeSystems    â”‚ â•‘","â•‘ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â•‘",`â•‘ â”‚ ${s} â”‚ ${l} â”‚ ${S} â”‚ â•‘`,"â•‘ â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯ â•‘","â•‘ â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•® â•‘","â•‘ â”‚     Instances      â”‚    Invariants     â”‚      Mappings      â”‚ â•‘","â•‘ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â•‘",`â•‘ â”‚ ${a} â”‚ ${r} â”‚ ${d} â”‚ â•‘`,"â•‘ â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯ â•‘","â•‘                                                                 â•‘","â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£",`â•‘ ${y} ${u} ${g} â•‘`,"â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"];console.log(" "),f.forEach(T=>console.log(T))}async function pt(e,n,i){const o=(u,g)=>{W.log(u,g)},s=new De.FHIRRegistryClient("https://packages.fhir.org",{log:o,isBrowserEnvironment:!0}),S=(await wn(i?e:n.config.dependencies??[],i?n.fhirVersion[0]:n.config.fhirVersion[0],s)).map(u=>({name:u.packageId,version:u.version})),a=new De.SQLJSPackageDB;await a.initialize();const r=new De.BrowserBasedPackageCache("FSHOnline Dependencies",{log:o});await r.initialize(S);const d=await cn(!1,null,{packageCache:r,packageDB:a,registryClient:s,options:{log:o}});return i?(n.dependencies=e.filter(tt),await gn(d,n)):(n.config.dependencies!=null&&(n.config.dependencies=n.config.dependencies.filter(tt)),await xn(d,n)),d.optimize(),d}async function bn(e,n){const i=new dn;await i.initialize();const o=new V.utils.MasterFisher(e,i),s=new V.processor.FHIRProcessor(e,o),l=n.map(a=>a.replace("#","@"));return s.processConfig(l??[])}async function wn(e,n,i){const o=[];for(const a of e){const{packageId:r}=a,d=await i.resolveVersion(r,a.version);o.push({packageId:r,version:d})}const s=pn(n),l={packageId:s.packageId,version:n};nt(o,l)||o.push(l);const S=un.filter(a=>a.version!=="current");for(const a of S){if(a.fhirVersions&&!a.fhirVersions.includes(s.name))continue;const{packageId:r}=a,d=await i.resolveVersion(r,a.version);nt(o,a)||o.push({packageId:r,version:d})}return o}function tt(e){return e.version==null&&W.warn(`Skipping ${e.packageId} because it does not include a version. Use format packageId#version.`),e.version!=null}function nt(e,n,i=!1){return e.some(o=>o.packageId===n.packageId&&(i||o.version===n.version))}function jn(e){return e.split(",").map(i=>{const o=i.trim();if(o==="")return o;const[s,l]=o.split("#");return{packageId:s,version:l}}).filter(i=>i)}const vn=ae(e=>({box:{padding:e.spacing(1),color:e.palette.text.primary,background:e.palette.background.paper,display:"flex;",alignItems:"center",justifyContent:"center"},rightControls:{position:"absolute",right:"24px"},leftControls:{position:"absolute",left:"28px"},secondaryButton:{color:e.palette.success.main,"&:hover":{background:e.palette.common.lighterBlue}},progressContainer:{width:"24px",height:"24px"},progress:{height:"1em !important",width:"1em !important",verticalAlign:"middle",color:e.palette.common.white},button:{color:e.palette.common.white,background:e.palette.success.main,borderRadius:"0",paddingRight:"15px",paddingLeft:"15px","&:hover":{background:e.palette.success.dark}},buttonLeft:{float:"right",left:"-3.33px"},buttonRight:{float:"left",right:"-0.67px"},runIcon:{padding:"0px"},dialogPaper:{maxHeight:"80vh",minHeight:"80vh"},dialogActions:{justifyContent:"space-between"},dialogActionsMessage:{fontStyle:"italic",padding:"6px 8px"}}));function In(e,n){if(e!=="config")return n}function kn(e){const n=vn(),[i,o]=c.useState(!1),[s,l]=c.useState(!1),[S,a]=c.useState(""),[r,d]=c.useState(""),[u,g]=c.useState(""),[y,f]=c.useState(""),[T,P]=c.useState(!1),[Y,U]=c.useState(!1),[ee,q]=c.useState(!1),[te,G]=c.useState(!1),[R,D]=c.useState(""),[B,x]=c.useState("");c.useEffect(()=>{a(e.config?.canonical||""),d(e.config?.version||""),g(e.config?.fhirVersion?.length>0?e.config.fhirVersion.at(0):""),f(e.config?.dependencies||"")},[e.config]);const C=()=>{o(!0)},m=()=>{o(!1),D("")},v=()=>{l(!0)},I=()=>{l(!1),e.onConfigChange({canonical:S,version:r,fhirVersion:[u],dependencies:y,isGoFSHIndented:T})},N=h=>{const w=h.target.value;a(w)},z=h=>{const w=h.target.value;d(w)},K=h=>{const w=h.target.value;g(w)},J=h=>{const w=h.target.value;f(w)},be=h=>{const w=h.target.checked;P(w)},we=h=>{const w=h.target.checked;e.setIsLineWrapped(w)},je=h=>{const w=h.target.checked;e.setIsDebugConsoleChecked(w)};async function ve(){if(e.isWaiting)return;e.resetLogMessages(),e.onSUSHIClick(!0,[""],!0),U(!0);const h=jn(y),w={canonical:S||"http://example.org",version:r||"1.0.0",FSHOnly:!0,fhirVersion:u?[u]:["4.0.1"]},F=await Sn(e.fshText,w,h,e.isDebugConsoleChecked?"debug":"info");let Z=JSON.stringify(F,In,2);F&&F.codeSystems?!F.codeSystems.length&&!F.extensions.length&&!F.instances.length&&!F.profiles.length&&!F.logicals.length&&!F.resources.length&&!F.valueSets.length&&(Z=[""]):Z=[""],e.onSUSHIClick(!0,Z,!1),U(!1)}async function Ie(){if(e.isWaiting)return;e.resetLogMessages(),e.onGoFSHClick("",!0),q(!0);const h=e.gofshText.map(O=>O.def).filter(O=>O),w=y===""?[]:y.split(",").map(O=>O.trim());if(S||r||u!==""){const O={resourceType:"ImplementationGuide",fhirVersion:u?[u]:["4.0.1"],id:"1",...S&&{url:`${S}/ImplementationGuide/1`},...r&&{version:r}};h.push(JSON.stringify(O,null,2))}const F={dependencies:w,indent:T},{fsh:Z,config:A}=await mn(h,F,e.isDebugConsoleChecked?"debug":"info");e.onGoFSHClick(Z,!1),q(!1),S===""&&A.canonical&&a(A.canonical),r===""&&A.version&&d(A.version),u===""&&A.fhirVersion&&g(A.fhirVersion.at(0))}async function ke(h,w){if(!w.endsWith(".fsh"))return;const F=e.exampleMetadata[w];G(!0),x(F.name);const Z=new TextDecoder("utf-8");let A=await fetch(F.path).then(Se=>Se.body.getReader()),O="";const{value:Ee}=await A.read();O+=Z.decode(Ee),G(!1),D(O)}function Fe(h){D(h)}function Te(){navigator.clipboard.writeText(R)}const Ne=h=>t.jsx(re,{title:e.exampleMetadata[h.id]&&e.exampleMetadata[h.id].description?e.exampleMetadata[h.id].description:h.name,placement:"bottom",arrow:!0,children:t.jsx(Ye,{nodeId:h.id,label:h.name,className:n.treeItem},h.id)},h.id),pe=h=>t.jsx(Ye,{nodeId:h.id,label:h.name,children:h.children?h.children.map(w=>w.children?pe(w):Ne(w)):null},h.id);return t.jsxs(L,{className:n.box,children:[t.jsx("div",{className:n.leftControls,children:t.jsxs(k,{name:"Examples",className:n.button,onClick:C,children:[t.jsx($t,{})," Â  FSH Examples"]})}),t.jsxs(X,{container:!0,children:[t.jsx(X,{item:!0,xs:5,children:t.jsxs(k,{className:M(n.button,n.buttonLeft),onClick:ve,testid:"Button",children:["Convert to JSON",Y?t.jsx("div",{className:n.progressContainer,children:t.jsx(Ze,{className:n.progress})}):t.jsx(Qe,{className:n.runIcon})]})}),t.jsx(X,{item:!0,xs:7,children:t.jsxs(k,{className:M(n.button,n.buttonRight),onClick:Ie,testid:"GoFSH-button",children:[ee?t.jsx("div",{className:n.progressContainer,children:t.jsx(Ze,{className:n.progress})}):t.jsx(Qe,{className:n.runIcon,style:{transform:"scaleX(-1)"}}),"Convert to FSH"]})})]}),t.jsxs("div",{className:n.rightControls,children:[t.jsxs(k,{name:"SaveAll",className:n.secondaryButton,onClick:e.saveAll,children:[t.jsx(it,{})," Save All"]}),t.jsxs(k,{name:"Configuration",className:n.secondaryButton,onClick:v,children:[t.jsx(Mt,{})," Configuration"]})]}),t.jsxs(ce,{open:s,onClose:I,"aria-labelledby":"form-dialog-title",children:[t.jsx(de,{id:"form-dialog-title",children:"Configuration Settings"}),t.jsxs(ie,{children:[t.jsx(Ce,{children:"Change the Implementation Guide configuration to use when processing FSH and FHIR JSON"}),t.jsx(fe,{id:"canonical",margin:"dense",fullWidth:!0,label:"Canonical URL",helperText:"Default: http://example.org",defaultValue:S,onChange:N}),t.jsx(fe,{id:"version",margin:"dense",fullWidth:!0,label:"Version",helperText:"Default: 1.0.0",defaultValue:r,onChange:z}),t.jsxs(fe,{id:"fhir-version-select",margin:"dense",fullWidth:!0,select:!0,label:"FHIR Version",helperText:"Default: 4.0.1 (R4)",value:u,onChange:K,children:[t.jsx(Le,{value:"4.0.1",children:"4.0.1 (R4)"}),t.jsx(Le,{value:"4.3.0",children:"4.3.0 (R4B)"}),t.jsx(Le,{value:"5.0.0",children:"5.0.0 (R5)"})]}),t.jsx(fe,{id:"dependencies",margin:"dense",fullWidth:!0,label:"Dependencies",helperText:"Format: packageId#version, packageId#version (e.g., hl7.fhir.us.core#6.0.0)",defaultValue:y,onChange:J}),t.jsx(Re,{id:"goFSHIndent",margin:"dense",control:t.jsx(Oe,{checked:T,color:"primary"}),label:"Indent output of Convert to FSH",onChange:be}),t.jsx($e,{children:"If set, Convert to FSH will output FSH using path rules"}),t.jsx(Re,{id:"lineWrap",margin:"dense",control:t.jsx(Oe,{checked:e.isLineWrapped,color:"primary"}),label:"Line wrap within code editors",onChange:we}),t.jsx($e,{children:"If set, FSH Online will display code with line wrapping"}),t.jsx(Re,{id:"debugLevelConsole",margin:"dense",control:t.jsx(Oe,{checked:e.isDebugConsoleChecked,color:"primary"}),label:"Debug level console messages",onChange:je}),t.jsx($e,{children:"If set, FSH Online will display debug level messages within the console"})]}),t.jsx(ue,{children:t.jsx(k,{onClick:I,color:"primary",children:"Done"})})]}),t.jsxs(ce,{open:i,onClose:m,"aria-labelledby":"form-dialog-title",maxWidth:"lg",fullWidth:!0,scroll:"paper",classes:{paper:n.dialogPaper},children:[t.jsx(de,{id:"form-dialog-title",children:"FSH Examples"}),t.jsx(ie,{children:t.jsxs(X,{container:!0,style:{overflow:"scroll",minHeight:"64vh"},children:[t.jsx(X,{item:!0,xs:4,children:t.jsx(Wt,{className:n.treeView,defaultCollapseIcon:t.jsx(rt,{}),defaultExpandIcon:t.jsx(at,{}),onNodeSelect:ke,children:e.exampleConfig.map(h=>pe(h))})}),t.jsx(X,{item:!0,xs:8,children:t.jsx(Je,{name:R?B:"",isExamples:!0,value:R,initialText:R,updateTextValue:Fe,mode:"fsh",placeholder:te?"Fetching example...":"Select an example",isLineWrapped:e.isLineWrapped})})]})}),t.jsxs(ue,{className:n.dialogActions,children:[t.jsxs("div",{className:n.dialogActionsMessage,children:["Have an example that might be bene-fish-al? Seas the day and add to our collection on"," ",t.jsx(ot,{href:"https://github.com/FHIR/FSHOnline-Examples#readme",children:"GitHub"}),"!"]}),t.jsxs("div",{children:[t.jsxs(k,{onClick:Te,color:"primary",children:[t.jsx(Gt,{})," Copy to clipboard"]}),t.jsx(k,{onClick:m,color:"secondary",children:"Close"})]})]})]})]})}const Fn=ae(()=>({container:{height:"100%",flexGrow:1},fullHeightGrid:{height:"100%"},editorPane:{flexGrow:"0"},resize:{height:"100%",width:"4px",cursor:"col-resize","&:hover":{background:ze.palette.common.lightBlue}},resizeBlue:{background:"#487AA2"},resizeCursor:{cursor:"col-resize"},collapsedMain:{width:"100%",height:"calc(100vh - 116px - 300px)"},expandedMain:{width:"100%",height:"calc(100vh - 116px - 34px)"},collapsedConsole:{height:"25px",width:"100%"},expandedConsole:{height:"300px",width:"100%"},top:{height:"116px"}})),gt="https://raw.githubusercontent.com/FHIR/FSHOnline-Examples/main",_e="There are no messages to display in the console.",Xe="There are no problems to display in the console.";let xe=[_e],me=[Xe],Ve=0,Pe="#FDD835",ft={};console._stdout={};console.log=console._stdout.write=function(n){n&&(n.startsWith("error")||n.startsWith("warn"))&&(me[0]===Xe&&(me=[]),Ve++,me.push(n),n.startsWith("error")&&(Pe="#FD6668")),xe[0]===_e&&(xe=[]),xe.push(n)};function xt(e){e.forEach(n=>{n.type==="category"&&xt(n.children),n.id=n.path.replaceAll("%20","-"),n.type==="file"&&(ft[n.id]={path:`${gt}/Examples/${n.path}`,description:n.description,name:n.name}),delete n.type,delete n.path})}async function Tn(){let e=await fetch(`${gt}/index.json`).then(n=>n.json());return xt(e.children),[...e.children]}async function Nn(e){if(e==null||e=="")return"";if(e.length===7){const n=await fetch(`/shares/${e}`,{headers:{Accept:"application/text"}}).then(i=>i.ok?i.text():null).catch(()=>null);return n!=null?ye.inflateSync(et.from(n,"base64")).toString("utf-8"):""}else return ye.inflateSync(et.from(e,"base64")).toString("utf-8")}async function En(e){const n=await fetch(`https://api.github.com/gists/${e}`).then(o=>o.json());let i="";for(let o of Object.values(n?.files||{}))o.truncated?i+=await fetch(o.raw_url).then(s=>s.text()):i+=o.content,i+=`

`;return i.trim()}const mt=c.createContext(!1);function We(e){const n=Fn(),i=Bt(),[o,s]=c.useState(!1),[l,S]=c.useState(""),[a,r]=c.useState([""]),[d,u]=c.useState(""),[g,y]=c.useState(!1),[f,T]=c.useState(!1),[P,Y]=c.useState(!1),[U,ee]=c.useState([]),[q,te]=c.useState({}),[G,R]=c.useState(41.666667),[D,B]=c.useState(!1),[x,C]=c.useState({canonical:"",version:"",fhirVersion:[],dependencies:""}),[m,v]=c.useState({}),[I,N]=c.useState(!1),[z,K]=c.useState(!1),[J,be]=c.useState(!1);c.useEffect(()=>{async function p(){if(e.path==="share"){const E=await Nn(i["*"]),Q=E.indexOf(`
`),H=E.slice(0,Q);let _,ne=E;try{const $=JSON.parse(H);$.c!=null&&$.v!=null&&$.d!=null&&(_={canonical:$.c,version:$.v,fhirVersion:$.f||[],dependencies:$.d},ne=E.slice(Q+1))}catch{}v(_||{}),u(ne)}else if(e.path==="gist"){const E=await En(i.id);u(E)}}async function j(){ee(await Tn()),te(ft)}p(),j()},[i,e.path]);function we(){xe=[_e],me=[Xe],Ve=0,Pe="#FDD835"}function je(p,j,E){s(p),r(j),y(E)}function ve(p,j){T(j),u(p===""?null:p)}function Ie(p){(d===""||d===null)&&u(p),S(p)}function ke(p){r(p)}function Fe(p){C(p),!J&&p.canonical==="ahoy to fsh"&&(console.log("ðŸŸ ahoy to you too! thanks for using FSH ONLINE!"),be(!0))}function Te(){R(41.666667)}function Ne(p){p.preventDefault(),B(!0)}function pe(p){p.preventDefault(),B(!1)}function h(){B(!0)}function w(){B(!1)}function F(p){N(p)}function Z(p){K(p)}function A(p){if(D){const j=p/window.innerWidth*100;j>10&&j<76&&R(j)}}function O(p){const j=p.clientX;D&&b.debounce(()=>A(j),10)()}function Ee(p){const j=p.touches[0].clientX;D&&b.debounce(()=>A(j),10)()}function Se(p,j){if(j.get(p)){let E=j.get(p),Q=`${p}-${E}`;for(;j.get(Q);)E=E+1,Q=`${p}-${E}`;j.set(p,E+1),p=Q,j.set(Q,1)}else j.set(p,1);return p}function St(){const p=new Map,j=new Vt;j.file("FSH.fsh",l);const[E,Q]=b.partition(a,H=>H.id&&H.id!=="Untitled");E.forEach(H=>{let _;try{_=JSON.parse(H.def)}catch{}const ne=Se(_?.resourceType?`${_.resourceType}-${H.id}`:H.id,p),$=H.def??null;j.file(`${ne}.json`,$)}),Q.forEach(H=>{let _;try{_=JSON.parse(H.def)}catch{}const ne=H.id??"Untitled",$=Se(_.resourceType?`${_.resourceType}-${ne}`:ne,p),Ct=H.def??null;j.file(`${$}.json`,Ct)}),j.generateAsync({type:"blob"}).then(H=>{Ue.saveAs(H,"fshonline.zip")})}return t.jsx(At,{theme:ze,children:t.jsxs("div",{className:"root",style:{height:"100vh"},children:[t.jsxs("div",{className:n.top,children:[t.jsx(qt,{sayAhoy:J}),t.jsx(kn,{onSUSHIClick:je,onGoFSHClick:ve,onConfigChange:Fe,config:m,fshText:l,gofshText:a,resetLogMessages:we,exampleConfig:U,exampleMetadata:q,isWaiting:f||g,saveAll:St,setIsLineWrapped:F,isLineWrapped:I,setIsDebugConsoleChecked:Z,isDebugConsoleChecked:z})]}),t.jsx("div",{className:P?n.collapsedMain:n.expandedMain,children:t.jsx(mt.Provider,{value:P,children:t.jsxs(X,{className:M(n.container,D&&n.resizeCursor),container:!0,onTouchMove:Ee,onMouseMove:O,onMouseUp:pe,onMouseLeave:pe,children:[t.jsx(X,{item:!0,className:M(n.fullHeightGrid,n.editorPane),style:{maxWidth:`calc(${G}% - 2px)`,flexBasis:`calc(${G}% - 2px)`},children:t.jsx(nn,{text:l,initialText:d,updateTextValue:Ie,isWaiting:f,setInitialText:u,config:x,isLineWrapped:I})}),t.jsx(X,{item:!0,className:M(n.resize,D&&n.resizeBlue),onTouchStart:h,onTouchEnd:w,onMouseDown:Ne,onDoubleClick:Te}),t.jsx(X,{item:!0,className:M(n.fullHeightGrid,n.editorPane),style:{maxWidth:`calc(${100-G}% - 2px)`,flexBasis:`calc(${100-G}% - 2px)`},children:t.jsx(tn,{text:a,showNewText:o,setShowNewText:s,isWaiting:g,updateTextValue:ke,isLineWrapped:I})})]})})}),t.jsx("div",{className:P?n.expandedConsole:n.collapsedConsole,children:t.jsx(on,{consoleMessages:xe,problemMessages:me,problemCount:Ve,problemColor:Pe,expandConsole:P,setExpandConsole:Y})})]})})}function Hn(){return t.jsxs(Pt,{children:[t.jsx(Me,{path:"/share/*",element:t.jsx(We,{path:"share"})}),t.jsx(Me,{path:"/gist/:id",element:t.jsx(We,{path:"gist"})}),t.jsx(Me,{path:"/*",element:t.jsx(We,{})})]})}Ut.render(t.jsx(zt.StrictMode,{children:t.jsx(Jt,{basename:"/",children:t.jsx(Hn,{})})}),document.getElementById("root"));

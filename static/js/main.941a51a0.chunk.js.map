{"version":3,"sources":["App.js","../node_modules/gofsh/dist/optimizer sync /^.*$","utils/AppRouter.js","serviceWorker.js","index.js","components/ShareLink.js","components/CodeMirrorComponent.js","utils/BitlyWorker.js","components/DeleteConfirmationModal.js","components/JSONOutput.js","components/FSHOutput.js","components/ConsoleComponent.js","utils/Load.js","utils/Processing.js","utils/helpers.js","utils/FSHHelpers.js","components/FSHControls.js","style/FSH-online-logo.png","components/TopBar.js"],"names":["useStyles","makeStyles","theme","container","height","flexGrow","fullHeightGrid","editorPane","resize","width","cursor","background","colors","lightBlue","resizeBlue","resizeCursor","collapsedMain","expandedMain","collapsedConsole","expandedConsole","top","lighterBlue","blue","darkerBlue","editorGrey","lightestGrey","lightGrey","grey","darkerGrey","darkestGrey","red","createMuiTheme","palette","success","main","dark","light","common","typography","fontFamily","overrides","MuiTooltip","tooltip","backgroundColor","fontSize","arrow","color","MuiButton","text","textTransform","fontWeight","MuiIconButton","root","githubURL","defaultInfoMessage","console","log","defaultProblemMessage","infoMessages","problemMessages","problemCount","problemColor","exampleMetadata","convertManifest","childrenArr","forEach","element","type","children","id","path","replaceAll","description","name","getManifestFromGit","a","fetch","then","response","json","manifestJSON","decodeFSH","encodedFSH","undefined","expandLink","promisedURL","sliced64","long_url","slice","includes","length","displayText","inflateSync","Buffer","from","toString","getGistContent","gistId","res","gistContent","fshContent","Object","values","files","f","truncated","raw_url","content","trim","message","startsWith","push","ExpandedConsoleContext","createContext","App","props","classes","urlParam","match","useState","showNewFHIRText","setShowNewFHIRText","inputFSHText","setInputFSHText","inputFHIRText","setInputFHIRText","initialText","setInitialText","isWaitingForFHIROutput","setIsWaitingForFHIROutput","isWaitingForFSHOutput","setIsWaitingForFSHOutput","expandConsole","setExpandConsole","exampleConfig","setExampleConfig","exampleFilePaths","setExampleFilePaths","leftWidth","setLeftWidth","isDragging","setIsDragging","canonical","version","fhirVersion","dependencies","configToShare","setConfigToShare","sharedConfig","setSharedConfig","onMouseUp","e","preventDefault","debouncedMove","clientX","newPercentage","window","innerWidth","getFileName","nameMap","get","count","nameWithCount","set","useEffect","test","params","splitIndex","indexOf","config","rawConfig","JSON","parse","c","v","d","parsedConfig","waitForFSH","fetchExamples","className","style","onSUSHIClick","showNewText","sushiOutput","isWaiting","onGoFSHClick","fshOutput","onConfigChange","fshText","gofshText","resetLogMessages","saveAll","Map","zip","JSZip","file","partition","def","defWithId","defWithUntitledId","resourceObj","resourceType","value","generateAsync","blob","FileSaver","saveAs","Provider","clsx","onTouchMove","touches","debounce","onMouseMove","onMouseLeave","item","maxWidth","flexBasis","updateTextValue","onTouchStart","onTouchEnd","onMouseDown","onDoubleClick","setShowNewText","consoleMessages","map","webpackContext","req","webpackContextResolve","__webpack_require__","o","Error","code","keys","resolve","module","exports","AppRouter","component","exact","Boolean","location","hostname","ReactDOM","render","StrictMode","basename","document","getElementById","navigator","serviceWorker","ready","registration","unregister","catch","error","iconButton","white","padding","textArea","primary","copyBox","borderRadius","display","justifyContent","alignItems","paddingLeft","textOverflow","ShareLink","openShare","setOpenShare","shareError","setShareError","openGist","setOpenGist","openGistError","setOpenGistError","copyTip","setCopyTip","fshCopied","fshCopyButton","setFshCopied","link","setLink","gistLink","setGistLink","showCreateGistButton","setshowCreateGistButton","handleOpenGist","handleCloseGist","handleCloseGistError","handleOpenShare","encoded","deflateSync","stringify","shareText","longLink","generateLink","bitlyLink","errorNeeded","bitlySlice","displayLink","handleCloseShare","Tooltip","title","placement","IconButton","onClick","Link","transform","Dialog","open","onClose","fullWidth","DialogTitle","DialogContent","DialogContentText","Box","overflow","onCopy","FileCopy","DialogActions","Button","align","flex","hidden","href","target","TextField","label","onChange","event","bottom","right","autoFocus","require","CodeMirror","defineSimpleMode","meta","lineComment","start","regex","token","sol","next","closingParen","pop","comment","drawerWidth","box","header","transition","transitions","create","easing","sharp","duration","leavingScreen","headerShift","easeOut","enteringScreen","marginRight","headerLabel","lineHeight","float","whiteSpace","headerActionGroup","paddingRight","headerActions","drawer","flexShrink","drawerPaper","border","drawerPaperExpandedConsole","drawerHeader","minHeight","drawerHeaderIcon","minWidth","contentShift","CodeMirrorComponent","expandedConsoleContext","useContext","drawerOpen","setDrawerOpen","handleDrawerOpen","handleDrawerClose","renderActionIcon","Icon","upperFirst","renderDrawer","mode","isExamples","copy","save","SaveAlt","delete","Delete","ChevronLeft","options","placeholder","scrollbarStyle","autoCloseBrackets","lineNumbers","foldGutter","readOnly","gutters","extraKeys","Tab","cm","replaceSelection","foldCode","getCursor","editor","data","Drawer","variant","anchor","paper","ChevronRight","bitly","BitlyClient","process","Promise","shorten","result","encodedFsh","bitlyURL","expand","DeleteConfirmationModal","isOpen","handleCloseModal","handleDelete","fileTreeContent","overflowY","button","list","paddingBottom","listItemError","paddingTop","margin","listItem","marginTop","marginBottom","listItemSelected","listHeader","listIcon","verticalAlign","listIconError","blankIcon","checkFshType","derivation","kind","JSONOutput","fhirDefinitions","setFhirDefinitions","propsUpdateText","currentDef","setCurrentDef","defsWithErrors","setDefsWithErrors","openDeleteConfirmation","setOpenDeleteConfirmation","isEqual","packageJSON","profiles","extensions","logicals","resources","instances","valueSets","codeSystems","iterablePackage","defsPackage","addDefinition","updatedDefs","handleCloseAndDelete","index","splice","newCurrentDef","newCurrentDefText","newErrors","shiftedErrors","i","handleCloseDeleteConfirmation","displayValue","latestJSON","startIcon","order","grouped","groupBy","val","sort","b","key","aId","bId","toLowerCase","currentIndex","isError","renderFileTreeView","defaultName","Blob","handleSave","defToDelete","renderDeleteModal","FSHOutput","openDeleteModal","setOpenDeleteModal","handleOpenDeleteModal","consoleControls","boxSizing","problemsButton","expandIcon","pre","circle","marginLeft","Console","problemsView","setProblemsView","borderBottom","borderColor","logger","utils","unzipDependencies","dependency","returnPackage","resourceArr","emptyDependencies","https","extract","tarStream","on","stream","buf","chunk","resource","resume","statusCode","pipe","zlib","createGunzip","info","loadDependenciesInStorage","database","reject","transaction","oncomplete","onerror","objectStore","keyPath","put","loadAsFHIRDefs","FHIRdefs","displayLoaded","getData","openCursor","onsuccess","iterator","add","continue","FHIRDefinitions","fhirdefs","FSHTank","sushiImport","importText","fillTank","rawFSHes","docs","loadAndCleanDatabase","defs","checkForDatabaseUpgrade","helperUpdate","loadExternalDependenciesReturn","shouldUpdate","loadExternalDependencies","cleanDatabase","databaseName","mergedEmpties","flatten","OpenIDBRequest","indexedDB","close","onupgradeneeded","existingObjectStores","objectStoreNames","getAll","contains","deleteObjectStore","dependencyArr","helperReturn","shouldUnzip","newDependencies","unzipReturn","createObjectStore","sliceDependency","returnArr","arr","split","singleDep","RawFSH","exportFHIR","sushiExport","stats","getRandomPun","Type","runGoFSH","input","reset","gofshUtils","isProcessableContent","processor","WildFHIR","lake","LakeOfFHIR","fisher","MasterFisher","fhirProcessor","FHIRProcessor","goFSHDependencies","replace","configuration","processConfig","dep","packageId","coreFhirVersion","fhirVersionForDep","getCoreFHIRPackageIdentifier","some","join","getResources","indent","pkg","fsh","gofshExport","FSHExporter","apiExport","printGoFSHresults","runSUSHI","coreFHIRVersion","findIndex","tank","rawFSH","structDef","fishForFHIR","Resource","outPackage","filter","_instanceMeta","usage","printSUSHIResults","p","toJSON","l","r","numError","numWarn","profileNum","pad","extentNum","logiclNum","resourcNum","valueSetsNumber","codeSystemsNum","instancesNumber","errorNumMsg","wrNumMsg","padStart","aWittyMessageInvolvingABadFishPun","padEnd","proNum","extNum","logNum","resNum","vsNum","csNum","instNum","invNum","invariants","mapNum","mappings","errNumMsg","wrnNumMsg","results","spacing","rightControls","position","leftControls","left","secondaryButton","progressContainer","progress","buttonLeft","buttonRight","runIcon","dialogPaper","maxHeight","replacer","FSHControls","openExamples","setOpenExamples","openConfig","setOpenConfig","setCanonical","setVersion","setFhirVersion","setDependencies","isGoFSHIndented","setIsGoFSHIndented","isSUSHIRunning","setIsSUSHIRunning","isGoFSHRunning","setIsGoFSHRunning","isFetchingExample","setIsFetchingExample","currentExample","setCurrentExample","currentExampleName","setCurrentExampleName","at","handleCloseExamples","handleCloseConfig","FSHOnly","jsonOutput","gofshInputStrings","parsedDependencies","igResource","url","endsWith","utf8Decoder","TextDecoder","body","getReader","responseReader","fshString","read","decode","renderTree","nodes","TreeItem","nodeId","node","treeItem","renderItem","Grid","xs","testid","CircularProgress","PlayArrow","LibraryBooks","Settings","helperText","defaultValue","newCanonical","newVersion","select","newFhirVersion","MenuItem","dependencyString","FormControlLabel","control","Checkbox","checked","isIndented","FormHelperText","scroll","TreeView","treeView","defaultCollapseIcon","ExpandMore","defaultExpandIcon","onNodeSelect","category","clipboard","writeText","AssignmentOutlined","boxShadow","logo","toolbarBox","exitIcon","docButton","versionText","fontStyle","TopBar","AppBar","Toolbar","flexDirection","alignSelf","src","alt","m","StylesProvider","injectFirst","Typography","ExitToApp"],"mappings":"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","file":"static/js/main.941a51a0.chunk.js","sourcesContent":["import React, { createContext, useState, useEffect } from 'react';\nimport { inflateSync } from 'browserify-zlib';\nimport FileSaver from 'file-saver';\nimport JSZip from 'jszip';\nimport { debounce, partition } from 'lodash';\nimport clsx from 'clsx';\nimport { createMuiTheme, makeStyles } from '@material-ui/core/styles';\nimport { Grid, ThemeProvider } from '@material-ui/core';\nimport { expandLink } from './utils/BitlyWorker';\nimport TopBar from './components/TopBar';\nimport JSONOutput from './components/JSONOutput';\nimport FSHOutput from './components/FSHOutput';\nimport ConsoleComponent from './components/ConsoleComponent';\nimport FSHControls from './components/FSHControls';\n\nconst useStyles = makeStyles((theme) => ({\n  container: {\n    height: '100%',\n    flexGrow: 1\n  },\n  fullHeightGrid: {\n    height: '100%'\n  },\n  editorPane: {\n    // From MaterialUI Grid:\n    flexGrow: '0'\n    // maxWidth and flexBasis set inline based on state\n  },\n  resize: {\n    height: '100%',\n    width: '4px',\n    cursor: 'col-resize',\n    '&:hover': {\n      background: colors.lightBlue\n    }\n  },\n  resizeBlue: {\n    background: '#487AA2'\n  },\n  resizeCursor: {\n    cursor: 'col-resize'\n  },\n  collapsedMain: {\n    width: '100%',\n    height: 'calc(100vh - 116px - 300px)'\n  },\n  expandedMain: {\n    width: '100%',\n    height: 'calc(100vh - 116px - 34px)'\n  },\n  collapsedConsole: {\n    height: '25px',\n    width: '100%'\n  },\n  expandedConsole: {\n    height: '300px',\n    width: '100%'\n  },\n  top: {\n    height: '116px'\n  }\n}));\n\nconst colors = {\n  lighterBlue: '#D8E2EA',\n  lightBlue: '#487AA2',\n  blue: '#30638e',\n  darkerBlue: '#143E61',\n  editorGrey: '#263238',\n  lightestGrey: '#E7ECEE',\n  lightGrey: '#D0D9DD',\n  grey: '#575B5C',\n  darkerGrey: '#3D4345',\n  darkestGrey: '#121D21',\n  red: '#FD6668'\n};\n\nexport const theme = createMuiTheme({\n  palette: {\n    success: {\n      main: colors.blue,\n      dark: colors.darkerBlue,\n      light: colors.lightBlue\n    },\n    common: colors\n  },\n  typography: {\n    fontFamily: 'Open Sans'\n  },\n  overrides: {\n    MuiTooltip: {\n      tooltip: {\n        backgroundColor: colors.darkestGrey,\n        fontSize: '13px'\n      },\n      arrow: {\n        color: colors.darkestGrey\n      }\n    },\n    MuiButton: {\n      text: {\n        textTransform: 'none',\n        fontWeight: 600\n      }\n    },\n    MuiIconButton: {\n      root: {\n        '&:hover': {\n          backgroundColor: colors.grey\n        }\n      }\n    }\n  }\n});\n\nconst githubURL = 'https://raw.githubusercontent.com/FSHSchool/FSHOnline-Examples/main/';\nconst log = console.log; //eslint-disable-line no-unused-vars\nconst defaultInfoMessage = 'There are no messages to display in the console.';\nconst defaultProblemMessage = 'There are no problems to display in the console.';\nlet infoMessages = [defaultInfoMessage];\nlet problemMessages = [defaultProblemMessage];\nlet problemCount = 0;\nlet problemColor = '#FDD835'; // Default yellow color for warnings\nlet exampleMetadata = {};\nconsole.log = function getMessages(message) {\n  if (message && (message.startsWith('error') || message.startsWith('warn'))) {\n    if (problemMessages[0] === defaultProblemMessage) {\n      problemMessages = [];\n    }\n    problemCount++;\n    problemMessages.push(message);\n    if (message.startsWith('error')) {\n      problemColor = '#FD6668';\n    }\n  }\n  if (infoMessages[0] === defaultInfoMessage) {\n    infoMessages = [];\n  }\n  infoMessages.push(message);\n};\n\n/* \nParses metadata into a seperate object and converts the manifest into a form that can\nbe consumed by the TreeView component\n*/\nfunction convertManifest(childrenArr) {\n  childrenArr.forEach((element) => {\n    if (element.type === 'category') {\n      convertManifest(element.children);\n    }\n    element.id = element.path.replaceAll('%20', '-'); // Spaces in file names are replaced with '%20' in Github urls\n    if (element.type === 'file') {\n      exampleMetadata[element.id] = {\n        path: `${githubURL}/Examples/${element.path}`,\n        description: element.description,\n        name: element.name\n      };\n    }\n    delete element.type;\n    delete element.path;\n  });\n}\n\nasync function getManifestFromGit() {\n  let manifestJSON = await fetch(`${githubURL}/index.json`).then((response) => response.json());\n  convertManifest(manifestJSON.children);\n  return [...manifestJSON.children];\n}\n\nexport async function decodeFSH(encodedFSH) {\n  if (encodedFSH.text === undefined) {\n    return '';\n  } else {\n    const promisedURL = await expandLink(encodedFSH);\n\n    // Removes the encoded data from the end of the url, starting at index 38\n    const sliced64 = promisedURL.long_url.slice(40);\n    if (!promisedURL.long_url.includes('https://fshschool.org/FSHOnline/#/share/') || sliced64.length === 0) {\n      return '';\n    } else {\n      const displayText = inflateSync(Buffer.from(sliced64, 'base64')).toString('utf-8');\n      return displayText;\n    }\n  }\n}\n\nasync function getGistContent(gistId) {\n  const gistContent = await fetch(`https://api.github.com/gists/${gistId}`).then((res) => res.json());\n  let fshContent = '';\n  for (let f of Object.values(gistContent?.files || {})) {\n    if (f.truncated) {\n      fshContent += await fetch(f.raw_url).then((res) => res.text());\n    } else {\n      fshContent += f.content;\n    }\n    fshContent += '\\n\\n';\n  }\n  return fshContent.trim();\n}\n\nexport const ExpandedConsoleContext = createContext(false);\n\nexport default function App(props) {\n  const classes = useStyles();\n  const urlParam = props.match;\n  const [showNewFHIRText, setShowNewFHIRText] = useState(false);\n  const [inputFSHText, setInputFSHText] = useState('');\n  const [inputFHIRText, setInputFHIRText] = useState(['']);\n  const [initialText, setInitialText] = useState('');\n  const [isWaitingForFHIROutput, setIsWaitingForFHIROutput] = useState(false);\n  const [isWaitingForFSHOutput, setIsWaitingForFSHOutput] = useState(false);\n  const [expandConsole, setExpandConsole] = useState(false);\n  const [exampleConfig, setExampleConfig] = useState([]);\n  const [exampleFilePaths, setExampleFilePaths] = useState({});\n  const [leftWidth, setLeftWidth] = useState(41.666667); // Initial width based off grid item xs={5} size to align with FSHControls\n  const [isDragging, setIsDragging] = useState(false);\n  const [configToShare, setConfigToShare] = useState({ canonical: '', version: '', fhirVersion: [], dependencies: '' });\n  const [sharedConfig, setSharedConfig] = useState({});\n\n  useEffect(() => {\n    async function waitForFSH() {\n      if (/\\/share/.test(urlParam.path)) {\n        const text = await decodeFSH(urlParam.params);\n        const splitIndex = text.indexOf('\\n');\n        const config = text.slice(0, splitIndex);\n        let parsedConfig;\n        let fshContent = text;\n        try {\n          const rawConfig = JSON.parse(config);\n          if (rawConfig.c != null && rawConfig.v != null && rawConfig.d != null) {\n            parsedConfig = {\n              canonical: rawConfig.c,\n              version: rawConfig.v,\n              fhirVersion: rawConfig.f || [], // Need to support old share links that did not have fhirVersion\n              dependencies: rawConfig.d\n            };\n            // If the config is successfully parsed and has the expected properties,\n            // we can assume the true FSH content begins on the next line\n            fshContent = text.slice(splitIndex + 1);\n          }\n        } catch (e) {\n          // If parse fails, it is likely decoding a legacy link in which all content is FSH, so just don't\n          // set the parsedConfig, and set fshContent to all of the text\n        }\n        setSharedConfig(parsedConfig || {});\n        setInitialText(fshContent);\n      } else if (/\\/gist/.test(urlParam.path)) {\n        const fshContent = await getGistContent(urlParam.params.id);\n        setInitialText(fshContent);\n      }\n    }\n    async function fetchExamples() {\n      setExampleConfig(await getManifestFromGit());\n      setExampleFilePaths(exampleMetadata);\n    }\n    waitForFSH();\n    fetchExamples();\n  }, [urlParam]);\n\n  function resetLogMessages() {\n    infoMessages = [defaultInfoMessage];\n    problemMessages = [defaultProblemMessage];\n    problemCount = 0;\n    problemColor = '#FDD835';\n  }\n\n  function handleSUSHIControls(showNewText, sushiOutput, isWaiting) {\n    setShowNewFHIRText(showNewText);\n    setInputFHIRText(sushiOutput); // JSONOutput component handles resetting initial text, so don't reset here\n    setIsWaitingForFHIROutput(isWaiting);\n  }\n\n  function handleGoFSHControls(fshOutput, isWaiting) {\n    setIsWaitingForFSHOutput(isWaiting);\n    setInitialText(fshOutput === '' ? null : fshOutput); // Reset initial text to null if empty in order to display placeholder text\n  }\n\n  function updateInputFSHTextValue(text) {\n    // This is a bit of a hack to make sure the editor can be reset by a setInitialText(null)\n    if (initialText === '' || initialText === null) {\n      setInitialText(text);\n    }\n    setInputFSHText(text);\n  }\n\n  function updateInputFHIRTextValue(text) {\n    setInputFHIRText(text);\n  }\n\n  function handleConfigChange(config) {\n    setConfigToShare(config);\n  }\n\n  function handleResetWidth() {\n    setLeftWidth(41.666667);\n  }\n\n  function onMouseDown(e) {\n    e.preventDefault();\n    setIsDragging(true);\n  }\n\n  function onMouseUp(e) {\n    e.preventDefault();\n    setIsDragging(false);\n  }\n\n  function onTouchStart() {\n    setIsDragging(true);\n  }\n\n  function onTouchEnd() {\n    setIsDragging(false);\n  }\n\n  function debouncedMove(clientX) {\n    if (isDragging) {\n      const newPercentage = (clientX / window.innerWidth) * 100;\n      if (newPercentage > 10 && newPercentage < 76) {\n        setLeftWidth(newPercentage);\n      }\n    }\n  }\n\n  function onMouseMove(e) {\n    const clientX = e.clientX;\n    if (isDragging) {\n      debounce(() => debouncedMove(clientX), 10)();\n    }\n  }\n\n  function onTouchMove(e) {\n    const clientX = e.touches[0].clientX;\n    if (isDragging) {\n      debounce(() => debouncedMove(clientX), 10)();\n    }\n  }\n\n  function getFileName(name, nameMap) {\n    if (nameMap.get(name)) {\n      let count = nameMap.get(name);\n      let nameWithCount = `${name}-${count}`;\n      while (nameMap.get(nameWithCount)) {\n        count = count + 1;\n        nameWithCount = `${name}-${count}`;\n      }\n      nameMap.set(name, count + 1); // Keep track of how many times the name has been used in this zip file\n      name = nameWithCount; // Append a number if the file name has been used already\n      nameMap.set(nameWithCount, 1); // Keep track of the new file name we created so we don't use it again\n    } else {\n      nameMap.set(name, 1);\n    }\n    return name;\n  }\n\n  function saveAll() {\n    const nameMap = new Map();\n\n    // Build zip file\n    const zip = new JSZip();\n    zip.file('FSH.fsh', inputFSHText);\n\n    // Prioritize FHIR definitions that have a provided id when naming files\n    const [defWithId, defWithUntitledId] = partition(inputFHIRText, (def) => def.id && def.id !== 'Untitled');\n    defWithId.forEach((def) => {\n      let resourceObj;\n      try {\n        resourceObj = JSON.parse(def.def);\n      } catch {\n        /* Ignore errors and just default to name without resourceType */\n      }\n      const name = getFileName(resourceObj?.resourceType ? `${resourceObj.resourceType}-${def.id}` : def.id, nameMap);\n      const value = def.def ?? null;\n      zip.file(`${name}.json`, value);\n    });\n    defWithUntitledId.forEach((def) => {\n      let resourceObj;\n      try {\n        resourceObj = JSON.parse(def.def);\n      } catch {\n        /* Ignore errors and just default to name without resourceType */\n      }\n      const id = def.id ?? 'Untitled';\n      const name = getFileName(resourceObj.resourceType ? `${resourceObj.resourceType}-${id}` : id, nameMap);\n      const value = def.def ?? null;\n      zip.file(`${name}.json`, value);\n    });\n\n    // Generate blob of zip and save\n    zip.generateAsync({ type: 'blob' }).then((blob) => {\n      FileSaver.saveAs(blob, 'fshonline.zip');\n    });\n  }\n\n  return (\n    <ThemeProvider theme={theme}>\n      <div className=\"root\" style={{ height: '100vh' }}>\n        <div className={classes.top}>\n          <TopBar />\n          <FSHControls\n            onSUSHIClick={handleSUSHIControls}\n            onGoFSHClick={handleGoFSHControls}\n            onConfigChange={handleConfigChange}\n            config={sharedConfig}\n            fshText={inputFSHText}\n            gofshText={inputFHIRText}\n            resetLogMessages={resetLogMessages}\n            exampleConfig={exampleConfig}\n            exampleMetadata={exampleFilePaths}\n            isWaiting={isWaitingForFSHOutput || isWaitingForFHIROutput}\n            saveAll={saveAll}\n          />\n        </div>\n        <div className={expandConsole ? classes.collapsedMain : classes.expandedMain}>\n          <ExpandedConsoleContext.Provider value={expandConsole}>\n            <Grid\n              className={clsx(classes.container, isDragging && classes.resizeCursor)}\n              container\n              onTouchMove={onTouchMove}\n              onMouseMove={onMouseMove}\n              onMouseUp={onMouseUp}\n              onMouseLeave={onMouseUp}\n            >\n              <Grid\n                item\n                className={clsx(classes.fullHeightGrid, classes.editorPane)}\n                style={{ maxWidth: `calc(${leftWidth}% - 2px)`, flexBasis: `calc(${leftWidth}% - 2px)` }}\n              >\n                <FSHOutput\n                  text={inputFSHText}\n                  initialText={initialText}\n                  updateTextValue={updateInputFSHTextValue}\n                  isWaiting={isWaitingForFSHOutput}\n                  setInitialText={setInitialText}\n                  config={configToShare}\n                />\n              </Grid>\n              <Grid\n                item\n                className={clsx(classes.resize, isDragging && classes.resizeBlue)}\n                onTouchStart={onTouchStart}\n                onTouchEnd={onTouchEnd}\n                onMouseDown={onMouseDown}\n                onDoubleClick={handleResetWidth}\n              />\n              <Grid\n                item\n                className={clsx(classes.fullHeightGrid, classes.editorPane)}\n                style={{\n                  maxWidth: `calc(${100 - leftWidth}% - 2px)`,\n                  flexBasis: `calc(${100 - leftWidth}% - 2px)`\n                }}\n              >\n                <JSONOutput\n                  text={inputFHIRText}\n                  showNewText={showNewFHIRText}\n                  setShowNewText={setShowNewFHIRText}\n                  isWaiting={isWaitingForFHIROutput}\n                  updateTextValue={updateInputFHIRTextValue}\n                />\n              </Grid>\n            </Grid>\n          </ExpandedConsoleContext.Provider>\n        </div>\n        <div className={expandConsole ? classes.expandedConsole : classes.collapsedConsole}>\n          <ConsoleComponent\n            consoleMessages={infoMessages}\n            problemMessages={problemMessages}\n            problemCount={problemCount}\n            problemColor={problemColor}\n            expandConsole={expandConsole}\n            setExpandConsole={setExpandConsole}\n          />\n        </div>\n      </div>\n    </ThemeProvider>\n  );\n}\n","var map = {\n\t\".\": 190,\n\t\"./\": 190,\n\t\"./OptimizerPlugin\": 366,\n\t\"./OptimizerPlugin.d.ts\": 1366,\n\t\"./OptimizerPlugin.js\": 366,\n\t\"./index\": 190,\n\t\"./index.d.ts\": 1367,\n\t\"./index.js\": 190,\n\t\"./loadOptimizers\": 365,\n\t\"./loadOptimizers.d.ts\": 1368,\n\t\"./loadOptimizers.js\": 365,\n\t\"./plugins\": 255,\n\t\"./plugins/\": 255,\n\t\"./plugins/AddPathRulesOptimizer\": 367,\n\t\"./plugins/AddPathRulesOptimizer.d.ts\": 1369,\n\t\"./plugins/AddPathRulesOptimizer.js\": 367,\n\t\"./plugins/AddReferenceKeywordOptimizer\": 193,\n\t\"./plugins/AddReferenceKeywordOptimizer.d.ts\": 1370,\n\t\"./plugins/AddReferenceKeywordOptimizer.js\": 193,\n\t\"./plugins/CombineCardAndFlagRulesOptimizer\": 368,\n\t\"./plugins/CombineCardAndFlagRulesOptimizer.d.ts\": 1371,\n\t\"./plugins/CombineCardAndFlagRulesOptimizer.js\": 368,\n\t\"./plugins/CombineCodingAndQuantityValuesOptimizer\": 260,\n\t\"./plugins/CombineCodingAndQuantityValuesOptimizer.d.ts\": 1372,\n\t\"./plugins/CombineCodingAndQuantityValuesOptimizer.js\": 260,\n\t\"./plugins/CombineContainsRulesOptimizer\": 369,\n\t\"./plugins/CombineContainsRulesOptimizer.d.ts\": 1373,\n\t\"./plugins/CombineContainsRulesOptimizer.js\": 369,\n\t\"./plugins/ConstructInlineInstanceOptimizer\": 256,\n\t\"./plugins/ConstructInlineInstanceOptimizer.d.ts\": 1374,\n\t\"./plugins/ConstructInlineInstanceOptimizer.js\": 256,\n\t\"./plugins/ConstructNamedExtensionContainsRulesOptimizer\": 261,\n\t\"./plugins/ConstructNamedExtensionContainsRulesOptimizer.d.ts\": 1375,\n\t\"./plugins/ConstructNamedExtensionContainsRulesOptimizer.js\": 261,\n\t\"./plugins/RemoveChoiceSlicingRulesOptimizer\": 370,\n\t\"./plugins/RemoveChoiceSlicingRulesOptimizer.d.ts\": 1376,\n\t\"./plugins/RemoveChoiceSlicingRulesOptimizer.js\": 370,\n\t\"./plugins/RemoveDefaultExtensionContextRulesOptimizer\": 371,\n\t\"./plugins/RemoveDefaultExtensionContextRulesOptimizer.d.ts\": 1377,\n\t\"./plugins/RemoveDefaultExtensionContextRulesOptimizer.js\": 371,\n\t\"./plugins/RemoveDefaultLogicalCaretRulesOptimizer\": 372,\n\t\"./plugins/RemoveDefaultLogicalCaretRulesOptimizer.d.ts\": 1378,\n\t\"./plugins/RemoveDefaultLogicalCaretRulesOptimizer.js\": 372,\n\t\"./plugins/RemoveDefaultResourceCaretRulesOptimizer\": 373,\n\t\"./plugins/RemoveDefaultResourceCaretRulesOptimizer.d.ts\": 1379,\n\t\"./plugins/RemoveDefaultResourceCaretRulesOptimizer.js\": 373,\n\t\"./plugins/RemoveExtensionSlicingRulesOptimizer\": 374,\n\t\"./plugins/RemoveExtensionSlicingRulesOptimizer.d.ts\": 1380,\n\t\"./plugins/RemoveExtensionSlicingRulesOptimizer.js\": 374,\n\t\"./plugins/RemoveExtensionURLAssignmentRules\": 375,\n\t\"./plugins/RemoveExtensionURLAssignmentRules.d.ts\": 1381,\n\t\"./plugins/RemoveExtensionURLAssignmentRules.js\": 375,\n\t\"./plugins/RemoveGeneratedTextRulesOptimizer\": 191,\n\t\"./plugins/RemoveGeneratedTextRulesOptimizer.d.ts\": 1382,\n\t\"./plugins/RemoveGeneratedTextRulesOptimizer.js\": 191,\n\t\"./plugins/RemoveImpliedZeroZeroCardRulesOptimizer\": 259,\n\t\"./plugins/RemoveImpliedZeroZeroCardRulesOptimizer.d.ts\": 1383,\n\t\"./plugins/RemoveImpliedZeroZeroCardRulesOptimizer.js\": 259,\n\t\"./plugins/RemovePublisherDerivedDateRulesOptimizer\": 376,\n\t\"./plugins/RemovePublisherDerivedDateRulesOptimizer.d.ts\": 1384,\n\t\"./plugins/RemovePublisherDerivedDateRulesOptimizer.js\": 376,\n\t\"./plugins/ResolveBindingRuleURLsOptimizer\": 377,\n\t\"./plugins/ResolveBindingRuleURLsOptimizer.d.ts\": 1385,\n\t\"./plugins/ResolveBindingRuleURLsOptimizer.js\": 377,\n\t\"./plugins/ResolveInstanceOfURLsOptimizer\": 192,\n\t\"./plugins/ResolveInstanceOfURLsOptimizer.d.ts\": 1386,\n\t\"./plugins/ResolveInstanceOfURLsOptimizer.js\": 192,\n\t\"./plugins/ResolveOnlyRuleURLsOptimizer\": 262,\n\t\"./plugins/ResolveOnlyRuleURLsOptimizer.d.ts\": 1387,\n\t\"./plugins/ResolveOnlyRuleURLsOptimizer.js\": 262,\n\t\"./plugins/ResolveParentURLsOptimizer\": 378,\n\t\"./plugins/ResolveParentURLsOptimizer.d.ts\": 1388,\n\t\"./plugins/ResolveParentURLsOptimizer.js\": 378,\n\t\"./plugins/ResolveReferenceAssignmentsOptimizer\": 379,\n\t\"./plugins/ResolveReferenceAssignmentsOptimizer.d.ts\": 1389,\n\t\"./plugins/ResolveReferenceAssignmentsOptimizer.js\": 379,\n\t\"./plugins/ResolveValueRuleURLsOptimizer\": 380,\n\t\"./plugins/ResolveValueRuleURLsOptimizer.d.ts\": 1390,\n\t\"./plugins/ResolveValueRuleURLsOptimizer.js\": 380,\n\t\"./plugins/ResolveValueSetComponentRuleURLsOptimizer\": 381,\n\t\"./plugins/ResolveValueSetComponentRuleURLsOptimizer.d.ts\": 1391,\n\t\"./plugins/ResolveValueSetComponentRuleURLsOptimizer.js\": 381,\n\t\"./plugins/SimplifyArrayIndexingOptimizer\": 195,\n\t\"./plugins/SimplifyArrayIndexingOptimizer.d.ts\": 1392,\n\t\"./plugins/SimplifyArrayIndexingOptimizer.js\": 195,\n\t\"./plugins/SimplifyInstanceNameOptimizer\": 194,\n\t\"./plugins/SimplifyInstanceNameOptimizer.d.ts\": 1393,\n\t\"./plugins/SimplifyInstanceNameOptimizer.js\": 194,\n\t\"./plugins/SimplifyMappingNamesOptimizer\": 382,\n\t\"./plugins/SimplifyMappingNamesOptimizer.d.ts\": 1394,\n\t\"./plugins/SimplifyMappingNamesOptimizer.js\": 382,\n\t\"./plugins/SimplifyObeysRuleDotPathsOptimizer\": 258,\n\t\"./plugins/SimplifyObeysRuleDotPathsOptimizer.d.ts\": 1395,\n\t\"./plugins/SimplifyObeysRuleDotPathsOptimizer.js\": 258,\n\t\"./plugins/SimplifyRulePathContextsOptimizer\": 257,\n\t\"./plugins/SimplifyRulePathContextsOptimizer.d.ts\": 1396,\n\t\"./plugins/SimplifyRulePathContextsOptimizer.js\": 257,\n\t\"./plugins/index\": 255,\n\t\"./plugins/index.d.ts\": 1397,\n\t\"./plugins/index.js\": 255,\n\t\"./utils\": 114,\n\t\"./utils.d.ts\": 1398,\n\t\"./utils.js\": 114\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 1365;","import React from 'react';\nimport { Route, Switch } from 'react-router-dom';\nimport App from '../App';\n\nexport default function AppRouter(props) {\n  return (\n    <Switch>\n      <Route path=\"/share/:text\" component={App} />\n      <Route path=\"/gist/:id\" component={App} />\n      <Route path=\"\" exact component={App} />\n    </Switch>\n  );\n}\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(/^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/)\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then((registration) => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch((error) => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then((response) => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (response.status === 404 || (contentType != null && contentType.indexOf('javascript') === -1)) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then((registration) => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log('No internet connection found. App is running in offline mode.');\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then((registration) => {\n        registration.unregister();\n      })\n      .catch((error) => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport AppRouter from './utils/AppRouter';\nimport * as serviceWorker from './serviceWorker';\nimport { HashRouter } from 'react-router-dom';\n\nReactDOM.render(\n  <React.StrictMode>\n    <HashRouter basename=\"/\">\n      <AppRouter />\n    </HashRouter>\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n","import React, { useState } from 'react';\nimport { deflateSync } from 'browserify-zlib';\nimport { CopyToClipboard } from 'react-copy-to-clipboard';\nimport { makeStyles } from '@material-ui/core/styles';\nimport { Link as LinkIcon, FileCopy } from '@material-ui/icons';\nimport {\n  Button,\n  Dialog,\n  DialogActions,\n  DialogContent,\n  DialogContentText,\n  DialogTitle,\n  IconButton,\n  Tooltip,\n  Link,\n  TextField,\n  Box\n} from '@material-ui/core';\nimport { generateLink } from '../utils/BitlyWorker';\nimport { theme } from '../App';\n\nconst useStyles = makeStyles((theme) => ({\n  iconButton: {\n    color: theme.palette.common.white,\n    padding: '3px'\n  },\n  textArea: {\n    width: '100%',\n    color: theme.palette.text.primary,\n    fontWeight: 'bold'\n  },\n  copyBox: {\n    backgroundColor: theme.palette.common.lightGrey,\n    borderRadius: 2,\n    display: 'flex',\n    justifyContent: 'space-between',\n    alignItems: 'center',\n    paddingLeft: '3%',\n    textOverflow: 'ellipsis'\n  }\n}));\n\nexport default function ShareLink(props) {\n  const classes = useStyles();\n  const [openShare, setOpenShare] = useState(false);\n  const [shareError, setShareError] = useState(false);\n  const [openGist, setOpenGist] = useState(false);\n  const [openGistError, setOpenGistError] = useState(false);\n  const [copyTip, setCopyTip] = useState('Copy to Clipboard');\n  const [{ fshCopied, fshCopyButton }, setFshCopied] = useState({\n    fshCopied: false,\n    fshCopyButton: 'Copy FSH to Clipboard'\n  });\n  const [link, setLink] = useState();\n  const [gistLink, setGistLink] = useState();\n  const [showCreateGistButton, setshowCreateGistButton] = useState(true);\n\n  const updateGistLink = (event) => {\n    const gistId = event.target.value.match(/gist\\.github\\.com\\/[^/]+\\/(.+)/)?.[1];\n    if (gistId) {\n      setGistLink(`https://fshschool.org/FSHOnline/#/gist/${gistId}`);\n    }\n  };\n\n  const handleShareError = () => {\n    setShareError(true);\n    handleOpenGist();\n  };\n\n  const handleOpenGist = () => {\n    setOpenShare(false);\n    setOpenGist(true);\n    setGistLink('');\n    setFshCopied({ fshCopied: false, fshCopyButton: 'Copy FSH to Clipboard' });\n  };\n\n  const handleCloseGist = () => {\n    setOpenGist(false);\n    setShareError(false);\n  };\n\n  const handleGenerateGistLink = () => {\n    if (gistLink) {\n      handleCloseGist();\n      setLink(gistLink);\n      setOpenShare(true);\n      setCopyTip('Copy to Clipboard');\n      setshowCreateGistButton(false);\n    } else {\n      setOpenGistError(true);\n    }\n  };\n\n  const handleCloseGistError = () => {\n    setOpenGistError(false);\n  };\n\n  const handleOpenShare = async () => {\n    let encoded;\n    if (\n      props.config?.canonical ||\n      props.config?.version ||\n      props.config?.fhirVersion.length > 0 ||\n      props.config?.dependencies\n    ) {\n      encoded = deflateSync(\n        JSON.stringify({\n          c: props.config?.canonical,\n          v: props.config?.version,\n          f: props.config?.fhirVersion,\n          d: props.config?.dependencies\n        }) +\n          '\\n' +\n          props.shareText\n      ).toString('base64');\n    } else {\n      encoded = deflateSync(props.shareText).toString('base64');\n    }\n    const longLink = `https://fshschool.org/FSHOnline/#/share/${encoded}`;\n    const bitlyLink = await generateLink(longLink);\n    if (bitlyLink.errorNeeded === true) {\n      handleShareError();\n    } else {\n      // Removes the encoded data from the end of the url, starting at index 15\n      const bitlySlice = bitlyLink.link.slice(15);\n      const displayLink = `https://fshschool.org/FSHOnline/#/share/${bitlySlice}`;\n      setLink(displayLink);\n      setOpenShare(true);\n      setCopyTip('Copy to Clipboard');\n      setshowCreateGistButton(true);\n    }\n  };\n\n  const handleCloseShare = () => {\n    setOpenShare(false);\n    setShareError(false);\n  };\n\n  const handleFSHcopy = () => {\n    setFshCopied({ fshCopied: true, fshCopyButton: 'FSH Copied to Clipboard' });\n  };\n\n  return (\n    <>\n      <Tooltip title=\"Share FSH\" placement=\"top\" arrow>\n        <IconButton name=\"Share FSH\" className={classes.iconButton} onClick={handleOpenShare}>\n          <LinkIcon fontSize=\"small\" style={{ transform: 'rotate(-45deg)' }} />\n        </IconButton>\n      </Tooltip>\n      <Dialog open={openShare} onClose={handleCloseShare} aria-labelledby=\"form-dialog-title\" maxWidth=\"md\" fullWidth>\n        <DialogTitle id=\"form-dialog-title\">Share</DialogTitle>\n        <DialogContent>\n          <DialogContentText>Use this link to share your FSH with others!</DialogContentText>\n          <Box className={classes.copyBox}>\n            <Box maxWidth=\"90%\" textOverflow=\"ellipsis\" overflow=\"hidden\">\n              {link}\n            </Box>\n            <Tooltip title={copyTip} placement=\"top\" arrow>\n              <CopyToClipboard text={link} onCopy={() => setCopyTip('Link Copied')}>\n                <IconButton style={{ borderRadius: '0%' }}>\n                  <FileCopy />\n                </IconButton>\n              </CopyToClipboard>\n            </Tooltip>\n          </Box>\n        </DialogContent>\n        <DialogActions>\n          {showCreateGistButton && (\n            <Button onClick={handleOpenGist} color=\"primary\" style={{ align: 'left' }}>\n              Create Link with Gist\n            </Button>\n          )}\n          <Box style={{ flex: '1 0 0', hidden: true }} />\n          <Button onClick={handleCloseShare} color=\"primary\">\n            Done\n          </Button>\n        </DialogActions>\n      </Dialog>\n      <Dialog open={openGist} onClose={handleCloseGist} aria-labelledby=\"alert-dialog-title\" maxWidth=\"md\" fullWidth>\n        <DialogTitle id=\"alert-dialog-title\">Share with Gist</DialogTitle>\n        {shareError && (\n          <DialogContent style={{ color: theme.palette.common.red }}>\n            Your FSH content is too long to share directly. Please use a Gist to share.\n          </DialogContent>\n        )}\n        <DialogContent>\n          Create a{' '}\n          <Link id=\"gistURL\" href=\"https://gist.github.com/\" target=\"_blank\">\n            Gist\n          </Link>{' '}\n          and paste the URL below to generate a shareable FSH Online link.\n          <TextField id=\"gistURLText\" label=\"Gist URL\" fullWidth onChange={updateGistLink} />\n        </DialogContent>\n        <DialogActions style={{ bottom: 0, right: 0 }}>\n          <Button onClick={handleCloseGist} color=\"primary\">\n            Cancel\n          </Button>\n          <Box style={{ flex: '1 0 0', hidden: true }} />\n          <CopyToClipboard text={props.shareText} onCopy={handleFSHcopy} style={{ align: 'left' }}>\n            <Button color={fshCopied ? 'secondary' : 'primary'}>{fshCopyButton}</Button>\n          </CopyToClipboard>\n          <Button color=\"primary\" onClick={handleGenerateGistLink} style={{ align: 'left' }}>\n            Generate Link from Gist\n          </Button>\n        </DialogActions>\n      </Dialog>\n      <Dialog open={openGistError} onClose={handleCloseGistError} aria-labelledby=\"alert-dialog-title\" maxWidth=\"lg\">\n        <DialogTitle id=\"alert-dialog-title\">Error Creating Gist Link</DialogTitle>\n        <DialogContent>\n          <DialogContentText>Could not generate a link from your Gist URL. Ensure the URL is valid.</DialogContentText>\n        </DialogContent>\n        <DialogActions>\n          <Button onClick={handleCloseGistError} color=\"primary\" autoFocus>\n            Keep Swimming!\n          </Button>\n        </DialogActions>\n      </Dialog>\n    </>\n  );\n}\n","import React, { useState, useContext } from 'react';\nimport clsx from 'clsx';\nimport { upperFirst } from 'lodash';\nimport { Button, Box, Drawer, IconButton, Tooltip } from '@material-ui/core';\nimport { ChevronLeft, ChevronRight, Delete, FileCopy, SaveAlt } from '@material-ui/icons';\nimport { UnControlled as ReactCodeMirror } from 'react-codemirror2';\nimport { makeStyles } from '@material-ui/core/styles';\nimport CodeMirror from 'codemirror';\nimport { ExpandedConsoleContext } from '../App';\nimport ShareLink from './ShareLink';\nimport '../style/CodeMirrorComponent.css';\nimport 'codemirror/lib/codemirror.css';\nimport 'codemirror/theme/material.css';\nimport 'codemirror/addon/fold/foldgutter.css';\nimport 'codemirror/addon/scroll/simplescrollbars.css';\nrequire('codemirror/addon/mode/simple');\nrequire('codemirror/addon/edit/closebrackets');\nrequire('codemirror/addon/display/placeholder');\nrequire('codemirror/addon/comment/comment');\nrequire('codemirror/addon/fold/foldgutter');\nrequire('codemirror/addon/fold/brace-fold');\nrequire('codemirror/mode/xml/xml');\nrequire('codemirror/mode/javascript/javascript');\nrequire('codemirror/addon/scroll/simplescrollbars');\n\n// Define FSH syntax highlighting\n// Regular expressions from https://github.com/standardhealth/vscode-language-fsh/blob/master/syntaxes/fsh.tmLanguage.json\nCodeMirror.defineSimpleMode('fsh', {\n  meta: {\n    lineComment: '//'\n  },\n  start: [\n    // The regex matches the token, the token property contains the type\n    {\n      regex: /\"(?:[^\\\\]|\\\\.)*?(?:\"|$)/,\n      token: 'atom'\n    },\n    {\n      regex: /\\b(Alias|CodeSystem|Expression|Extension|Description|Id|Instance|InstanceOf|Invariant|Logical|Mapping|Mixins|Parent|Profile|Resource|RuleSet|Severity|Source|Target|Title|Usage|ValueSet|XPath)(?=\\s*:)\\b/,\n      token: 'keyword'\n    },\n    {\n      // NOTE: Original regex has (?<=\\s|^) at start and (?=\\s) at the end, and (?<=\\\\bfrom\\\\s*) before 'system'.\n      // However, there are known shortcomings with look ahead/look behind with the simple mode approach\n      // NOTE: \"from system\" must come before \"from\" in order to properly match the full phrase.\n      regex: /(\\s|^)(and|codes|contains|descendent-of|exclude|exists|from system|from|generalizes|include|in|insert|is-a|is-not-a|named|not-in|obeys|only|or|regex|units|valueset|where|D|MS|N|SU|TU|\\\\?!)(\\s|$)/,\n      token: 'def'\n    },\n    {\n      regex: /(\\(\\s*)(exactly|example|extensible|preferred|required)(\\s*\\))/,\n      token: 'def'\n    },\n    {\n      regex: /\\b(Reference|Canonical)\\s*\\(/,\n      push: 'closingParen', // Matches the closing parenthesis while not highlighting the content between ( )\n      token: 'atom'\n    },\n    {\n      regex: /\\*|->|=|\\+|:/,\n      token: 'def'\n    },\n    {\n      regex: /\\b(https?:\\/\\/(www\\.)?[-a-zA-Z0-9@:%._+~#=]{2,256}\\.[a-z]{2,6}\\b([-a-zA-Z0-9@:%_+.~#?&//=]*))\\b/,\n      token: 'atom'\n    },\n    {\n      // NOTE: Original regex has (?<=\\s|^) at start and (?=\\s) at end\n      regex: /(\\s|^)(true|false)(\\s|$)/,\n      token: 'string'\n    },\n    {\n      // NOTE: Original regex has (?<=\\s|^) and (?=\\s) at end\n      regex: /(\\s|^)(-?\\d+(\\.\\d+)?)(\\s|^)/, // numbers\n      token: 'string'\n    },\n    {\n      regex: /#\"(?:\\\\.|[^\\\\\"])*\"/, // #\"quoted code\"\n      token: 'string'\n    },\n    {\n      regex: /#[^\\s]*/, // #code\n      token: 'string'\n    },\n    {\n      regex: /'.*'/, // 'ucum'\n      token: 'string'\n    },\n    // The following two regex should be combined into: /(\\s|^)\\/\\/.*/\n    // However, the ^ doesn't work as expected. See sol section: https://codemirror.net/demo/simplemode.html\n    // Instead, we break them into two separate cases:\n    // the comment is preceded by whitespace and the comment is at the start of a line.\n    { regex: /\\s\\/\\/.*/, token: 'comment' },\n    { regex: /\\/\\/.*/, token: 'comment', sol: true },\n    // Start of multiline comment\n    { regex: /\\/\\*/, token: 'comment', next: 'comment' }\n  ],\n  closingParen: [\n    {\n      regex: /\\)/,\n      pop: true,\n      token: 'atom'\n    }\n  ],\n  comment: [\n    { regex: /.*?\\*\\//, token: 'comment', next: 'start' },\n    { regex: /.*/, token: 'comment' }\n  ]\n});\n\nconst drawerWidth = 200;\n\nconst useStyles = makeStyles((theme) => ({\n  box: {\n    height: '100%'\n  },\n  header: {\n    fontFamily: 'Open Sans',\n    color: theme.palette.common.white,\n    background: theme.palette.common.darkerGrey,\n    padding: '0px',\n    paddingLeft: '29px', // width of code mirror gutter\n    height: '34px', // 24px + 10px of padding is total height\n    display: 'flex',\n    justifyContent: 'space-between',\n    transition: theme.transitions.create(['margin', 'width'], {\n      easing: theme.transitions.easing.sharp,\n      duration: theme.transitions.duration.leavingScreen\n    })\n  },\n  headerShift: {\n    width: `calc(100% - ${drawerWidth}px - 29px)`,\n    transition: theme.transitions.create(['margin', 'width'], {\n      easing: theme.transitions.easing.easeOut,\n      duration: theme.transitions.duration.enteringScreen\n    }),\n    marginRight: drawerWidth\n  },\n  headerLabel: {\n    lineHeight: '34px',\n    float: 'left',\n\n    // Ellipse for long resource ids\n    whiteSpace: 'nowrap',\n    overflow: 'hidden',\n    textOverflow: 'ellipsis'\n  },\n  headerActionGroup: {\n    paddingRight: '10px'\n  },\n  headerActions: {\n    alignItems: 'center',\n    display: 'flex'\n  },\n  iconButton: {\n    color: theme.palette.common.white,\n    padding: '3px'\n  },\n  drawer: {\n    width: drawerWidth,\n    flexShrink: 0\n  },\n  drawerPaper: {\n    width: drawerWidth,\n    border: 'none',\n    // necessary for content to be TopBar and in line with editor\n    height: 'calc(100vh - 116px - 34px)',\n    top: '116px'\n  },\n  drawerPaperExpandedConsole: {\n    height: 'calc(100vh - 116px - 300px)'\n  },\n  drawerHeader: {\n    display: 'flex',\n    alignItems: 'center',\n    justifyContent: 'flex-start',\n    // Color to match header\n    color: theme.palette.common.white,\n    background: theme.palette.common.darkerGrey,\n    height: '34px', // Same height as headers on CodeMirror editors\n    minHeight: '34px'\n  },\n  drawerHeaderIcon: {\n    padding: '0px',\n    color: theme.palette.common.white,\n    background: theme.palette.success.main,\n    '&:hover': {\n      background: theme.palette.success.light\n    },\n    borderRadius: 0,\n    height: '100%',\n    width: '34px',\n    minWidth: '34px' // width and minWidth match the height so button is a square\n  },\n  content: {\n    flexGrow: 1,\n    width: '100%',\n    transition: theme.transitions.create(['margin', 'width'], {\n      easing: theme.transitions.easing.sharp,\n      duration: theme.transitions.duration.leavingScreen\n    })\n  },\n  contentShift: {\n    width: `calc(100% - ${drawerWidth}px)`,\n    transition: theme.transitions.create(['margin', 'width'], {\n      easing: theme.transitions.easing.easeOut,\n      duration: theme.transitions.duration.enteringScreen\n    }),\n    marginRight: 0\n  }\n}));\n\nexport default function CodeMirrorComponent(props) {\n  const classes = useStyles();\n  const expandedConsoleContext = useContext(ExpandedConsoleContext);\n  const [drawerOpen, setDrawerOpen] = useState(true);\n\n  const handleDrawerOpen = () => {\n    setDrawerOpen(true);\n  };\n\n  const handleDrawerClose = () => {\n    setDrawerOpen(false);\n  };\n\n  //Updates both the text state with the codemirror value\n  function updateText(text) {\n    props.updateTextValue(text);\n  }\n\n  const renderActionIcon = (Icon, label, onClick, style = {}) => {\n    return (\n      <Tooltip title={upperFirst(label)} placement=\"top\" arrow>\n        <IconButton name={label} className={classes.iconButton} aria-label={label} onClick={onClick}>\n          <Icon fontSize=\"small\" style={style} />\n        </IconButton>\n      </Tooltip>\n    );\n  };\n\n  const renderActionIcons = () => {\n    // Render only specified actions\n    return (\n      <div className={classes.headerActions}>\n        <div className={classes.headerActionGroup}>\n          {props.mode === 'fsh' && !props.isExamples && <ShareLink shareText={props.value} config={props.config} />}\n          {props.copy && renderActionIcon(FileCopy, 'copy', () => {})}\n          {props.save && renderActionIcon(SaveAlt, 'save', props.save)}\n          {props.delete && renderActionIcon(Delete, 'delete', props.delete)}\n        </div>\n        {props.renderDrawer && !drawerOpen && (\n          <IconButton name=\"expand\" className={classes.drawerHeaderIcon} aria-label=\"expand\" onClick={handleDrawerOpen}>\n            <ChevronLeft />\n          </IconButton>\n        )}\n      </div>\n    );\n  };\n\n  const renderDrawer = () => {\n    return (\n      <Drawer\n        className={classes.drawer}\n        data-testid={'editor-drawer'}\n        variant=\"persistent\"\n        anchor=\"right\"\n        open={drawerOpen}\n        classes={{\n          paper: clsx(classes.drawerPaper, expandedConsoleContext && classes.drawerPaperExpandedConsole)\n        }}\n      >\n        <div className={classes.drawerHeader}>\n          <Button\n            name=\"collapse\"\n            aria-label=\"collapse\"\n            className={classes.drawerHeaderIcon}\n            onClick={handleDrawerClose}\n          >\n            <ChevronRight />\n          </Button>\n        </div>\n        {props.renderDrawer()}\n      </Drawer>\n    );\n  };\n\n  return (\n    <Box className={classes.box}>\n      <div\n        className={clsx(classes.header, {\n          [classes.headerShift]: props.renderDrawer && drawerOpen\n        })}\n      >\n        <div title={props.name} className={classes.headerLabel}>\n          {props.name}\n        </div>\n        {renderActionIcons()}\n      </div>\n      <ReactCodeMirror\n        className={clsx('react-codemirror2', props.renderDrawer && classes.content, {\n          [classes.contentShift]: props.renderDrawer && drawerOpen\n        })}\n        value={props.initialText}\n        options={{\n          mode: props.mode,\n          theme: 'material',\n          placeholder: props.placeholder,\n          scrollbarStyle: 'overlay',\n          autoCloseBrackets: true,\n          lineNumbers: true,\n          foldGutter: true,\n          readOnly: props.isExamples,\n          gutters: ['CodeMirror-linenumbers', 'CodeMirror-foldgutter'],\n          extraKeys: {\n            Tab: (cm) => {\n              // Replace tab character with two spaces\n              // Example described here: https://codemirror.net/doc/manual.html#keymaps\n              cm.replaceSelection('  ');\n            },\n            'Ctrl-/': 'toggleComment',\n            'Cmd-/': 'toggleComment',\n            'Ctrl-Q': (cm) => {\n              cm.foldCode(cm.getCursor());\n            }\n          }\n        }}\n        onChange={(editor, data, value) => {\n          updateText(value);\n        }}\n      />\n      {props.renderDrawer && renderDrawer()}\n    </Box>\n  );\n}\n","const BitlyClient = require('bitly').BitlyClient;\nconst bitly = new BitlyClient(process.env.REACT_APP_BITLY_KEY);\n\nexport async function generateLink(longLink) {\n  return new Promise((resolve) => {\n    bitly\n      .shorten(longLink)\n      .then(function (result) {\n        resolve({ link: result.link, errorNeeded: false });\n      })\n      .catch(function (error) {\n        if (process.env.REACT_APP_BITLY_KEY == null) {\n          console.error(\n            'Error: REACT_APP_BITLY_KEY needs to be set as an environment variable in order to share FSH Online links.'\n          );\n          resolve({ link: undefined, errorNeeded: true });\n        } else {\n          resolve({ link: undefined, errorNeeded: true });\n        }\n      });\n  });\n}\n\nexport async function expandLink(encodedFsh) {\n  const bitlyURL = `https://bit.ly/${encodedFsh.text}`;\n  return new Promise((resolve) => {\n    bitly\n      .expand(bitlyURL)\n      .then(function (result) {\n        resolve(result);\n      })\n      .catch(function (error) {\n        console.error(error);\n      });\n  });\n}\n","import React from 'react';\nimport { Button, Dialog, DialogActions, DialogContent, DialogContentText, DialogTitle } from '@material-ui/core';\n\nexport default function DeleteConfirmationModal(props) {\n  return (\n    <Dialog open={props.isOpen} onClose={props.handleCloseModal} aria-labelledby=\"delete-confirmation-dialog\">\n      <DialogTitle id=\"delete-confirmation-dialog-title\">Delete {props.title}</DialogTitle>\n      <DialogContent>\n        <DialogContentText>\n          Are you sure you want to delete {props.item}? This action cannot be undone.\n        </DialogContentText>\n      </DialogContent>\n      <DialogActions>\n        <Button onClick={props.handleCloseModal} color=\"primary\" autoFocus>\n          Cancel\n        </Button>\n        <Button onClick={props.handleDelete} color=\"secondary\">\n          Delete\n        </Button>\n      </DialogActions>\n    </Dialog>\n  );\n}\n","import React, { useState, useEffect } from 'react';\nimport FileSaver from 'file-saver';\nimport { groupBy, isEqual } from 'lodash';\nimport { makeStyles } from '@material-ui/core/styles';\nimport clsx from 'clsx';\nimport { Button, List, ListItem, Tooltip } from '@material-ui/core';\nimport { Add, ErrorOutline } from '@material-ui/icons';\nimport CodeMirrorComponent from './CodeMirrorComponent';\nimport DeleteConfirmationModal from './DeleteConfirmationModal';\n\nconst useStyles = makeStyles((theme) => ({\n  fileTreeContent: {\n    overflowY: 'scroll',\n    height: '100%'\n  },\n  button: {\n    color: theme.palette.common.white,\n    background: theme.palette.success.main,\n    '&:hover': {\n      background: theme.palette.success.dark\n    },\n    border: '8px solid white',\n    fontSize: '13px',\n    width: '100%'\n  },\n  list: {\n    padding: '8px',\n    paddingLeft: '0px',\n    paddingBottom: '0px',\n    fontSize: '13px'\n  },\n  listItemError: {\n    paddingTop: '5px',\n    paddingBottom: '5px',\n    margin: 0\n  },\n  listItem: {\n    background: theme.palette.common.lightestGrey,\n    paddingTop: '5px',\n    paddingBottom: '5px',\n    marginTop: '5px',\n    marginBottom: '5px',\n    paddingLeft: '5px',\n    // paddingRight is driven by ListItem (16px)\n    margin: 0,\n    '&:hover': {\n      background: theme.palette.common.lightGrey\n    },\n\n    // Ellipse for long resource ids\n    display: 'block',\n    whiteSpace: 'nowrap',\n    overflow: 'hidden',\n    textOverflow: 'ellipsis'\n  },\n  listItemSelected: {\n    background: theme.palette.common.editorGrey, // editor background color\n    color: theme.palette.common.white,\n    '&:hover': {\n      background: theme.palette.common.darkestGrey\n    }\n  },\n  listHeader: {\n    padding: '5px',\n    paddingLeft: '15px'\n  },\n  listIcon: {\n    color: theme.palette.success.main,\n    verticalAlign: 'middle',\n    fontSize: '13px',\n    paddingLeft: '3px',\n    paddingRight: '3px'\n  },\n  listIconError: {\n    color: theme.palette.common.red\n  },\n  blankIcon: {\n    paddingLeft: '19px' // width of icon\n  }\n}));\n\nconst checkFshType = (def) => {\n  // The criteria in this function is based on isSDForInstance in GoFSH (LakeOfFHIR.ts)\n  // A Profile has kind \"resource\", \"complex-type\", or \"primitive-type\" and derivation \"constraint\".\n  // An Extension has kind \"complex-type\", derivation \"constraint\", and type \"Extension\". It's a special case of Profile.\n  // A Logical has kind \"logical\" and derivation \"specialization\".\n  // A Resource has kind \"resource\" and derivation \"specialization\".\n  // Any other combination of values for kind and derivation represents an Instance.\n  if (def.resourceType === 'ValueSet' || def.resourceType === 'CodeSystem') {\n    return def.resourceType;\n  } else if (def.resourceType === 'StructureDefinition') {\n    if (def.derivation === 'specialization') {\n      if (def.kind === 'resource') {\n        return 'Resource';\n      } else if (def.kind === 'logical') {\n        return 'Logical Model';\n      }\n    } else if (def.derivation === 'constraint') {\n      if (def.kind === 'complex-type' && def.type === 'Extension') {\n        return 'Extension';\n      } else if (['resource', 'complex-type', 'primitive-type', 'logical'].includes(def.kind)) {\n        return 'Profile';\n      }\n    }\n  }\n\n  // We could have an instance of a SD that can't be a Profile, Extension, Logical, or Resource\n  // So we want to check for any resource that hasn't already been categorized\n  if (def.resourceType != null) {\n    return 'Instance';\n  }\n\n  // Otherwise we don't know the type. This will default to 'Unknown Type' if it is missing.\n  return null;\n};\n\n// Flatten the package so we can render and navigate it more easily,\n// but keep high level attributes we'll need accessible\nconst getIterablePackage = (defsPackage) => {\n  const defArray = [\n    ...defsPackage.profiles,\n    ...defsPackage.extensions,\n    ...defsPackage.logicals,\n    ...defsPackage.resources,\n    ...defsPackage.instances,\n    ...defsPackage.valueSets,\n    ...defsPackage.codeSystems\n  ];\n  return defArray.map((def) => ({ resourceType: checkFshType(def), id: def.id, def: JSON.stringify(def, null, 2) }));\n};\n\nexport default function JSONOutput(props) {\n  const classes = useStyles();\n  const [initialText, setInitialText] = useState('');\n  const [fhirDefinitions, setFhirDefinitions] = useState([{ resourceType: null, id: 'Untitled', def: null }]);\n  const { setShowNewText, updateTextValue: propsUpdateText } = props;\n  const [currentDef, setCurrentDef] = useState(0);\n  const [defsWithErrors, setDefsWithErrors] = useState([]);\n  const [openDeleteConfirmation, setOpenDeleteConfirmation] = useState(false);\n\n  useEffect(() => {\n    // This case represents when we receive a new Package from SUSHI\n    if (props.showNewText && !isEqual(props.text, [''])) {\n      setShowNewText(false); // Indicate that we no longer have new data we need to load so we don't come back here too early\n      let packageJSON;\n      try {\n        packageJSON = JSON.parse(props.text);\n      } catch (e) {\n        packageJSON = {\n          profiles: [],\n          extensions: [],\n          logicals: [],\n          resources: [],\n          instances: [],\n          valueSets: [],\n          codeSystems: []\n        };\n      }\n      const iterablePackage = getIterablePackage(packageJSON);\n      setFhirDefinitions(iterablePackage);\n      setCurrentDef(0);\n      setInitialText(iterablePackage.length > 0 ? iterablePackage[0].def : '');\n      propsUpdateText(iterablePackage); // The value of text kept on props should be the iterable and stringified package\n    } else if (props.isWaiting) {\n      setInitialText(null); // Reset the text to null when loading to reset the editor and display placeholder text\n      setFhirDefinitions([]); // Reset FHIR definitions to clear out file tree\n    }\n  }, [props.text, props.showNewText, props.isWaiting, propsUpdateText, setShowNewText]);\n\n  const updateTextValue = (text) => {\n    // We're waiting for a new package to load, so we don't want the editor to update yet\n    if (props.isWaiting) return;\n\n    // Update the definition we're currently editing\n    const updatedDefs = [...fhirDefinitions];\n\n    // Check if there is a JSON syntax error in the editor\n    try {\n      // If the editor is blank, we want to consider it an empty JSON object so that it is valid JSON\n      const latestJSON = text === '' ? {} : JSON.parse(text);\n      // If there was an error, mark it as resolved\n      if (defsWithErrors.includes(currentDef)) {\n        const newErrors = [...defsWithErrors];\n        newErrors.splice(defsWithErrors.indexOf(currentDef), 1);\n        setDefsWithErrors(newErrors);\n      }\n\n      // If it's new, set metadata (definition text is set below)\n      if (!fhirDefinitions[currentDef]) {\n        updatedDefs[currentDef] = {\n          resourceType: checkFshType(latestJSON),\n          id: latestJSON.id ?? 'Untitled'\n        };\n      }\n\n      // Update resource type if it has changed\n      if (!fhirDefinitions[currentDef] || latestJSON.resourceType !== fhirDefinitions[currentDef].resourceType) {\n        updatedDefs[currentDef].resourceType = checkFshType(latestJSON);\n      }\n\n      // Update id if it has changed or it is new\n      if (!fhirDefinitions[currentDef] || latestJSON.id !== fhirDefinitions[currentDef].id) {\n        updatedDefs[currentDef].id = latestJSON.id ?? 'Untitled';\n      }\n    } catch (e) {\n      // Invalid JSON typed. Keep track of index.\n      if (!defsWithErrors.includes(currentDef)) {\n        const newErrors = [...defsWithErrors];\n        newErrors.push(currentDef);\n        setDefsWithErrors(newErrors);\n      }\n    }\n\n    // Update the text - regardless if it was valid JSON\n    if (updatedDefs[currentDef]) {\n      updatedDefs[currentDef].def = text;\n    }\n    setFhirDefinitions(updatedDefs);\n    props.updateTextValue(updatedDefs);\n\n    // This is a bit of a hack to make sure the editor can be reset by a setInitialText(null)\n    if (initialText === null) {\n      setInitialText(text);\n    }\n  };\n\n  const addDefinition = () => {\n    const updatedDefs = [...fhirDefinitions];\n    updatedDefs.push({ resourceType: null, id: 'Untitled', def: null });\n    setCurrentDef(updatedDefs.length - 1);\n    setFhirDefinitions(updatedDefs);\n    setInitialText(null);\n    props.updateTextValue(updatedDefs);\n  };\n\n  const handleCloseAndDelete = () => {\n    const index = currentDef;\n    const updatedDefs = [...fhirDefinitions];\n    updatedDefs.splice(index, 1); // Remove definition to be deleted\n    if (updatedDefs.length === 0) {\n      // Ensure list is not empty so there is always a definition in the file tree\n      updatedDefs.push({ resourceType: null, id: 'Untitled', def: null });\n    }\n    setFhirDefinitions(updatedDefs);\n\n    // If we deleted the currently viewed definition or any before it, update it\n    if (index <= currentDef) {\n      let newCurrentDef = 0;\n      if (index < currentDef) {\n        newCurrentDef = currentDef - 1;\n      }\n      setCurrentDef(newCurrentDef);\n      const newCurrentDefText = updatedDefs.length > 0 ? updatedDefs[newCurrentDef].def : null;\n      setInitialText(newCurrentDefText);\n    }\n\n    // Update error tracking\n    const newErrors = [...defsWithErrors];\n    if (defsWithErrors.includes(index)) {\n      // If the definition had an error, remove it from the list\n      newErrors.splice(defsWithErrors.indexOf(index), 1);\n    }\n    // Shift any indices that came after the deleted definition to properly track errors\n    const shiftedErrors = newErrors.map((i) => (i < index ? i : i - 1));\n    setDefsWithErrors(shiftedErrors);\n\n    setOpenDeleteConfirmation(false);\n    props.updateTextValue(updatedDefs);\n  };\n\n  const handleOpenDeleteConfirmation = () => {\n    setOpenDeleteConfirmation(true);\n  };\n\n  const handleCloseDeleteConfirmation = () => {\n    setOpenDeleteConfirmation(false);\n  };\n\n  const handleSave = (def, defaultName) => {\n    let resourceObj;\n    try {\n      resourceObj = JSON.parse(def);\n    } catch {\n      /* Ignore errors and just default to name without resourceType */\n    }\n    FileSaver.saveAs(\n      new Blob([def]),\n      resourceObj?.resourceType && resourceObj?.id\n        ? `${resourceObj.resourceType}-${resourceObj.id}.json`\n        : `${name}.json`\n    );\n  };\n\n  const renderDeleteModal = () => {\n    const defToDelete = fhirDefinitions[currentDef];\n    if (!defToDelete) {\n      return;\n    }\n    const type = defToDelete.resourceType || 'Unknown Type';\n    const id = defToDelete.id || 'Untitled';\n    return (\n      <DeleteConfirmationModal\n        title={'FHIR JSON'}\n        item={`${type} ${id}`}\n        isOpen={openDeleteConfirmation}\n        handleCloseModal={handleCloseDeleteConfirmation}\n        handleDelete={handleCloseAndDelete}\n      />\n    );\n  };\n\n  const renderFileTreeView = () => {\n    const order = [\n      'Profiles',\n      'Extensions',\n      'Logical Models',\n      'Resources',\n      'ValueSets',\n      'CodeSystems',\n      'Instances',\n      'Unknown Type'\n    ];\n    const grouped = groupBy(fhirDefinitions, (val) => {\n      if (val && val.resourceType) return `${val.resourceType}s`;\n      return 'Unknown Type';\n    });\n\n    return Object.keys(grouped)\n      .sort((a, b) => order.indexOf(a) - order.indexOf(b)) // Sort so we keep a defined order of types in the tree\n      .map((key) => {\n        return (\n          <List component=\"nav\" key={key} className={classes.list}>\n            <div className={classes.listHeader}>{key}</div>\n            {grouped[key]\n              .sort((a, b) => {\n                const aId = a.id ? a.id : 'Untitled'; // Treat missing or blank ids as \"Untitled\"\n                const bId = b.id ? b.id : 'Untitled';\n                return aId.toLowerCase() < bId.toLowerCase() ? -1 : aId.toLowerCase() > bId.toLowerCase() ? 1 : 0;\n              }) // Sort ids alphabetically\n              .map((def, i) => {\n                const currentIndex = fhirDefinitions.indexOf(def);\n                const isError = defsWithErrors.includes(currentIndex);\n                return (\n                  <ListItem\n                    button\n                    key={i}\n                    title={def?.id || 'Untitled'}\n                    data-testid={`${key}-defId`}\n                    className={clsx(\n                      classes.listItem,\n                      isError && classes.listItemError,\n                      currentIndex === currentDef && classes.listItemSelected\n                    )}\n                    onClick={() => {\n                      setCurrentDef(currentIndex);\n                      setInitialText(def.def);\n                    }}\n                  >\n                    {defsWithErrors.includes(currentIndex) ? (\n                      <Tooltip title=\"Invalid JSON\" placement=\"top\" arrow>\n                        <ErrorOutline className={clsx(classes.listIcon, classes.listIconError)} />\n                      </Tooltip>\n                    ) : (\n                      <span className={classes.blankIcon} />\n                    )}\n                    {def?.id || 'Untitled'}\n                  </ListItem>\n                );\n              })}\n          </List>\n        );\n      });\n  };\n\n  const renderDrawer = () => {\n    return (\n      <>\n        <Button className={classes.button} startIcon={<Add />} onClick={addDefinition}>\n          New JSON Editor\n        </Button>\n        <div className={classes.fileTreeContent}>{renderFileTreeView()}</div>\n      </>\n    );\n  };\n\n  const displayValue = fhirDefinitions.length > 0 ? fhirDefinitions[currentDef].def : null;\n  const name = `${fhirDefinitions.length > 0 ? fhirDefinitions[currentDef].id : 'Untitled'}`;\n\n  return (\n    <>\n      <CodeMirrorComponent\n        name={`FHIR JSON: ${name}`}\n        value={displayValue}\n        initialText={initialText}\n        updateTextValue={updateTextValue}\n        mode={'application/json'}\n        placeholder={\n          props.isWaiting\n            ? 'Loading...'\n            : 'Paste or edit single FHIR JSON artifact here... \\nCreate additional FHIR JSON artifacts to the right.'\n        }\n        renderDrawer={renderDrawer}\n        isExamples={false}\n        delete={handleOpenDeleteConfirmation}\n        save={() => handleSave(displayValue, name)}\n      />\n      {openDeleteConfirmation && renderDeleteModal()}\n    </>\n  );\n}\n","import React, { useState } from 'react';\nimport FileSaver from 'file-saver';\nimport CodeMirrorComponent from './CodeMirrorComponent';\nimport DeleteConfirmationModal from './DeleteConfirmationModal';\n\nexport default function FSHOutput(props) {\n  const [openDeleteModal, setOpenDeleteModal] = useState(false);\n\n  const handleOpenDeleteModal = () => {\n    setOpenDeleteModal(!openDeleteModal);\n  };\n\n  const handleCloseAndDelete = () => {\n    setOpenDeleteModal(false);\n    props.setInitialText('');\n  };\n\n  const handleSave = () => {\n    FileSaver.saveAs(new Blob([props.text]), 'FSH.fsh');\n  };\n\n  return (\n    <>\n      <CodeMirrorComponent\n        name={'FSH'}\n        isExamples={false}\n        value={props.text}\n        initialText={props.initialText}\n        updateTextValue={props.updateTextValue}\n        mode={'fsh'}\n        placeholder={props.isWaiting ? 'Loading...' : 'Paste or edit FSH here...'}\n        delete={handleOpenDeleteModal}\n        save={handleSave}\n        config={props.config}\n      />\n      {openDeleteModal && (\n        <DeleteConfirmationModal\n          title={'FHIR Shorthand'}\n          item={'all FSH'}\n          isOpen={openDeleteModal}\n          handleCloseModal={handleOpenDeleteModal}\n          handleDelete={handleCloseAndDelete}\n        />\n      )}\n    </>\n  );\n}\n","import React, { useState, useEffect } from 'react';\nimport { makeStyles } from '@material-ui/core/styles';\nimport { Box, Button, IconButton } from '@material-ui/core';\nimport { ExpandLess, ExpandMore } from '@material-ui/icons';\n\nconst useStyles = makeStyles((theme) => ({\n  consoleControls: {\n    background: theme.palette.common.darkestGrey,\n    height: '34px',\n    boxSizing: 'border-box',\n    display: 'flex;',\n    alignItems: 'center',\n    justifyContent: 'left'\n  },\n  box: {\n    paddingLeft: '29px', // Same padding as header of code mirror\n    color: theme.palette.common.white,\n    background: theme.palette.common.darkestGrey,\n    height: 'calc(100% - 34px)',\n    overflow: 'scroll',\n    boxSizing: 'border-box'\n  },\n  button: {\n    marginRight: '10px',\n    color: theme.palette.common.white,\n    textTransform: 'none',\n    padding: 0\n  },\n  problemsButton: {\n    padding: 0,\n    color: theme.palette.common.white,\n    textTransform: 'none'\n  },\n  expandIcon: {\n    width: '29px', // Lines up with padding,\n    color: theme.palette.common.white,\n    padding: 0\n  },\n  pre: {\n    margin: '0px'\n  },\n  circle: {\n    'border-radius': '50%',\n    'border-style': 'solid',\n    'border-width': '2px',\n    'min-width': '20px',\n    height: '20px',\n    paddingLeft: 1,\n    paddingRight: 1,\n    background: '#263238',\n    'align-items': 'center',\n    display: 'flex',\n    marginLeft: 4,\n    'justify-content': 'center',\n    padding: 0\n  }\n}));\n\nexport default function Console(props) {\n  const classes = useStyles();\n  const [problemsView, setProblemsView] = useState(false);\n  const { problemCount, setExpandConsole } = props;\n\n  useEffect(() => {\n    // When props.problemCount changes and if there is a problem, make sure to open the console.\n    // If the problemCount is 0, we don't need to open it.\n    // The console should be able to be closed, so don't track whether the props.expandConsole value has changed.\n    if (problemCount) {\n      setExpandConsole(true);\n    }\n  }, [problemCount, setExpandConsole]);\n\n  const toggleExpandConsole = () => {\n    props.setExpandConsole(!props.expandConsole);\n  };\n\n  const setMessagesConsole = () => {\n    setProblemsView(false);\n    props.setExpandConsole(true);\n  };\n\n  const setProblemsConsole = () => {\n    setProblemsView(true);\n    props.setExpandConsole(true);\n  };\n\n  return (\n    <>\n      <Box className={classes.consoleControls}>\n        <IconButton\n          onClick={toggleExpandConsole}\n          aria-label={props.expandConsole ? 'collapse console' : 'expand console'}\n          className={classes.expandIcon}\n        >\n          {props.expandConsole ? <ExpandMore /> : <ExpandLess />}\n        </IconButton>\n        <Button onClick={setMessagesConsole} className={classes.button}>\n          <p\n            style={{\n              borderBottom: props.expandConsole && !problemsView ? '1px solid white' : 'none',\n              margin: '0'\n            }}\n          >\n            Console\n          </p>\n        </Button>\n        <Button onClick={setProblemsConsole} className={classes.problemsButton}>\n          <p\n            style={{\n              borderBottom:\n                props.expandConsole && problemsView\n                  ? `1px solid ${!props.problemCount ? 'white' : props.problemColor}`\n                  : 'none',\n              margin: '0'\n            }}\n          >\n            Problems\n          </p>\n          <div\n            className={classes.circle}\n            style={{ borderColor: `${!props.problemCount ? 'white' : props.problemColor}` }}\n          >\n            {props.problemCount}\n          </div>\n        </Button>\n      </Box>\n      <Box style={{ display: props.expandConsole ? 'block' : 'none' }} className={classes.box}>\n        {problemsView\n          ? props.problemMessages.map((message, i) => {\n              return (\n                <pre key={i} className={classes.pre}>\n                  {message}\n                </pre>\n              );\n            })\n          : props.consoleMessages.map((message, i) => {\n              return (\n                <pre key={i} className={classes.pre}>\n                  {message}\n                </pre>\n              );\n            })}\n      </Box>\n    </>\n  );\n}\n","import tarStream from 'tar-stream';\nimport zlib from 'zlib';\nimport https from 'https';\nimport { utils } from 'fsh-sushi';\nconst logger = utils.logger;\n\nexport function unzipDependencies(resources, dependency, id) {\n  let returnPackage = { resourceArr: resources, emptyDependencies: [] };\n  return new Promise((resolve) => {\n    https\n      .get(`https://packages.fhir.org/${dependency}/${id}`, function (res) {\n        const extract = tarStream.extract();\n        // Unzip files\n        extract.on('entry', function (header, stream, next) {\n          let buf = '';\n          stream.on('data', function (chunk) {\n            buf += chunk.toString();\n          });\n          stream.on('end', function () {\n            try {\n              const resource = JSON.parse(buf);\n              if (resource.resourceType) {\n                returnPackage.resourceArr.push(resource);\n              }\n            } catch {} //eslint-disable-line no-empty\n            next();\n          });\n          stream.resume();\n        });\n        extract.on('finish', function () {\n          resolve(returnPackage);\n        });\n        if (res.statusCode < 400) {\n          res.pipe(zlib.createGunzip()).pipe(extract);\n          logger.info(`Downloaded ${dependency}#${id}`);\n        } else {\n          if (id === 'current' || id === 'dev') {\n            logger.error(`FSHOnline does not currently support \"current\" or \"dev\" package versions`);\n          } else {\n            logger.error(`Your dependency ${dependency}#${id} could not be loaded. Your output may be invalid.`);\n            returnPackage.emptyDependencies.push(`${dependency}${id}`);\n          }\n          resolve(returnPackage);\n        }\n      })\n      .on('error', (e) => {\n        logger.error('An error occurred while downloading FHIR packages. Your output may be invalid: ', e);\n        returnPackage.emptyDependencies.push(`${dependency}${id}`);\n        resolve(returnPackage);\n      });\n  });\n}\n\nexport function loadDependenciesInStorage(database, resources, dependency, id) {\n  return new Promise((resolve, reject) => {\n    // Loads parsed json into indexDB\n    const transaction = database.transaction([`${dependency}${id}`], 'readwrite');\n    transaction.oncomplete = () => {\n      resolve();\n    };\n    transaction.onerror = (event) => {\n      reject(event);\n    };\n    const objectStore = transaction.objectStore(`${dependency}${id}`, { keyPath: ['id', 'resourceType'] });\n    resources.forEach((res) => {\n      if (res.id && res.resourceType) {\n        objectStore.put(res);\n      }\n    });\n  });\n}\n\nexport function loadAsFHIRDefs(FHIRdefs, database, dependency, id) {\n  // Convert database data into FHIR Definitions\n  return new Promise((resolve, reject) => {\n    let displayLoaded = false;\n    const getData = database\n      .transaction([`${dependency}${id}`], 'readonly')\n      .objectStore(`${dependency}${id}`, { keyPath: ['id', 'resourceType'] })\n      .openCursor();\n    getData.onerror = function () {\n      reject('There is an error getting data out!');\n    };\n    getData.onsuccess = function () {\n      const iterator = getData.result;\n      if (iterator) {\n        displayLoaded = true;\n        FHIRdefs.add(iterator.value);\n        iterator.continue();\n      } else {\n        if (displayLoaded) {\n          logger.info(`Loaded package ${dependency}#${id}`);\n        }\n        resolve(FHIRdefs);\n      }\n    };\n  });\n}\n","import { fhirdefs, sushiImport, utils } from 'fsh-sushi';\nimport { loadAsFHIRDefs, loadDependenciesInStorage, unzipDependencies } from './Load';\nimport { flatten } from 'lodash';\n\nconst logger = utils.logger;\nconst FHIRDefinitions = fhirdefs.FHIRDefinitions;\nconst FSHTank = sushiImport.FSHTank;\nconst importText = sushiImport.importText;\n\nexport function fillTank(rawFSHes, config) {\n  logger.info('Importing FSH text...');\n  const docs = importText(rawFSHes);\n  return new FSHTank(docs, config);\n}\n\nexport async function loadAndCleanDatabase(defs, dependencies) {\n  let helperUpdate = await checkForDatabaseUpgrade(dependencies);\n  let loadExternalDependenciesReturn = { defs, emptyDependencies: [] };\n\n  if (helperUpdate.shouldUpdate) {\n    loadExternalDependenciesReturn = await loadExternalDependencies(defs, helperUpdate.version + 1, dependencies);\n    defs = loadExternalDependenciesReturn.defs;\n  } else {\n    loadExternalDependenciesReturn = await loadExternalDependencies(defs, helperUpdate.version, dependencies);\n    defs = loadExternalDependenciesReturn.defs;\n  }\n\n  // Cleans out database of any empty objectStores\n  await cleanDatabase(loadExternalDependenciesReturn.emptyDependencies, helperUpdate.version + 2);\n  return defs;\n}\n\nexport function cleanDatabase(emptyDependencies, version, databaseName = 'FSH Playground Dependencies') {\n  const mergedEmpties = flatten(emptyDependencies);\n  return new Promise((resolve, reject) => {\n    let database = null;\n    const OpenIDBRequest = indexedDB.open(databaseName, version);\n    OpenIDBRequest.onsuccess = function (event) {\n      database = event.target.result;\n      database.close();\n      resolve();\n    };\n    OpenIDBRequest.onupgradeneeded = async function (event) {\n      database = event.target.result;\n      let existingObjectStores = database.objectStoreNames;\n\n      // Checks existing objectStores to see if any are empty - failsafe for users who previously had blank objectStores created\n      for (let objectStore of existingObjectStores) {\n        await new Promise((resolve) => {\n          let transaction = event.target.transaction;\n          const objStore = transaction.objectStore(`${objectStore}`).getAll();\n          objStore.onsuccess = (event) => {\n            let items = event.target.result;\n            if (items.length === 0 && !mergedEmpties.includes(objectStore)) {\n              mergedEmpties.push(objectStore);\n            }\n            resolve();\n          };\n        });\n      }\n      // Deletes objectStores that are empty\n      for (let i = 0; i < mergedEmpties.length; i++) {\n        if (existingObjectStores.contains(mergedEmpties[i])) {\n          database.deleteObjectStore(mergedEmpties[i]);\n        }\n      }\n    };\n    OpenIDBRequest.onerror = function (event) {\n      reject(event);\n    };\n  });\n}\n\nexport function checkForDatabaseUpgrade(dependencyArr, databaseName = 'FSH Playground Dependencies') {\n  let helperReturn = { shouldUpdate: false, version: 1 };\n  return new Promise((resolve, reject) => {\n    let database = null;\n    const OpenIDBRequest = indexedDB.open(databaseName);\n    OpenIDBRequest.onsuccess = function (event) {\n      database = event.target.result;\n      let existingObjectStores = database.objectStoreNames;\n      helperReturn.version = database.version;\n      if (\n        existingObjectStores.length === 0 ||\n        dependencyArr.length === 0 ||\n        existingObjectStores.contains('resources')\n      ) {\n        helperReturn.shouldUpdate = true;\n        database.close();\n        resolve(helperReturn);\n      } else {\n        for (let i = 0; i < dependencyArr.length; i++) {\n          let dependency = dependencyArr[i][0];\n          let id = dependencyArr[i][1];\n          if (!existingObjectStores.contains(`${dependency}${id}`)) {\n            helperReturn.shouldUpdate = true;\n          }\n        }\n        database.close();\n        resolve(helperReturn);\n      }\n    };\n    OpenIDBRequest.onupgradeneeded = function (event) {\n      database = event.target.result;\n    };\n    OpenIDBRequest.onerror = function (event) {\n      reject(event);\n    };\n  });\n}\n\nexport async function loadExternalDependencies(\n  FHIRdefs,\n  version,\n  dependencyArr,\n  databaseName = 'FSH Playground Dependencies',\n  shouldUnzip = false\n) {\n  return new Promise((resolve, reject) => {\n    let database = null;\n    let newDependencies = [];\n    let returnPackage = { defs: FHIRDefinitions, emptyDependencies: [] };\n    const OpenIDBRequest = indexedDB.open(databaseName, version);\n\n    // If successful the database exists\n    OpenIDBRequest.onsuccess = async function (event) {\n      database = event.target.result;\n      for (let i = 0; i < dependencyArr.length; i++) {\n        let resources = [];\n        shouldUnzip = false;\n        const dependency = dependencyArr[i][0];\n        const id = dependencyArr[i][1];\n        if (newDependencies.includes(`${dependency}${id}`)) {\n          shouldUnzip = true;\n        }\n        if (shouldUnzip) {\n          let unzipReturn = await unzipDependencies(resources, dependency, id);\n          if (unzipReturn.emptyDependencies.length !== 0) {\n            returnPackage.emptyDependencies.push(unzipReturn.emptyDependencies);\n          }\n          await loadDependenciesInStorage(database, unzipReturn.resourceArr, dependency, id);\n        }\n        returnPackage.defs = await loadAsFHIRDefs(FHIRdefs, database, dependency, id);\n      }\n      database.close();\n      resolve(returnPackage);\n    };\n\n    // If upgrade is needed to the version, the database does not yet exist\n    OpenIDBRequest.onupgradeneeded = function (event) {\n      database = event.target.result;\n      let existingObjectStores = database.objectStoreNames;\n      if (existingObjectStores.contains('resources')) {\n        database.deleteObjectStore('resources');\n      }\n      for (let i = 0; i < dependencyArr.length; i++) {\n        const dependency = dependencyArr[i][0];\n        const id = dependencyArr[i][1];\n        if (!existingObjectStores.contains(`${dependency}${id}`)) {\n          database.createObjectStore(`${dependency}${id}`, {\n            keyPath: ['id', 'resourceType']\n          });\n          newDependencies.push(`${dependency}${id}`);\n        }\n      }\n    };\n\n    // Checks if there is an error\n    OpenIDBRequest.onerror = function (event) {\n      reject(event);\n    };\n  });\n}\n","export function sliceDependency(dependencies) {\n  let returnArr = [];\n  const arr = dependencies.split(',');\n  for (let i = 0; i < arr.length; i++) {\n    arr[i] = arr[i].trim();\n    if (arr[i] === '') {\n      continue;\n    }\n    let singleDep = arr[i].split('#');\n    returnArr.push([singleDep[0], singleDep[1]]);\n  }\n  return returnArr;\n}\n","import { findIndex, pad, padStart, padEnd } from 'lodash';\nimport { fhirdefs, sushiExport, sushiImport, utils } from 'fsh-sushi';\nimport { gofshExport, processor, utils as gofshUtils } from 'gofsh';\nimport { fillTank, loadAndCleanDatabase } from './Processing';\nimport { sliceDependency } from './helpers';\n\nconst FSHTank = sushiImport.FSHTank;\nconst RawFSH = sushiImport.RawFSH;\nconst exportFHIR = sushiExport.exportFHIR;\nconst logger = utils.logger;\nconst stats = utils.stats;\nconst getRandomPun = utils.getRandomPun;\nconst Type = utils.Type;\nconst FHIRDefinitions = fhirdefs.FHIRDefinitions;\n\n/**\n * Run GoFSH\n * Note: This function is very similar to FhirToFsh in GoFSH.\n * The only difference is that FSH Online must load dependencies into IndexedDB.\n * If FhirToFsh ever supports a way to load dependencies in the browser,\n * we can update this to simply use that function.\n * @param {array} input array of JSON definitions to be processed\n * @param {object} options config options for GoFSH based on user input and defaults\n * dependencies: user set, defaults to []\n * indent: user set, defaults to false\n * @returns {string} the FSH\n */\nexport async function runGoFSH(input, options) {\n  stats.reset();\n\n  // Read in the resources as strings\n  const docs = [];\n  input.forEach((resource, i) => {\n    const location = `Input_${i}`;\n    try {\n      resource = JSON.parse(resource);\n    } catch (e) {\n      logger.error(`Could not parse ${location} to JSON`);\n      return;\n    }\n    if (gofshUtils.isProcessableContent(resource, location)) {\n      docs.push(new processor.WildFHIR({ content: resource }, location));\n    }\n  });\n\n  // Set up the FHIRProcessor\n  const lake = new processor.LakeOfFHIR(docs);\n  let defs = new FHIRDefinitions();\n  const fisher = new gofshUtils.MasterFisher(lake, defs);\n  const fhirProcessor = new processor.FHIRProcessor(lake, fisher);\n\n  // Process the configuration\n  const goFSHDependencies = options.dependencies.map((d) => d.replace('#', '@')); // GoFSH expects a different format\n  const configuration = fhirProcessor.processConfig(goFSHDependencies ?? []); // The created IG files includes the user specified FHIR Version\n\n  // Load dependencies, including those inferred from an IG file, and those given as input\n  let dependencies = configuration?.config.dependencies\n    ? configuration?.config.dependencies.map((dep) => `${dep.packageId}#${dep.version}`)\n    : [];\n\n  const coreFhirVersion = configuration?.config.fhirVersion ?? '4.0.1';\n  const fhirVersionForDep = `${getCoreFHIRPackageIdentifier(coreFhirVersion)}#${coreFhirVersion}`;\n  if (!dependencies.some((d) => d === fhirVersionForDep)) {\n    dependencies.push(fhirVersionForDep);\n  }\n  dependencies = sliceDependency(dependencies.join(','));\n  defs = await loadAndCleanDatabase(defs, dependencies);\n\n  // Process the FHIR to rules, and then export to FSH\n  const pkg = await gofshUtils.getResources(fhirProcessor, configuration, { indent: options.indent });\n\n  // Return the string of FSH definitions\n  const fsh = new gofshExport.FSHExporter(pkg).apiExport('string');\n  logger.info('Done converting definitions');\n  printGoFSHresults(pkg);\n  return { fsh, config: configuration?.config ?? {} };\n}\n\n/**\n * Load dependencies (FHIR R4) and run SUSHI on provided text\n *\n * @param {string} input - string containing FSH text\n * @param {object} config - Configuration for SUSHI based on user input and defaults\n * config.canonical: user set, defaults to http://example.org\n * config.version: user set, defaults to 1.0.0\n * config.FSHOnly: true\n * config.fhirVersion: [4.0.1] - NOTE fhirVersion array will only have one item in it\n *\n * @returns Package with FHIR resources\n */\nexport async function runSUSHI(input, config, dependencyArr = []) {\n  stats.reset();\n\n  // Load dependencies\n  let defs = new FHIRDefinitions();\n  const coreFHIRVersion = [getCoreFHIRPackageIdentifier(config.fhirVersion[0]), config.fhirVersion[0]];\n  const coreFHIRDependencyIndex = findIndex(\n    dependencyArr,\n    (dep) => dep[0] === coreFHIRVersion[0] && dep[1] === coreFHIRVersion[1]\n  );\n  if (coreFHIRDependencyIndex < 0) {\n    dependencyArr.push(coreFHIRVersion);\n  }\n  defs = await loadAndCleanDatabase(defs, dependencyArr);\n\n  // Load and fill FSH Tank\n  let tank = FSHTank;\n  try {\n    const rawFSH = [new RawFSH(input)];\n    tank = fillTank(rawFSH, config);\n  } catch (e) {\n    logger.error('Something went wrong when importing the FSH definitions');\n    return;\n  }\n\n  // Check for StructureDefinition\n  const structDef = defs.fishForFHIR('StructureDefinition', Type.Resource);\n  if (structDef?.version !== config.fhirVersion[0]) {\n    logger.error(\n      'StructureDefinition resource not found. The FHIR package in the browser cache' +\n        ' may be corrupt. Clear cookies and site data on this webpage to reload the FHIR package.'\n    );\n    return;\n  }\n\n  logger.info('Converting FSH to FHIR resources...');\n  const outPackage = exportFHIR(tank, defs);\n\n  const count =\n    outPackage.profiles.length +\n    outPackage.extensions.length +\n    outPackage.logicals.length +\n    outPackage.resources.length +\n    // Don't count the inline instances that won't have their own JSON output\n    // but do include them in the SUSHI Results box (so don't filter out of outPackage here)\n    outPackage.instances.filter((i) => i._instanceMeta.usage !== 'Inline').length +\n    outPackage.valueSets.length +\n    outPackage.codeSystems.length;\n\n  logger.info(`Exported ${count} FHIR resources as JSON.`);\n\n  console.log(' ');\n  printSUSHIResults(outPackage);\n\n  // Remove snapshots\n  outPackage.profiles = outPackage.profiles.map((p) => p.toJSON(false));\n  outPackage.extensions = outPackage.extensions.map((e) => e.toJSON(false));\n  outPackage.logicals = outPackage.logicals.map((l) => l.toJSON(false));\n  outPackage.resources = outPackage.resources.map((r) => r.toJSON(false));\n\n  // Filter out inline instances\n  outPackage.instances = outPackage.instances.filter((i) => i._instanceMeta.usage !== 'Inline');\n\n  return outPackage;\n}\n\nfunction printSUSHIResults(pkg) {\n  const numError = stats.numError;\n  const numWarn = stats.numWarn;\n  // NOTE: These variables are creatively names to align well in the strings below while keeping prettier happy\n  const profileNum = pad(pkg.profiles.length.toString(), 13);\n  const extentNum = pad(pkg.extensions.length.toString(), 12);\n  const logiclNum = pad(pkg.logicals.length.toString(), 12);\n  const resourcNum = pad(pkg.resources.length.toString(), 13);\n  const valueSetsNumber = pad(pkg.valueSets.length.toString(), 18);\n  const codeSystemsNum = pad(pkg.codeSystems.length.toString(), 17);\n  const instancesNumber = pad(pkg.instances.length.toString(), 18);\n  const errorNumMsg = pad(`${numError} Error${numError !== 1 ? 's' : ''}`, 13);\n  const wrNumMsg = padStart(`${numWarn} Warning${numWarn !== 1 ? 's' : ''}`, 12);\n\n  const aWittyMessageInvolvingABadFishPun = padEnd(getRandomPun(numError, numWarn), 36);\n  const color = numError > 0 ? 'red' : numWarn > 0 ? '#b36200' : 'green'; // eslint-disable-line no-unused-vars\n\n  /* eslint-disable no-useless-concat */\n  // NOTE: Doing some funky things w/ strings on some lines to keep overall alignment in the code\n  const results = [\n    '╔' + '════════════════════════ SUSHI RESULTS ══════════════════════════' + '╗',\n    '║' + ' ╭───────────────┬──────────────┬──────────────┬───────────────╮ ' + '║',\n    '║' + ' │    Profiles   │  Extensions  │   Logicals   │   Resources   │ ' + '║',\n    '║' + ' ├───────────────┼──────────────┼──────────────┼───────────────┤ ' + '║',\n    '║' + ` │ ${profileNum} │ ${extentNum} │ ${logiclNum} │ ${resourcNum} │ ` + '║',\n    '║' + ' ╰───────────────┴──────────────┴──────────────┴───────────────╯ ' + '║',\n    '║' + ' ╭────────────────────┬───────────────────┬────────────────────╮ ' + '║',\n    '║' + ' │      ValueSets     │    CodeSystems    │     Instances      │ ' + '║',\n    '║' + ' ├────────────────────┼───────────────────┼────────────────────┤ ' + '║',\n    '║' + ` │ ${valueSetsNumber} │ ${codeSystemsNum} │ ${instancesNumber} │ ` + '║',\n    '║' + ' ╰────────────────────┴───────────────────┴────────────────────╯ ' + '║',\n    '║' + '                                                                 ' + '║',\n    '╠' + '═════════════════════════════════════════════════════════════════' + '╣',\n    '║' + ` ${aWittyMessageInvolvingABadFishPun} ${errorNumMsg} ${wrNumMsg} ` + '║',\n    '╚' + '═════════════════════════════════════════════════════════════════' + '╝'\n  ];\n  results.forEach((r) => console.log(r));\n  // results.forEach((r) => console.log(`%c${r}`, `color:${clr}`)); // Color formatting for browser console\n}\n\nfunction printGoFSHresults(pkg) {\n  const proNum = pad(pkg.profiles.length.toString(), 18);\n  const extNum = pad(pkg.extensions.length.toString(), 17);\n  const logNum = pad(pkg.logicals.length.toString(), 18);\n  const resNum = pad(pkg.resources.length.toString(), 18);\n  const vsNum = pad(pkg.valueSets.length.toString(), 17);\n  const csNum = pad(pkg.codeSystems.length.toString(), 18);\n  const instNum = pad(pkg.instances.length.toString(), 18);\n  const invNum = pad(pkg.invariants.length.toString(), 17);\n  const mapNum = pad(pkg.mappings.length.toString(), 18);\n  const errNumMsg = pad(`${stats.numError} Error${stats.numError !== 1 ? 's' : ''}`, 12);\n  const wrnNumMsg = padStart(`${stats.numWarn} Warning${stats.numWarn !== 1 ? 's' : ''}`, 12);\n  const aWittyMessageInvolvingABadFishPun = padEnd(getRandomPun(stats.numError, stats.numWarn), 37);\n\n  // prettier-ignore\n  const results = [\n    '╔' + '═════════════════════════ GoFSH RESULTS ═════════════════════════' + '╗',\n    '║' + ' ╭────────────────────┬───────────────────┬────────────────────╮ ' + '║',\n    '║' + ' │      Profiles      │    Extensions     │      Logicals      │ ' + '║',\n    '║' + ' ├────────────────────┼───────────────────┼────────────────────┤ ' + '║',\n    '║' + ` │ ${    proNum     } │ ${    extNum    } │ ${    logNum     } │ ` + '║',\n    '║' + ' ╰────────────────────┴───────────────────┴────────────────────╯ ' + '║',\n    '║' + ' ╭────────────────────┬───────────────────┬────────────────────╮ ' + '║',\n    '║' + ' │     Resources      │     ValueSets     │     CodeSystems    │ ' + '║',\n    '║' + ' ├────────────────────┼───────────────────┼────────────────────┤ ' + '║',\n    '║' + ` │ ${    resNum     } │ ${    vsNum     } │ ${     csNum     } │ ` + '║',\n    '║' + ' ╰────────────────────┴───────────────────┴────────────────────╯ ' + '║',\n    '║' + ' ╭────────────────────┬───────────────────┬────────────────────╮ ' + '║',\n    '║' + ' │     Instances      │    Invariants     │      Mappings      │ ' + '║',\n    '║' + ' ├────────────────────┼───────────────────┼────────────────────┤ ' + '║',\n    '║' + ` │ ${    instNum    } │ ${    invNum    } │ ${    mapNum     } │ ` + '║',\n    '║' + ' ╰────────────────────┴───────────────────┴────────────────────╯ ' + '║',\n    '║' + '                                                                 ' + '║',\n    '╠' + '═════════════════════════════════════════════════════════════════' + '╣',\n    '║' + ` ${aWittyMessageInvolvingABadFishPun } ${errNumMsg} ${wrnNumMsg} ` + '║',\n    '╚' + '═════════════════════════════════════════════════════════════════' + '╝'\n  ];\n\n  console.log(' ');\n  results.forEach((r) => console.log(r));\n}\n\nexport function getCoreFHIRPackageIdentifier(fhirVersion) {\n  if (/^4\\.0\\.1$/.test(fhirVersion)) {\n    return `hl7.fhir.r4.core`;\n  } else if (/^4\\.3.\\d+$/.test(fhirVersion)) {\n    return `hl7.fhir.r4b.core`;\n  } else if (/^5\\.0.\\d+$/.test(fhirVersion)) {\n    return `hl7.fhir.r5.core`;\n  } else {\n    return `hl7.fhir.r4.core`;\n  }\n}\n","import React, { useState, useEffect } from 'react';\nimport clsx from 'clsx';\nimport { makeStyles } from '@material-ui/core/styles';\nimport {\n  AssignmentOutlined as AssignmentOutlinedIcon,\n  ChevronRight as ChevronRightIcon,\n  ExpandMore as ExpandMoreIcon,\n  LibraryBooks as LibraryBooksIcon,\n  PlayArrow,\n  SaveAlt,\n  Settings\n} from '@material-ui/icons';\nimport {\n  Box,\n  Button,\n  Checkbox,\n  CircularProgress,\n  Dialog,\n  DialogActions,\n  DialogContent,\n  DialogContentText,\n  DialogTitle,\n  FormControlLabel,\n  FormHelperText,\n  Grid,\n  MenuItem,\n  Tooltip,\n  TextField\n} from '@material-ui/core';\nimport { runSUSHI, runGoFSH } from '../utils/FSHHelpers';\nimport { sliceDependency } from '../utils/helpers';\nimport { TreeView, TreeItem } from '@material-ui/lab';\nimport CodeMirrorComponent from './CodeMirrorComponent';\n\nconst useStyles = makeStyles((theme) => ({\n  box: {\n    padding: theme.spacing(1),\n    color: theme.palette.text.primary,\n    background: theme.palette.background.paper,\n    display: 'flex;',\n    alignItems: 'center',\n    justifyContent: 'center'\n  },\n  rightControls: {\n    position: 'absolute',\n    right: '24px'\n  },\n  leftControls: {\n    position: 'absolute',\n    left: '28px'\n  },\n  secondaryButton: {\n    color: theme.palette.success.main,\n    '&:hover': {\n      background: theme.palette.common.lighterBlue\n    }\n  },\n  progressContainer: {\n    width: '24px',\n    height: '24px'\n  },\n  progress: {\n    height: '1em !important',\n    width: '1em !important',\n    verticalAlign: 'middle',\n    color: theme.palette.common.white\n  },\n  button: {\n    color: theme.palette.common.white,\n    background: theme.palette.success.main,\n    borderRadius: '0',\n    paddingRight: '15px',\n    paddingLeft: '15px',\n    '&:hover': {\n      background: theme.palette.success.dark\n    }\n  },\n  buttonLeft: {\n    float: 'right',\n    left: '-3.33px'\n  },\n  buttonRight: {\n    float: 'left',\n    right: '-0.67px'\n  },\n  runIcon: {\n    padding: '0px'\n  },\n  dialogPaper: {\n    maxHeight: '80vh',\n    minHeight: '80vh'\n  }\n}));\n\nfunction replacer(key, value) {\n  if (key === 'config') {\n    return undefined;\n  }\n  return value;\n}\n\nexport default function FSHControls(props) {\n  const classes = useStyles();\n  const [openExamples, setOpenExamples] = useState(false);\n  const [openConfig, setOpenConfig] = useState(false);\n  const [canonical, setCanonical] = useState('');\n  const [version, setVersion] = useState('');\n  const [fhirVersion, setFhirVersion] = useState('');\n  const [dependencies, setDependencies] = useState('');\n  const [isGoFSHIndented, setIsGoFSHIndented] = useState(false);\n  const [isSUSHIRunning, setIsSUSHIRunning] = useState(false);\n  const [isGoFSHRunning, setIsGoFSHRunning] = useState(false);\n  const [isFetchingExample, setIsFetchingExample] = useState(false);\n  const [currentExample, setCurrentExample] = useState('');\n  const [currentExampleName, setCurrentExampleName] = useState('');\n\n  useEffect(() => {\n    setCanonical(props.config?.canonical || '');\n    setVersion(props.config?.version || '');\n    setFhirVersion(props.config?.fhirVersion?.length > 0 ? props.config.fhirVersion.at(0) : '');\n    setDependencies(props.config?.dependencies || '');\n  }, [props.config]);\n\n  const handleOpenExamples = () => {\n    setOpenExamples(true);\n  };\n\n  const handleCloseExamples = () => {\n    setOpenExamples(false);\n    setCurrentExample('');\n  };\n\n  const handleOpenConfig = () => {\n    setOpenConfig(true);\n  };\n\n  const handleCloseConfig = () => {\n    setOpenConfig(false);\n    props.onConfigChange({ canonical, version, fhirVersion: [fhirVersion], dependencies, isGoFSHIndented });\n  };\n\n  const updateCanonical = (event) => {\n    const newCanonical = event.target.value;\n    setCanonical(newCanonical);\n  };\n\n  const updateVersion = (event) => {\n    const newVersion = event.target.value;\n    setVersion(newVersion);\n  };\n\n  const updateFhirVersion = (event) => {\n    const newFhirVersion = event.target.value;\n    setFhirVersion(newFhirVersion);\n  };\n\n  const updateDependencyString = (event) => {\n    const dependencyString = event.target.value;\n    setDependencies(dependencyString);\n  };\n\n  const updateIsGoFSHIndented = (event) => {\n    const isIndented = event.target.checked;\n    setIsGoFSHIndented(isIndented);\n  };\n\n  async function handleSUSHIClick() {\n    if (props.isWaiting) {\n      // If SUSHI or GoFSH is in the middle of processes, don't do anything\n      return;\n    }\n\n    props.resetLogMessages();\n    props.onSUSHIClick(true, [''], true);\n    setIsSUSHIRunning(true);\n    const dependencyArr = sliceDependency(dependencies);\n    const config = {\n      canonical: canonical ? canonical : 'http://example.org',\n      version: version ? version : '1.0.0',\n      FSHOnly: true,\n      fhirVersion: fhirVersion ? [fhirVersion] : ['4.0.1']\n    };\n    const outPackage = await runSUSHI(props.fshText, config, dependencyArr);\n    let jsonOutput = JSON.stringify(outPackage, replacer, 2);\n    if (outPackage && outPackage.codeSystems) {\n      if (\n        !outPackage.codeSystems.length &&\n        !outPackage.extensions.length &&\n        !outPackage.instances.length &&\n        !outPackage.profiles.length &&\n        !outPackage.logicals.length &&\n        !outPackage.resources.length &&\n        !outPackage.valueSets.length\n      ) {\n        jsonOutput = [''];\n      }\n    } else {\n      jsonOutput = [''];\n    }\n\n    props.onSUSHIClick(true, jsonOutput, false);\n    setIsSUSHIRunning(false);\n  }\n\n  async function handleGoFSHClick() {\n    if (props.isWaiting) {\n      // If SUSHI or GoFSH is in the middle of processes, don't do anything\n      return;\n    }\n\n    props.resetLogMessages();\n    props.onGoFSHClick('', true);\n    setIsGoFSHRunning(true);\n    const gofshInputStrings = props.gofshText.map((def) => def.def).filter((d) => d);\n    const parsedDependencies = dependencies === '' ? [] : dependencies.split(',');\n\n    // Create small ImplementationGuide resource to send canonical and version information\n    if (canonical || version || fhirVersion !== '') {\n      const igResource = {\n        resourceType: 'ImplementationGuide',\n        fhirVersion: fhirVersion ? [fhirVersion] : ['4.0.1'],\n        id: '1',\n        ...(canonical && { url: `${canonical}/ImplementationGuide/1` }),\n        ...(version && { version: version })\n      };\n      gofshInputStrings.push(JSON.stringify(igResource, null, 2));\n    }\n\n    const options = { dependencies: parsedDependencies, indent: isGoFSHIndented };\n    const { fsh, config } = await runGoFSH(gofshInputStrings, options);\n    props.onGoFSHClick(fsh, false);\n    setIsGoFSHRunning(false);\n    if (canonical === '' && config.canonical) setCanonical(config.canonical);\n    if (version === '' && config.version) setVersion(config.version);\n    if (fhirVersion === '' && config.fhirVersion) setFhirVersion(config.fhirVersion.at(0));\n  }\n\n  async function fetchExampleFSH(event, value) {\n    if (!value.endsWith('.fsh')) return;\n    const exampleMetadata = props.exampleMetadata[value];\n    setIsFetchingExample(true);\n    setCurrentExampleName(exampleMetadata.name);\n    const utf8Decoder = new TextDecoder('utf-8');\n    let responseReader = await fetch(exampleMetadata.path).then((response) => response.body.getReader());\n    let fshString = '';\n    const { value: chunk } = await responseReader.read();\n    fshString += utf8Decoder.decode(chunk);\n    setIsFetchingExample(false);\n    setCurrentExample(fshString);\n  }\n\n  function updateExampleValue(text) {\n    setCurrentExample(text);\n  }\n\n  function handleCopyToClipboard() {\n    navigator.clipboard.writeText(currentExample);\n  }\n\n  const renderItem = (node) => (\n    <Tooltip\n      key={node.id}\n      title={\n        props.exampleMetadata[node.id] && props.exampleMetadata[node.id].description\n          ? props.exampleMetadata[node.id].description\n          : node.name\n      }\n      placement=\"bottom\"\n      arrow\n    >\n      <TreeItem key={node.id} nodeId={node.id} label={node.name} className={classes.treeItem}></TreeItem>\n    </Tooltip>\n  );\n\n  const renderTree = (nodes) => (\n    <TreeItem key={nodes.id} nodeId={nodes.id} label={nodes.name}>\n      {nodes.children ? nodes.children.map((node) => (node.children ? renderTree(node) : renderItem(node))) : null}\n    </TreeItem>\n  );\n\n  return (\n    <Box className={classes.box}>\n      <Grid container>\n        <Grid item xs={5}>\n          <Button className={clsx(classes.button, classes.buttonLeft)} onClick={handleSUSHIClick} testid=\"Button\">\n            Convert to JSON\n            {isSUSHIRunning ? (\n              <div className={classes.progressContainer}>\n                <CircularProgress className={classes.progress} />\n              </div>\n            ) : (\n              <PlayArrow className={classes.runIcon} />\n            )}\n          </Button>\n        </Grid>\n        <Grid item xs={7}>\n          <Button\n            className={clsx(classes.button, classes.buttonRight)}\n            onClick={handleGoFSHClick}\n            testid=\"GoFSH-button\"\n          >\n            {isGoFSHRunning ? (\n              <div className={classes.progressContainer}>\n                <CircularProgress className={classes.progress} />\n              </div>\n            ) : (\n              <PlayArrow className={classes.runIcon} style={{ transform: 'scaleX(-1)' }} />\n            )}\n            Convert to FSH\n          </Button>\n        </Grid>\n      </Grid>\n\n      <div className={classes.leftControls}>\n        <Button name=\"Examples\" className={classes.button} onClick={handleOpenExamples}>\n          <LibraryBooksIcon /> &nbsp; FSH Examples\n        </Button>\n      </div>\n\n      <div className={classes.rightControls}>\n        <Button name=\"SaveAll\" className={classes.secondaryButton} onClick={props.saveAll}>\n          <SaveAlt /> Save All\n        </Button>\n        <Button name=\"Configuration\" className={classes.secondaryButton} onClick={handleOpenConfig}>\n          <Settings /> Configuration\n        </Button>\n      </div>\n\n      <Dialog open={openConfig} onClose={handleCloseConfig} aria-labelledby=\"form-dialog-title\">\n        <DialogTitle id=\"form-dialog-title\">Configuration Settings</DialogTitle>\n        <DialogContent>\n          <DialogContentText>\n            Change the Implementation Guide configuration to use when processing FSH and FHIR JSON\n          </DialogContentText>\n          <TextField\n            id=\"canonical\"\n            margin=\"dense\"\n            fullWidth\n            label=\"Canonical URL\"\n            helperText=\"Default: http://example.org\"\n            defaultValue={canonical}\n            onChange={updateCanonical}\n          />\n          <TextField\n            id=\"version\"\n            margin=\"dense\"\n            fullWidth\n            label=\"Version\"\n            helperText=\"Default: 1.0.0\"\n            defaultValue={version}\n            onChange={updateVersion}\n          />\n          <TextField\n            id=\"fhir-version-select\"\n            margin=\"dense\"\n            fullWidth\n            select\n            label=\"FHIR Version\"\n            helperText=\"Default: 4.0.1 (R4)\"\n            value={fhirVersion}\n            onChange={updateFhirVersion}\n          >\n            <MenuItem value={'4.0.1'}>4.0.1 (R4)</MenuItem>\n            <MenuItem value={'4.3.0'}>4.3.0 (R4B)</MenuItem>\n          </TextField>\n          <TextField\n            id=\"dependencies\"\n            margin=\"dense\"\n            fullWidth\n            label=\"Dependencies\"\n            helperText=\"Format: packageId#version, packageId#version (e.g., hl7.fhir.us.core#5.0.1)\"\n            defaultValue={dependencies}\n            onChange={updateDependencyString}\n          />\n          <FormControlLabel\n            id=\"goFSHIndent\"\n            margin=\"dense\"\n            control={<Checkbox checked={isGoFSHIndented} color=\"primary\" />}\n            label=\"Indent output of Convert to FSH\"\n            onChange={updateIsGoFSHIndented}\n          />\n          <FormHelperText>If set, Convert to FSH will output FSH using path rules</FormHelperText>\n        </DialogContent>\n        <DialogActions>\n          <Button onClick={handleCloseConfig} color=\"primary\">\n            Done\n          </Button>\n        </DialogActions>\n      </Dialog>\n      <Dialog\n        open={openExamples}\n        onClose={handleCloseExamples}\n        aria-labelledby=\"form-dialog-title\"\n        maxWidth=\"lg\"\n        fullWidth\n        scroll=\"paper\"\n        classes={{ paper: classes.dialogPaper }}\n      >\n        <DialogTitle id=\"form-dialog-title\">FSH Examples</DialogTitle>\n        <DialogContent>\n          <Grid container style={{ overflow: 'scroll', minHeight: '64vh' }}>\n            <Grid item xs={4}>\n              <TreeView\n                className={classes.treeView}\n                defaultCollapseIcon={<ExpandMoreIcon />}\n                defaultExpandIcon={<ChevronRightIcon />}\n                onNodeSelect={fetchExampleFSH}\n              >\n                {props.exampleConfig.map((category) => renderTree(category))}\n              </TreeView>\n            </Grid>\n            <Grid item xs={8}>\n              <CodeMirrorComponent\n                name={currentExample ? currentExampleName : ''}\n                isExamples={true}\n                value={currentExample}\n                initialText={currentExample}\n                updateTextValue={updateExampleValue}\n                mode={'fsh'}\n                placeholder={isFetchingExample ? 'Fetching example...' : 'Select an example'}\n              />\n            </Grid>\n          </Grid>\n        </DialogContent>\n        <DialogActions>\n          <Button onClick={handleCopyToClipboard} color=\"primary\">\n            <AssignmentOutlinedIcon></AssignmentOutlinedIcon> Copy to clipboard\n          </Button>\n          <Button onClick={handleCloseExamples} color=\"secondary\">\n            Close\n          </Button>\n        </DialogActions>\n      </Dialog>\n    </Box>\n  );\n}\n","export default __webpack_public_path__ + \"static/media/FSH-online-logo.1322e272.png\";","import React from 'react';\nimport { makeStyles } from '@material-ui/core/styles';\nimport { AppBar, Toolbar, Button, Typography, Box } from '@material-ui/core';\nimport { StylesProvider } from '@material-ui/core/styles';\nimport { ExitToApp } from '@material-ui/icons';\nimport logo from '../style/FSH-online-logo.png';\n\nconst useStyles = makeStyles((theme) => ({\n  root: {\n    background: theme.palette.common.blue,\n    position: 'static',\n    boxShadow: '0'\n  },\n  title: {\n    fontSize: 20,\n    fontWeight: 700\n  },\n  logo: {\n    height: '55px',\n    width: '63px'\n  },\n  toolbarBox: {\n    alignItems: 'center'\n  },\n  exitIcon: {\n    paddingLeft: '3px',\n    transform: 'scaleX(-1)'\n  },\n  docButton: {\n    color: theme.palette.common.white,\n    backgroundColor: theme.palette.common.blue,\n    fontSize: '0.875rem',\n    fontWeight: 700,\n    '&:hover': {\n      background: theme.palette.common.lightBlue\n    }\n  },\n  versionText: {\n    color: theme.palette.common.white,\n    fontSize: '0.8rem',\n    fontStyle: 'italic',\n    marginTop: '-5px'\n  }\n}));\n\nexport default function TopBar() {\n  const classes = useStyles();\n  return (\n    <AppBar className={classes.root}>\n      <Toolbar>\n        <Box className={classes.toolbarBox} display=\"flex\" flexGrow={1} flexDirection=\"row\">\n          <Box order={1} display=\"flex\" flexGrow={1} flexDirection=\"row\">\n            <Box order={1} alignSelf=\"center\" display=\"flex\">\n              <img src={logo} alt=\"logo\" className={classes.logo} />\n            </Box>\n            <Box order={2} alignSelf=\"center\" m={1}>\n              <StylesProvider injectFirst>\n                <Typography order={1} className={classes.title}>\n                  FSH ONLINE\n                </Typography>\n                <Typography order={2} className={classes.versionText}>\n                  Powered by SUSHI v2.10.1 and GoFSH v1.6.5\n                </Typography>\n              </StylesProvider>\n            </Box>\n          </Box>\n          <Box order={1}>\n            <StylesProvider injectFirst>\n              <Button className={classes.docButton} href=\"https://fshschool.org/\" target=\"_blank\">\n                <ExitToApp className={classes.exitIcon} fontSize=\"small\" />\n                Back to School\n              </Button>\n            </StylesProvider>\n          </Box>\n        </Box>\n      </Toolbar>\n    </AppBar>\n  );\n}\n"],"sourceRoot":""}
{"version":3,"sources":["../node_modules/gofsh/dist/optimizer sync /^.*$","utils/AppRouter.js","serviceWorker.js","index.js","App.js","utils/BitlyWorker.js","components/DeleteConfirmationModal.js","components/ShareLink.js","components/CodeMirrorComponent.js","components/TopBar.js","style/FSH-online-logo.png","components/JSONOutput.js","components/FSHOutput.js","components/ConsoleComponent.js","utils/Load.js","utils/Processing.js","utils/helpers.js","utils/FSHHelpers.js","components/FSHControls.js"],"names":["map","webpackContext","req","id","webpackContextResolve","__webpack_require__","o","e","Error","code","keys","Object","resolve","module","exports","AppRouter","props","path","component","App","exact","Boolean","window","location","hostname","match","ReactDOM","render","StrictMode","basename","document","getElementById","navigator","serviceWorker","ready","then","registration","unregister","catch","error","console","message","useStyles","makeStyles","theme","container","height","flexGrow","fullHeightGrid","collapsedMain","width","expandedMain","collapsedConsole","expandedConsole","top","colors","lighterBlue","lightBlue","blue","darkerBlue","editorGrey","lightestGrey","lightGrey","grey","darkerGrey","darkestGrey","red","createMuiTheme","palette","success","main","dark","light","common","typography","fontFamily","overrides","MuiTooltip","tooltip","backgroundColor","fontSize","arrow","color","MuiButton","text","textTransform","fontWeight","MuiIconButton","root","consoleMessages","log","errorString","warningString","errorCount","warningCount","decodeFSH","encodedFSH","a","undefined","expandLink","promisedURL","sliced64","long_url","slice","includes","length","displayText","inflateSync","Buffer","from","toString","push","startsWith","ExpandedConsoleContext","createContext","classes","text64","params","useState","showNewFHIRText","setShowNewFHIRText","inputFSHText","setInputFSHText","inputFHIRText","setInputFHIRText","initialText","setInitialText","isWaitingForFHIROutput","setIsWaitingForFHIROutput","isWaitingForFSHOutput","setIsWaitingForFSHOutput","expandConsole","setExpandConsole","useEffect","waitForFSH","className","style","onSUSHIClick","showNewText","sushiOutput","isWaiting","onGoFSHClick","fshOutput","fshText","gofshText","resetLogMessages","Provider","value","item","xs","paddingRight","updateTextValue","paddingLeft","setShowNewText","bitly","BitlyClient","require","process","generateLink","longLink","Promise","shorten","result","link","errorNeeded","encodedFsh","bitlyURL","expand","DeleteConfirmationModal","open","isOpen","onClose","handleCloseModal","aria-labelledby","title","onClick","autoFocus","handleDelete","iconButton","white","padding","textArea","primary","ShareLink","openShare","setOpenShare","openShareError","setOpenShareError","copied","copyButton","setCopied","setLink","handleOpenShare","encoded","deflateSync","shareText","bitlyLink","handleOpenShareError","bitlySlice","displayLink","handleCloseShare","handleCloseShareError","Tooltip","placement","IconButton","name","Link","transform","Dialog","maxWidth","fullWidth","DialogTitle","DialogContent","DialogContentText","TextareaAutosize","disabled","label","defaultValue","onChange","event","newLink","target","DialogActions","onCopy","Button","CodeMirror","defineSimpleMode","meta","lineComment","start","regex","token","next","comment","box","header","background","display","justifyContent","transition","transitions","create","easing","sharp","duration","leavingScreen","headerShift","easeOut","enteringScreen","marginRight","headerLabel","lineHeight","float","whiteSpace","overflow","textOverflow","headerActionGroup","headerActions","alignItems","drawer","flexShrink","drawerPaper","border","drawerPaperExpandedConsole","drawerHeader","minHeight","drawerHeaderIcon","borderRadius","minWidth","content","contentShift","CodeMirrorComponent","expandedConsoleContext","useContext","drawerOpen","setDrawerOpen","handleDrawerOpen","handleDrawerClose","renderActionIcon","Icon","upperFirst","aria-label","Box","clsx","renderDrawer","mode","copy","FileCopy","save","SaveAlt","delete","Delete","ChevronLeft","options","placeholder","scrollbarStyle","autoCloseBrackets","lineNumbers","foldGutter","gutters","extraKeys","cm","foldCode","getCursor","editor","data","Drawer","data-testid","variant","anchor","paper","ChevronRight","position","boxShadow","logo","toolbarBox","exitIcon","docButton","versionText","fontStyle","marginTop","TopBar","flexDirection","order","alignSelf","src","alt","m","injectFirst","href","fileTreeContent","overflowY","button","list","paddingBottom","listItemError","paddingTop","margin","listItem","marginBottom","listItemSelected","listHeader","listIcon","verticalAlign","listIconError","blankIcon","JSONOutput","resourceType","def","fhirDefinitions","setFhirDefinitions","propsUpdateText","currentDef","setCurrentDef","defsWithErrors","setDefsWithErrors","openDeleteConfirmation","setOpenDeleteConfirmation","isEqual","packageJSON","JSON","parse","profiles","extensions","instances","valueSets","codeSystems","iterablePackage","defsPackage","stringify","addDefinition","updatedDefs","handleCloseAndDelete","index","splice","newCurrentDef","newCurrentDefText","newErrors","indexOf","shiftedErrors","i","handleCloseDeleteConfirmation","displayValue","latestJSON","startIcon","grouped","groupBy","val","sort","b","key","aId","bId","toLowerCase","currentIndex","isError","renderFileTreeView","defToDelete","type","renderDeleteModal","FSHOutput","openDeleteModal","setOpenDeleteModal","handleOpenDeleteModal","consoleControls","boxSizing","expandIcon","warning","pre","Console","logger","utils","unzipDependencies","resources","dependency","returnPackage","resourceArr","emptyDependencies","http","get","res","extract","tarStream","on","stream","buf","chunk","resource","resume","statusCode","pipe","zlib","createGunzip","info","loadDependenciesInStorage","database","reject","transaction","oncomplete","onerror","objectStore","keyPath","forEach","put","loadAsFHIRDefs","FHIRdefs","displayLoaded","getData","openCursor","onsuccess","iterator","add","continue","FHIRDefinitions","fhirdefs","FSHTank","sushiImport","importText","fillTank","rawFSHes","config","docs","loadAndCleanDatabase","defs","dependencies","checkForDatabaseUpgrade","helperUpdate","loadExternalDependenciesReturn","shouldUpdate","loadExternalDependencies","version","cleanDatabase","databaseName","mergedEmpties","flatten","OpenIDBRequest","indexedDB","close","onupgradeneeded","existingObjectStores","objectStoreNames","getAll","contains","deleteObjectStore","dependencyArr","helperReturn","shouldUnzip","newDependencies","findIndex","elem","unzipReturn","createObjectStore","sliceDependency","returnArr","arr","split","trim","singleDep","RawFSH","exportFHIR","sushiExport","stats","getRandomPun","Type","getRandomSeaCreatures","gofshUtils","getRandomSeaCreaturesStat","runGoFSH","input","reset","isProcessableContent","processor","WildFHIR","lake","LakeOfFHIR","fisher","MasterFisher","fhirProcessor","FHIRProcessor","configuration","processConfig","dep","packageId","join","getResources","pkg","fsh","gofshExport","FSHExporter","apiExport","printGoFSHresults","runSUSHI","tank","rawFSH","structDef","fishForFHIR","Resource","outPackage","printSUSHIResults","p","toJSON","numError","numWarn","prNum","pad","extnNum","vstNum","cdsysNum","insNum","errorNumMsg","wrNumMsg","padStart","aWittyMessageInvolvingABadFishPun","padEnd","r","proNum","extNum","vsNum","csNum","instNum","invNum","invariants","mapNum","mappings","errNumMsg","wrnNumMsg","creatures","creatrStat","results","spacing","rightControls","right","secondaryButton","progressContainer","progress","buttonLeft","runIcon","replacer","FSHControls","openConfig","setOpenConfig","canonical","setCanonical","setVersion","setDependencies","isSUSHIRunning","setIsSUSHIRunning","isGoFSHRunning","setIsGoFSHRunning","handleCloseConfig","FSHOnly","fhirVersion","jsonOutput","gofshInputStrings","filter","d","parsedDependencies","igResource","url","Grid","testid","CircularProgress","PlayArrow","Settings","TextField","helperText","newCanonical","newVersion","dependencyString"],"mappings":"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","file":"static/js/main.d9055206.chunk.js","sourcesContent":["var map = {\n\t\".\": 196,\n\t\"./\": 196,\n\t\"./OptimizerPlugin\": 359,\n\t\"./OptimizerPlugin.d.ts\": 1332,\n\t\"./OptimizerPlugin.js\": 359,\n\t\"./index\": 196,\n\t\"./index.d.ts\": 1333,\n\t\"./index.js\": 196,\n\t\"./loadOptimizers\": 358,\n\t\"./loadOptimizers.d.ts\": 1334,\n\t\"./loadOptimizers.js\": 358,\n\t\"./plugins\": 253,\n\t\"./plugins/\": 253,\n\t\"./plugins/AddReferenceKeywordOptimizer\": 254,\n\t\"./plugins/AddReferenceKeywordOptimizer.d.ts\": 1335,\n\t\"./plugins/AddReferenceKeywordOptimizer.js\": 254,\n\t\"./plugins/CombineCardAndFlagRulesOptimizer\": 360,\n\t\"./plugins/CombineCardAndFlagRulesOptimizer.d.ts\": 1336,\n\t\"./plugins/CombineCardAndFlagRulesOptimizer.js\": 360,\n\t\"./plugins/CombineCodingAndQuantityValuesOptimizer\": 256,\n\t\"./plugins/CombineCodingAndQuantityValuesOptimizer.d.ts\": 1337,\n\t\"./plugins/CombineCodingAndQuantityValuesOptimizer.js\": 256,\n\t\"./plugins/CombineContainsRulesOptimizer\": 361,\n\t\"./plugins/CombineContainsRulesOptimizer.d.ts\": 1338,\n\t\"./plugins/CombineContainsRulesOptimizer.js\": 361,\n\t\"./plugins/ConstructInlineInstanceOptimizer\": 362,\n\t\"./plugins/ConstructInlineInstanceOptimizer.d.ts\": 1339,\n\t\"./plugins/ConstructInlineInstanceOptimizer.js\": 362,\n\t\"./plugins/ConstructNamedExtensionContainsRulesOptimizer\": 257,\n\t\"./plugins/ConstructNamedExtensionContainsRulesOptimizer.d.ts\": 1340,\n\t\"./plugins/ConstructNamedExtensionContainsRulesOptimizer.js\": 257,\n\t\"./plugins/RemoveChoiceSlicingRulesOptimizer\": 363,\n\t\"./plugins/RemoveChoiceSlicingRulesOptimizer.d.ts\": 1341,\n\t\"./plugins/RemoveChoiceSlicingRulesOptimizer.js\": 363,\n\t\"./plugins/RemoveDefaultExtensionContextRulesOptimizer\": 364,\n\t\"./plugins/RemoveDefaultExtensionContextRulesOptimizer.d.ts\": 1342,\n\t\"./plugins/RemoveDefaultExtensionContextRulesOptimizer.js\": 364,\n\t\"./plugins/RemoveExtensionSlicingRulesOptimizer\": 365,\n\t\"./plugins/RemoveExtensionSlicingRulesOptimizer.d.ts\": 1343,\n\t\"./plugins/RemoveExtensionSlicingRulesOptimizer.js\": 365,\n\t\"./plugins/RemoveExtensionURLAssignmentRules\": 366,\n\t\"./plugins/RemoveExtensionURLAssignmentRules.d.ts\": 1344,\n\t\"./plugins/RemoveExtensionURLAssignmentRules.js\": 366,\n\t\"./plugins/RemoveGeneratedTextRulesOptimizer\": 197,\n\t\"./plugins/RemoveGeneratedTextRulesOptimizer.d.ts\": 1345,\n\t\"./plugins/RemoveGeneratedTextRulesOptimizer.js\": 197,\n\t\"./plugins/RemoveImpliedZeroZeroCardRulesOptimizer\": 255,\n\t\"./plugins/RemoveImpliedZeroZeroCardRulesOptimizer.d.ts\": 1346,\n\t\"./plugins/RemoveImpliedZeroZeroCardRulesOptimizer.js\": 255,\n\t\"./plugins/RemovePublisherDerivedDateRulesOptimizer\": 367,\n\t\"./plugins/RemovePublisherDerivedDateRulesOptimizer.d.ts\": 1347,\n\t\"./plugins/RemovePublisherDerivedDateRulesOptimizer.js\": 367,\n\t\"./plugins/ResolveBindingRuleURLsOptimizer\": 368,\n\t\"./plugins/ResolveBindingRuleURLsOptimizer.d.ts\": 1348,\n\t\"./plugins/ResolveBindingRuleURLsOptimizer.js\": 368,\n\t\"./plugins/ResolveInstanceOfURLsOptimizer\": 198,\n\t\"./plugins/ResolveInstanceOfURLsOptimizer.d.ts\": 1349,\n\t\"./plugins/ResolveInstanceOfURLsOptimizer.js\": 198,\n\t\"./plugins/ResolveOnlyRuleURLsOptimizer\": 258,\n\t\"./plugins/ResolveOnlyRuleURLsOptimizer.d.ts\": 1350,\n\t\"./plugins/ResolveOnlyRuleURLsOptimizer.js\": 258,\n\t\"./plugins/ResolveParentURLsOptimizer\": 369,\n\t\"./plugins/ResolveParentURLsOptimizer.d.ts\": 1351,\n\t\"./plugins/ResolveParentURLsOptimizer.js\": 369,\n\t\"./plugins/ResolveReferenceAssignmentsOptimizer\": 370,\n\t\"./plugins/ResolveReferenceAssignmentsOptimizer.d.ts\": 1352,\n\t\"./plugins/ResolveReferenceAssignmentsOptimizer.js\": 370,\n\t\"./plugins/ResolveValueRuleURLsOptimizer\": 371,\n\t\"./plugins/ResolveValueRuleURLsOptimizer.d.ts\": 1353,\n\t\"./plugins/ResolveValueRuleURLsOptimizer.js\": 371,\n\t\"./plugins/ResolveValueSetComponentRuleURLsOptimizer\": 372,\n\t\"./plugins/ResolveValueSetComponentRuleURLsOptimizer.d.ts\": 1354,\n\t\"./plugins/ResolveValueSetComponentRuleURLsOptimizer.js\": 372,\n\t\"./plugins/SimplifyArrayIndexingOptimizer\": 373,\n\t\"./plugins/SimplifyArrayIndexingOptimizer.d.ts\": 1355,\n\t\"./plugins/SimplifyArrayIndexingOptimizer.js\": 373,\n\t\"./plugins/SimplifyInstanceNameOptimizer\": 374,\n\t\"./plugins/SimplifyInstanceNameOptimizer.d.ts\": 1356,\n\t\"./plugins/SimplifyInstanceNameOptimizer.js\": 374,\n\t\"./plugins/SimplifyMappingNamesOptimizer\": 375,\n\t\"./plugins/SimplifyMappingNamesOptimizer.d.ts\": 1357,\n\t\"./plugins/SimplifyMappingNamesOptimizer.js\": 375,\n\t\"./plugins/index\": 253,\n\t\"./plugins/index.d.ts\": 1358,\n\t\"./plugins/index.js\": 253,\n\t\"./utils\": 125,\n\t\"./utils.d.ts\": 1359,\n\t\"./utils.js\": 125\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 1331;","import React from 'react';\nimport { Route, Switch } from 'react-router-dom';\nimport App from '../App';\n\nexport default function AppRouter(props) {\n  return (\n    <Switch>\n      <Route path=\"/share/:text\" component={App} />\n      <Route path=\"\" exact component={App} />\n    </Switch>\n  );\n}\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(/^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/)\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then((registration) => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch((error) => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then((response) => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (response.status === 404 || (contentType != null && contentType.indexOf('javascript') === -1)) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then((registration) => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log('No internet connection found. App is running in offline mode.');\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then((registration) => {\n        registration.unregister();\n      })\n      .catch((error) => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport AppRouter from './utils/AppRouter';\nimport * as serviceWorker from './serviceWorker';\nimport { HashRouter } from 'react-router-dom';\n\nReactDOM.render(\n  <React.StrictMode>\n    <HashRouter basename=\"/\">\n      <AppRouter />\n    </HashRouter>\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n","import React, { createContext, useState, useEffect } from 'react';\nimport { inflateSync } from 'browserify-zlib';\nimport { createMuiTheme, makeStyles } from '@material-ui/core/styles';\nimport { Grid, ThemeProvider } from '@material-ui/core';\nimport { expandLink } from './utils/BitlyWorker';\nimport TopBar from './components/TopBar';\nimport JSONOutput from './components/JSONOutput';\nimport FSHOutput from './components/FSHOutput';\nimport ConsoleComponent from './components/ConsoleComponent';\nimport FSHControls from './components/FSHControls';\n\nconst useStyles = makeStyles((theme) => ({\n  container: {\n    height: '100%',\n    flexGrow: 1\n  },\n  fullHeightGrid: {\n    height: '100%'\n  },\n  collapsedMain: {\n    width: '100%',\n    height: 'calc(100vh - 116px - 300px)'\n  },\n  expandedMain: {\n    width: '100%',\n    height: 'calc(100vh - 116px - 34px)'\n  },\n  collapsedConsole: {\n    height: '25px',\n    width: '100%'\n  },\n  expandedConsole: {\n    height: '300px',\n    width: '100%'\n  },\n  top: {\n    height: '116px'\n  }\n}));\n\nconst colors = {\n  lighterBlue: '#D8E2EA',\n  lightBlue: '#487AA2',\n  blue: '#30638e',\n  darkerBlue: '#143E61',\n  editorGrey: '#263238',\n  lightestGrey: '#E7ECEE',\n  lightGrey: '#D0D9DD',\n  grey: '#575B5C',\n  darkerGrey: '#3D4345',\n  darkestGrey: '#121D21',\n  red: '#FD6668'\n};\n\nconst theme = createMuiTheme({\n  palette: {\n    success: {\n      main: colors.blue,\n      dark: colors.darkerBlue,\n      light: colors.lightBlue\n    },\n    common: colors\n  },\n  typography: {\n    fontFamily: 'Open Sans'\n  },\n  overrides: {\n    MuiTooltip: {\n      tooltip: {\n        backgroundColor: colors.darkestGrey,\n        fontSize: '13px'\n      },\n      arrow: {\n        color: colors.darkestGrey\n      }\n    },\n    MuiButton: {\n      text: {\n        textTransform: 'none',\n        fontWeight: 600\n      }\n    },\n    MuiIconButton: {\n      root: {\n        '&:hover': {\n          backgroundColor: colors.grey\n        }\n      }\n    }\n  }\n});\n\nconst log = console.log; //eslint-disable-line no-unused-vars\nlet consoleMessages = [];\nlet errorString = '';\nlet warningString = '';\nlet errorCount = 0;\nlet warningCount = 0;\nconsole.log = function getMessages(message) {\n  consoleMessages.push(message);\n  if (message && (message.startsWith('error') || message.startsWith('warn'))) {\n    if (message.startsWith('error')) errorCount++;\n    else warningCount++;\n  }\n  if (errorCount > 0) {\n    errorString = `${errorCount} Error`;\n    if (errorCount !== 1) errorString += 's';\n  }\n  if (warningCount > 0) {\n    warningString = `${warningCount} Warning`;\n    if (warningCount !== 1) warningString += 's';\n  }\n};\n\nexport async function decodeFSH(encodedFSH) {\n  if (encodedFSH.text === undefined) {\n    return '';\n  } else {\n    const promisedURL = await expandLink(encodedFSH);\n\n    // Removes the encoded data from the end of the url, starting at index 38\n    const sliced64 = promisedURL.long_url.slice(40);\n    if (!promisedURL.long_url.includes('https://fshschool.org/FSHOnline/#/share/') || sliced64.length === 0) {\n      return '';\n    } else {\n      const displayText = inflateSync(Buffer.from(sliced64, 'base64')).toString('utf-8');\n      return displayText;\n    }\n  }\n}\n\nexport const ExpandedConsoleContext = createContext(false);\n\nexport default function App(props) {\n  const classes = useStyles();\n  const text64 = props.match.params;\n  const [showNewFHIRText, setShowNewFHIRText] = useState(false);\n  const [inputFSHText, setInputFSHText] = useState('');\n  const [inputFHIRText, setInputFHIRText] = useState(['']);\n  const [initialText, setInitialText] = useState('');\n  const [isWaitingForFHIROutput, setIsWaitingForFHIROutput] = useState(false);\n  const [isWaitingForFSHOutput, setIsWaitingForFSHOutput] = useState(false);\n  const [expandConsole, setExpandConsole] = useState(false);\n\n  useEffect(() => {\n    async function waitForFSH() {\n      setInitialText(await decodeFSH(text64));\n    }\n    waitForFSH();\n  }, [text64]);\n\n  function resetLogMessages() {\n    consoleMessages = [];\n    errorString = '';\n    warningString = '';\n    errorCount = 0;\n    warningCount = 0;\n  }\n\n  function handleSUSHIControls(showNewText, sushiOutput, isWaiting) {\n    setShowNewFHIRText(showNewText);\n    setInputFHIRText(sushiOutput); // JSONOutput component handles resetting initial text, so don't reset here\n    setIsWaitingForFHIROutput(isWaiting);\n  }\n\n  function handleGoFSHControls(fshOutput, isWaiting) {\n    setIsWaitingForFSHOutput(isWaiting);\n    setInitialText(fshOutput === '' ? null : fshOutput); // Reset initial text to null if empty in order to display placeholder text\n  }\n\n  function updateInputFSHTextValue(text) {\n    // This is a bit of a hack to make sure the editor can be reset by a setInitialText(null)\n    if (initialText === '' || initialText === null) {\n      setInitialText(text);\n    }\n    setInputFSHText(text);\n  }\n\n  function updateInputFHIRTextValue(text) {\n    setInputFHIRText(text);\n  }\n\n  return (\n    <ThemeProvider theme={theme}>\n      <div className=\"root\" style={{ height: '100vh' }}>\n        <div className={classes.top}>\n          <TopBar />\n          <FSHControls\n            onSUSHIClick={handleSUSHIControls}\n            onGoFSHClick={handleGoFSHControls}\n            fshText={inputFSHText}\n            gofshText={inputFHIRText}\n            resetLogMessages={resetLogMessages}\n            isWaiting={isWaitingForFSHOutput || isWaitingForFHIROutput}\n          />\n        </div>\n        <div className={expandConsole ? classes.collapsedMain : classes.expandedMain}>\n          <ExpandedConsoleContext.Provider value={expandConsole}>\n            <Grid className={classes.container} container>\n              <Grid item xs={5} className={classes.fullHeightGrid} style={{ paddingRight: '1px' }}>\n                <FSHOutput\n                  text={inputFSHText}\n                  initialText={initialText}\n                  updateTextValue={updateInputFSHTextValue}\n                  isWaiting={isWaitingForFSHOutput}\n                  setInitialText={setInitialText}\n                />\n              </Grid>\n              <Grid item xs={7} className={classes.fullHeightGrid} style={{ paddingLeft: '1px' }}>\n                <JSONOutput\n                  text={inputFHIRText}\n                  showNewText={showNewFHIRText}\n                  setShowNewText={setShowNewFHIRText}\n                  isWaiting={isWaitingForFHIROutput}\n                  updateTextValue={updateInputFHIRTextValue}\n                />\n              </Grid>\n            </Grid>\n          </ExpandedConsoleContext.Provider>\n        </div>\n        <div className={expandConsole ? classes.expandedConsole : classes.collapsedConsole}>\n          <ConsoleComponent\n            consoleMessages={consoleMessages}\n            warningCount={warningString}\n            errorCount={errorString}\n            expandConsole={expandConsole}\n            setExpandConsole={setExpandConsole}\n          />\n        </div>\n      </div>\n    </ThemeProvider>\n  );\n}\n","const BitlyClient = require('bitly').BitlyClient;\nconst bitly = new BitlyClient(process.env.REACT_APP_BITLY_KEY);\n\nexport async function generateLink(longLink) {\n  return new Promise((resolve) => {\n    bitly\n      .shorten(longLink)\n      .then(function (result) {\n        resolve({ link: result.link, errorNeeded: false });\n      })\n      .catch(function (error) {\n        if (process.env.REACT_APP_BITLY_KEY == null) {\n          console.error(\n            'Error: REACT_APP_BITLY_KEY needs to be set as an environment variable in order to share FSH Online links.'\n          );\n          resolve({ link: undefined, errorNeeded: true });\n        } else {\n          resolve({ link: undefined, errorNeeded: true });\n        }\n      });\n  });\n}\n\nexport async function expandLink(encodedFsh) {\n  const bitlyURL = `https://bit.ly/${encodedFsh.text}`;\n  return new Promise((resolve) => {\n    bitly\n      .expand(bitlyURL)\n      .then(function (result) {\n        resolve(result);\n      })\n      .catch(function (error) {\n        console.error(error);\n      });\n  });\n}\n","import React from 'react';\nimport { Button, Dialog, DialogActions, DialogContent, DialogContentText, DialogTitle } from '@material-ui/core';\n\nexport default function DeleteConfirmationModal(props) {\n  return (\n    <Dialog open={props.isOpen} onClose={props.handleCloseModal} aria-labelledby=\"delete-confirmation-dialog\">\n      <DialogTitle id=\"delete-confirmation-dialog-title\">Delete {props.title}</DialogTitle>\n      <DialogContent>\n        <DialogContentText>\n          Are you sure you want to delete {props.item}? This action cannot be undone.\n        </DialogContentText>\n      </DialogContent>\n      <DialogActions>\n        <Button onClick={props.handleCloseModal} color=\"primary\" autoFocus>\n          Cancel\n        </Button>\n        <Button onClick={props.handleDelete} color=\"secondary\">\n          Delete\n        </Button>\n      </DialogActions>\n    </Dialog>\n  );\n}\n","import React, { useState } from 'react';\nimport { deflateSync } from 'browserify-zlib';\nimport { CopyToClipboard } from 'react-copy-to-clipboard';\nimport { makeStyles } from '@material-ui/core/styles';\nimport { Link } from '@material-ui/icons';\nimport {\n  Button,\n  Dialog,\n  DialogActions,\n  DialogContent,\n  DialogContentText,\n  DialogTitle,\n  IconButton,\n  TextareaAutosize,\n  Tooltip\n} from '@material-ui/core';\nimport { generateLink } from '../utils/BitlyWorker';\n\nconst useStyles = makeStyles((theme) => ({\n  iconButton: {\n    color: theme.palette.common.white,\n    padding: '3px'\n  },\n  textArea: {\n    width: '100%',\n    color: theme.palette.text.primary,\n    fontWeight: 'bold'\n  }\n}));\n\nexport default function ShareLink(props) {\n  const classes = useStyles();\n  const [openShare, setOpenShare] = useState(false);\n  const [openShareError, setOpenShareError] = useState(false);\n  const [{ copied, copyButton }, setCopied] = useState({ copied: false, copyButton: 'Copy to Clipboard' });\n  const [link, setLink] = useState();\n\n  const updateLink = (event) => {\n    const newLink = event.target.value;\n    setLink(newLink);\n  };\n\n  const handleOpenShare = async () => {\n    const encoded = deflateSync(props.shareText).toString('base64');\n    const longLink = `https://fshschool.org/FSHOnline/#/share/${encoded}`;\n    const bitlyLink = await generateLink(longLink);\n    if (bitlyLink.errorNeeded === true) {\n      handleOpenShareError();\n    } else {\n      // Removes the encoded data from the end of the url, starting at index 15\n      const bitlySlice = bitlyLink.link.slice(15);\n      const displayLink = `https://fshschool.org/FSHOnline/#/share/${bitlySlice}`;\n      setLink(displayLink);\n      setOpenShare(true);\n      setCopied({ copied: false, copyButton: 'Copy to Clipboard' });\n    }\n  };\n\n  const handleCloseShare = () => {\n    setOpenShare(false);\n  };\n\n  const handleOpenShareError = () => {\n    setOpenShareError(true);\n  };\n\n  const handleCloseShareError = () => {\n    setOpenShareError(false);\n  };\n\n  return (\n    <>\n      <Tooltip title=\"Share FSH\" placement=\"top\" arrow>\n        <IconButton name=\"Share FSH\" className={classes.iconButton} onClick={handleOpenShare}>\n          <Link fontSize=\"small\" style={{ transform: 'rotate(-45deg)' }} />\n        </IconButton>\n      </Tooltip>\n      <Dialog open={openShare} onClose={handleCloseShare} aria-labelledby=\"form-dialog-title\" maxWidth=\"sm\" fullWidth>\n        <DialogTitle id=\"form-dialog-title\">Share</DialogTitle>\n        <DialogContent>\n          <DialogContentText>Use this link to share your FSH with others!</DialogContentText>\n          <TextareaAutosize\n            id=\"link\"\n            disabled\n            label=\"Your Link\"\n            defaultValue={link}\n            onChange={updateLink}\n            className={classes.textArea}\n          ></TextareaAutosize>\n        </DialogContent>\n        <DialogActions>\n          <CopyToClipboard text={link} onCopy={() => setCopied({ copied: true, copyButton: 'Link Copied' })}>\n            <Button color={copied ? 'secondary' : 'primary'}>{copyButton}</Button>\n          </CopyToClipboard>\n          <Button onClick={handleCloseShare} color=\"primary\">\n            Done\n          </Button>\n        </DialogActions>\n      </Dialog>\n      <Dialog open={openShareError} onClose={handleCloseShareError} aria-labelledby=\"alert-dialog-title\" maxWidth=\"lg\">\n        <DialogTitle id=\"alert-dialog-title\">Share Error</DialogTitle>\n        <DialogContent>\n          <DialogContentText>There was a problem sharing your FSH. Your FSH file may be too long.</DialogContentText>\n        </DialogContent>\n        <DialogActions>\n          <Button onClick={handleCloseShareError} color=\"primary\" autoFocus>\n            Keep Swimming!\n          </Button>\n        </DialogActions>\n      </Dialog>\n    </>\n  );\n}\n","import React, { useState, useContext } from 'react';\nimport clsx from 'clsx';\nimport { upperFirst } from 'lodash';\nimport { Button, Box, Drawer, IconButton, Tooltip } from '@material-ui/core';\nimport { ChevronLeft, ChevronRight, Delete, FileCopy, SaveAlt } from '@material-ui/icons';\nimport { UnControlled as ReactCodeMirror } from 'react-codemirror2';\nimport { makeStyles } from '@material-ui/core/styles';\nimport CodeMirror from 'codemirror';\nimport { ExpandedConsoleContext } from '../App';\nimport ShareLink from './ShareLink';\nimport '../style/CodeMirrorComponent.css';\nimport 'codemirror/lib/codemirror.css';\nimport 'codemirror/theme/material.css';\nimport 'codemirror/addon/fold/foldgutter.css';\nimport 'codemirror/addon/scroll/simplescrollbars.css';\nrequire('codemirror/addon/mode/simple');\nrequire('codemirror/addon/edit/closebrackets');\nrequire('codemirror/addon/display/placeholder');\nrequire('codemirror/addon/comment/comment');\nrequire('codemirror/addon/fold/foldgutter');\nrequire('codemirror/addon/fold/brace-fold');\nrequire('codemirror/mode/xml/xml');\nrequire('codemirror/mode/javascript/javascript');\nrequire('codemirror/addon/scroll/simplescrollbars');\n\n// Define FSH syntax highlighting\n// Regular expressions from https://github.com/standardhealth/vscode-language-fsh/blob/master/syntaxes/fsh.tmLanguage.json\nCodeMirror.defineSimpleMode('fsh', {\n  meta: {\n    lineComment: '//'\n  },\n  start: [\n    // The regex matches the token, the token property contains the type\n    {\n      regex: /\"(?:[^\\\\]|\\\\.)*?(?:\"|$)/,\n      token: 'atom'\n    },\n    {\n      regex: /\\b(Alias|CodeSystem|Expression|Extension|Description|Id|Instance|InstanceOf|Invariant|Mapping|Mixins|Parent|Profile|RuleSet|Severity|Source|Target|Title|Usage|ValueSet|XPath)(?=\\s*:)\\b/,\n      token: 'keyword'\n    },\n    {\n      // NOTE: Original regex has (?<=\\s) at start and (?=\\s) at the end. However, there are known shortcomings with look ahead/look behind with the simple mode approach\n      regex: /\\b(and|codes|contains|descendent-of|exclude|exists|from|generalizes|include|in|insert|is-a|is-not-a|named|not-in|obeys|only|or|regex|system|units|valueset|where|D|MS|N|SU|TU|\\\\?!)\\b/,\n      token: 'def'\n    },\n    {\n      regex: /(\\(\\s*)(exactly|example|extensible|preferred|required)(\\s*\\))/,\n      token: 'def'\n    },\n    {\n      regex: /\\*|->|=|:/,\n      token: 'def'\n    },\n    {\n      regex: /\\b(https?:\\/\\/(www\\.)?[-a-zA-Z0-9@:%._+~#=]{2,256}\\.[a-z]{2,6}\\b([-a-zA-Z0-9@:%_+.~#?&//=]*))\\b/,\n      token: 'atom'\n    },\n    {\n      regex: /\\b(true|false)\\b/,\n      token: 'string'\n    },\n    {\n      regex: /#[^\\s]*/,\n      token: 'string'\n    },\n    { regex: /\\/\\/.*/, token: 'comment' },\n    { regex: /\\/\\*/, token: 'comment', next: 'comment' }\n  ],\n  comment: [\n    { regex: /.*?\\*\\//, token: 'comment', next: 'start' },\n    { regex: /.*/, token: 'comment' }\n  ]\n});\n\nconst drawerWidth = 200;\n\nconst useStyles = makeStyles((theme) => ({\n  box: {\n    height: '100%'\n  },\n  header: {\n    fontFamily: 'Open Sans',\n    color: theme.palette.common.white,\n    background: theme.palette.common.darkerGrey,\n    padding: '0px',\n    paddingLeft: '29px', // width of code mirror gutter\n    height: '34px', // 24px + 10px of padding is total height\n    display: 'flex',\n    justifyContent: 'space-between',\n    transition: theme.transitions.create(['margin', 'width'], {\n      easing: theme.transitions.easing.sharp,\n      duration: theme.transitions.duration.leavingScreen\n    })\n  },\n  headerShift: {\n    width: `calc(100% - ${drawerWidth}px - 29px)`,\n    transition: theme.transitions.create(['margin', 'width'], {\n      easing: theme.transitions.easing.easeOut,\n      duration: theme.transitions.duration.enteringScreen\n    }),\n    marginRight: drawerWidth\n  },\n  headerLabel: {\n    lineHeight: '34px',\n    float: 'left',\n\n    // Ellipse for long resource ids\n    whiteSpace: 'nowrap',\n    overflow: 'hidden',\n    textOverflow: 'ellipsis'\n  },\n  headerActionGroup: {\n    paddingRight: '10px'\n  },\n  headerActions: {\n    alignItems: 'center',\n    display: 'flex'\n  },\n  iconButton: {\n    color: theme.palette.common.white,\n    padding: '3px'\n  },\n  drawer: {\n    width: drawerWidth,\n    flexShrink: 0\n  },\n  drawerPaper: {\n    width: drawerWidth,\n    border: 'none',\n    // necessary for content to be TopBar and in line with editor\n    height: 'calc(100vh - 116px - 34px)',\n    top: '116px'\n  },\n  drawerPaperExpandedConsole: {\n    height: 'calc(100vh - 116px - 300px)'\n  },\n  drawerHeader: {\n    display: 'flex',\n    alignItems: 'center',\n    justifyContent: 'flex-start',\n    // Color to match header\n    color: theme.palette.common.white,\n    background: theme.palette.common.darkerGrey,\n    height: '34px', // Same height as headers on CodeMirror editors\n    minHeight: '34px'\n  },\n  drawerHeaderIcon: {\n    padding: '0px',\n    color: theme.palette.common.white,\n    background: theme.palette.success.main,\n    '&:hover': {\n      background: theme.palette.success.light\n    },\n    borderRadius: 0,\n    height: '100%',\n    width: '34px',\n    minWidth: '34px' // width and minWidth match the height so button is a square\n  },\n  content: {\n    flexGrow: 1,\n    width: '100%',\n    transition: theme.transitions.create(['margin', 'width'], {\n      easing: theme.transitions.easing.sharp,\n      duration: theme.transitions.duration.leavingScreen\n    })\n  },\n  contentShift: {\n    width: `calc(100% - ${drawerWidth}px)`,\n    transition: theme.transitions.create(['margin', 'width'], {\n      easing: theme.transitions.easing.easeOut,\n      duration: theme.transitions.duration.enteringScreen\n    }),\n    marginRight: 0\n  }\n}));\n\nexport default function CodeMirrorComponent(props) {\n  const classes = useStyles();\n  const expandedConsoleContext = useContext(ExpandedConsoleContext);\n  const [drawerOpen, setDrawerOpen] = useState(true);\n\n  const handleDrawerOpen = () => {\n    setDrawerOpen(true);\n  };\n\n  const handleDrawerClose = () => {\n    setDrawerOpen(false);\n  };\n\n  //Updates both the text state with the codemirror value\n  function updateText(text) {\n    props.updateTextValue(text);\n  }\n\n  const renderActionIcon = (Icon, label, onClick, style = {}) => {\n    return (\n      <Tooltip title={upperFirst(label)} placement=\"top\" arrow>\n        <IconButton name={label} className={classes.iconButton} aria-label={label} onClick={onClick}>\n          <Icon fontSize=\"small\" style={style} />\n        </IconButton>\n      </Tooltip>\n    );\n  };\n\n  const renderActionIcons = () => {\n    // Render only specified actions\n    return (\n      <div className={classes.headerActions}>\n        <div className={classes.headerActionGroup}>\n          {props.mode === 'fsh' && <ShareLink shareText={props.value} />}\n          {props.copy && renderActionIcon(FileCopy, 'copy', () => {})}\n          {props.save && renderActionIcon(SaveAlt, 'save', () => {})}\n          {props.delete && renderActionIcon(Delete, 'delete', props.delete)}\n        </div>\n        {props.renderDrawer && !drawerOpen && (\n          <IconButton name=\"expand\" className={classes.drawerHeaderIcon} aria-label=\"expand\" onClick={handleDrawerOpen}>\n            <ChevronLeft />\n          </IconButton>\n        )}\n      </div>\n    );\n  };\n\n  const renderDrawer = () => {\n    return (\n      <Drawer\n        className={classes.drawer}\n        data-testid={'editor-drawer'}\n        variant=\"persistent\"\n        anchor=\"right\"\n        open={drawerOpen}\n        classes={{\n          paper: clsx(classes.drawerPaper, expandedConsoleContext && classes.drawerPaperExpandedConsole)\n        }}\n      >\n        <div className={classes.drawerHeader}>\n          <Button\n            name=\"collapse\"\n            aria-label=\"collapse\"\n            className={classes.drawerHeaderIcon}\n            onClick={handleDrawerClose}\n          >\n            <ChevronRight />\n          </Button>\n        </div>\n        {props.renderDrawer()}\n      </Drawer>\n    );\n  };\n\n  return (\n    <Box className={classes.box}>\n      <div\n        className={clsx(classes.header, {\n          [classes.headerShift]: props.renderDrawer && drawerOpen\n        })}\n      >\n        <div title={props.name} className={classes.headerLabel}>\n          {props.name}\n        </div>\n        {renderActionIcons()}\n      </div>\n      <ReactCodeMirror\n        className={clsx('react-codemirror2', props.renderDrawer && classes.content, {\n          [classes.contentShift]: props.renderDrawer && drawerOpen\n        })}\n        value={props.initialText}\n        options={{\n          mode: props.mode,\n          theme: 'material',\n          placeholder: props.placeholder,\n          scrollbarStyle: 'overlay',\n          autoCloseBrackets: true,\n          lineNumbers: true,\n          foldGutter: true,\n          gutters: ['CodeMirror-linenumbers', 'CodeMirror-foldgutter'],\n          extraKeys: {\n            'Ctrl-/': 'toggleComment',\n            'Cmd-/': 'toggleComment',\n            'Ctrl-Q': (cm) => {\n              cm.foldCode(cm.getCursor());\n            }\n          }\n        }}\n        onChange={(editor, data, value) => {\n          updateText(value);\n        }}\n      />\n      {props.renderDrawer && renderDrawer()}\n    </Box>\n  );\n}\n","import React from 'react';\nimport { makeStyles } from '@material-ui/core/styles';\nimport { AppBar, Toolbar, Button, Typography, Box } from '@material-ui/core';\nimport { StylesProvider } from '@material-ui/core/styles';\nimport { ExitToApp } from '@material-ui/icons';\nimport logo from '../style/FSH-online-logo.png';\n\nconst useStyles = makeStyles((theme) => ({\n  root: {\n    background: theme.palette.common.blue,\n    position: 'static',\n    boxShadow: '0'\n  },\n  title: {\n    fontSize: 20,\n    fontWeight: 700\n  },\n  logo: {\n    height: '55px',\n    width: '63px'\n  },\n  toolbarBox: {\n    alignItems: 'center'\n  },\n  exitIcon: {\n    paddingLeft: '3px',\n    transform: 'scaleX(-1)'\n  },\n  docButton: {\n    color: theme.palette.common.white,\n    backgroundColor: theme.palette.common.blue,\n    fontSize: '0.875rem',\n    fontWeight: 700,\n    '&:hover': {\n      background: theme.palette.common.lightBlue\n    }\n  },\n  versionText: {\n    color: theme.palette.common.white,\n    fontSize: '0.8rem',\n    fontStyle: 'italic',\n    marginTop: '-5px'\n  }\n}));\n\nexport default function TopBar() {\n  const classes = useStyles();\n  return (\n    <AppBar className={classes.root}>\n      <Toolbar>\n        <Box className={classes.toolbarBox} display=\"flex\" flexGrow={1} flexDirection=\"row\">\n          <Box order={1} display=\"flex\" flexGrow={1} flexDirection=\"row\">\n            <Box order={1} alignSelf=\"center\" display=\"flex\">\n              <img src={logo} alt=\"logo\" className={classes.logo} />\n            </Box>\n            <Box order={2} alignSelf=\"center\" m={1}>\n              <StylesProvider injectFirst>\n                <Typography order={1} className={classes.title}>\n                  FSH ONLINE\n                </Typography>\n                <Typography order={2} className={classes.versionText}>\n                  Powered by SUSHI v1.3.2 and GoFSH v1.1.0\n                </Typography>\n              </StylesProvider>\n            </Box>\n          </Box>\n          <Box order={1}>\n            <StylesProvider injectFirst>\n              <Button className={classes.docButton} href=\"https://fshschool.org/\" target=\"_blank\">\n                <ExitToApp className={classes.exitIcon} fontSize=\"small\" />\n                Back to School\n              </Button>\n            </StylesProvider>\n          </Box>\n        </Box>\n      </Toolbar>\n    </AppBar>\n  );\n}\n","module.exports = __webpack_public_path__ + \"static/media/FSH-online-logo.b1d95e04.png\";","import React, { useState, useEffect } from 'react';\nimport { groupBy, isEqual } from 'lodash';\nimport { makeStyles } from '@material-ui/core/styles';\nimport clsx from 'clsx';\nimport { Button, List, ListItem, Tooltip } from '@material-ui/core';\nimport { Add, ErrorOutline } from '@material-ui/icons';\nimport CodeMirrorComponent from './CodeMirrorComponent';\nimport DeleteConfirmationModal from './DeleteConfirmationModal';\n\nconst useStyles = makeStyles((theme) => ({\n  fileTreeContent: {\n    overflowY: 'scroll',\n    height: '100%'\n  },\n  button: {\n    color: theme.palette.common.white,\n    background: theme.palette.success.main,\n    '&:hover': {\n      background: theme.palette.success.dark\n    },\n    border: '8px solid white',\n    fontSize: '13px',\n    width: '100%'\n  },\n  list: {\n    padding: '8px',\n    paddingLeft: '0px',\n    paddingBottom: '0px',\n    fontSize: '13px'\n  },\n  listItemError: {\n    paddingTop: '5px',\n    paddingBottom: '5px',\n    margin: 0\n  },\n  listItem: {\n    background: theme.palette.common.lightestGrey,\n    paddingTop: '5px',\n    paddingBottom: '5px',\n    marginTop: '5px',\n    marginBottom: '5px',\n    paddingLeft: '5px',\n    // paddingRight is driven by ListItem (16px)\n    margin: 0,\n    '&:hover': {\n      background: theme.palette.common.lightGrey\n    },\n\n    // Ellipse for long resource ids\n    display: 'block',\n    whiteSpace: 'nowrap',\n    overflow: 'hidden',\n    textOverflow: 'ellipsis'\n  },\n  listItemSelected: {\n    background: theme.palette.common.editorGrey, // editor background color\n    color: theme.palette.common.white,\n    '&:hover': {\n      background: theme.palette.common.darkestGrey\n    }\n  },\n  listHeader: {\n    padding: '5px',\n    paddingLeft: '15px'\n  },\n  listIcon: {\n    color: theme.palette.success.main,\n    verticalAlign: 'middle',\n    fontSize: '13px',\n    paddingLeft: '3px',\n    paddingRight: '3px'\n  },\n  listIconError: {\n    color: theme.palette.common.red\n  },\n  blankIcon: {\n    paddingLeft: '19px' // width of icon\n  }\n}));\n\n// Flatten the package so we can render and navigate it more easily,\n// but keep high level attributes we'll need accessible\nconst getIterablePackage = (defsPackage) => {\n  const defArray = [\n    ...defsPackage.profiles,\n    ...defsPackage.extensions,\n    ...defsPackage.instances,\n    ...defsPackage.valueSets,\n    ...defsPackage.codeSystems\n  ];\n  return defArray.map((def) => ({ resourceType: def.resourceType, id: def.id, def: JSON.stringify(def, null, 2) }));\n};\n\nexport default function JSONOutput(props) {\n  const classes = useStyles();\n  const [initialText, setInitialText] = useState('');\n  const [fhirDefinitions, setFhirDefinitions] = useState([{ resourceType: null, id: 'Untitled', def: null }]);\n  const { setShowNewText, updateTextValue: propsUpdateText } = props;\n  const [currentDef, setCurrentDef] = useState(0);\n  const [defsWithErrors, setDefsWithErrors] = useState([]);\n  const [openDeleteConfirmation, setOpenDeleteConfirmation] = useState(false);\n\n  useEffect(() => {\n    // This case represents when we receive a new Package from SUSHI\n    if (props.showNewText && !isEqual(props.text, [''])) {\n      setShowNewText(false); // Indicate that we no longer have new data we need to load so we don't come back here too early\n      let packageJSON;\n      try {\n        packageJSON = JSON.parse(props.text);\n      } catch (e) {\n        packageJSON = {\n          profiles: [],\n          extensions: [],\n          instances: [],\n          valueSets: [],\n          codeSystems: []\n        };\n      }\n      const iterablePackage = getIterablePackage(packageJSON);\n      setFhirDefinitions(iterablePackage);\n      setCurrentDef(0);\n      setInitialText(iterablePackage.length > 0 ? iterablePackage[0].def : '');\n      propsUpdateText(iterablePackage); // The value of text kept on props should be the iterable and stringified package\n    } else if (props.isWaiting) {\n      setInitialText(null); // Reset the text to null when loading to reset the editor and display placeholder text\n      setFhirDefinitions([]); // Reset FHIR definitions to clear out file tree\n    }\n  }, [props.text, props.showNewText, props.isWaiting, propsUpdateText, setShowNewText]);\n\n  const updateTextValue = (text) => {\n    // We're waiting for a new package to load, so we don't want the editor to update yet\n    if (props.isWaiting) return;\n\n    // Update the definition we're currently editing\n    const updatedDefs = [...fhirDefinitions];\n\n    // Check if there is a JSON syntax error in the editor\n    try {\n      // If the editor is blank, we want to consider it an empty JSON object so that it is valid JSON\n      const latestJSON = text === '' ? {} : JSON.parse(text);\n      // If there was an error, mark it as resolved\n      if (defsWithErrors.includes(currentDef)) {\n        const newErrors = [...defsWithErrors];\n        newErrors.splice(defsWithErrors.indexOf(currentDef), 1);\n        setDefsWithErrors(newErrors);\n      }\n\n      // If it's new, set metadata (definition text is set below)\n      if (!fhirDefinitions[currentDef]) {\n        updatedDefs[currentDef] = {\n          resourceType: latestJSON.resourceType,\n          id: latestJSON.id ?? 'Untitled'\n        };\n      }\n\n      // Update resource type if it has changed\n      if (!fhirDefinitions[currentDef] || latestJSON.resourceType !== fhirDefinitions[currentDef].resourceType) {\n        updatedDefs[currentDef].resourceType = latestJSON.resourceType;\n      }\n\n      // Update id if it has changed or it is new\n      if (!fhirDefinitions[currentDef] || latestJSON.id !== fhirDefinitions[currentDef].id) {\n        updatedDefs[currentDef].id = latestJSON.id ?? 'Untitled';\n      }\n    } catch (e) {\n      // Invalid JSON typed. Keep track of index.\n      if (!defsWithErrors.includes(currentDef)) {\n        const newErrors = [...defsWithErrors];\n        newErrors.push(currentDef);\n        setDefsWithErrors(newErrors);\n      }\n    }\n\n    // Update the text - regardless if it was valid JSON\n    if (updatedDefs[currentDef]) {\n      updatedDefs[currentDef].def = text;\n    }\n    setFhirDefinitions(updatedDefs);\n    props.updateTextValue(updatedDefs);\n\n    // This is a bit of a hack to make sure the editor can be reset by a setInitialText(null)\n    if (initialText === null) {\n      setInitialText(text);\n    }\n  };\n\n  const addDefinition = () => {\n    const updatedDefs = [...fhirDefinitions];\n    updatedDefs.push({ resourceType: null, id: 'Untitled', def: null });\n    setCurrentDef(updatedDefs.length - 1);\n    setFhirDefinitions(updatedDefs);\n    setInitialText(null);\n    props.updateTextValue(updatedDefs);\n  };\n\n  const handleCloseAndDelete = () => {\n    const index = currentDef;\n    const updatedDefs = [...fhirDefinitions];\n    updatedDefs.splice(index, 1); // Remove definition to be deleted\n    if (updatedDefs.length === 0) {\n      // Ensure list is not empty so there is always a definition in the file tree\n      updatedDefs.push({ resourceType: null, id: 'Untitled', def: null });\n    }\n    setFhirDefinitions(updatedDefs);\n\n    // If we deleted the currently viewed definition or any before it, update it\n    if (index <= currentDef) {\n      let newCurrentDef = 0;\n      if (index < currentDef) {\n        newCurrentDef = currentDef - 1;\n      }\n      setCurrentDef(newCurrentDef);\n      const newCurrentDefText = updatedDefs.length > 0 ? updatedDefs[newCurrentDef].def : null;\n      setInitialText(newCurrentDefText);\n    }\n\n    // Update error tracking\n    const newErrors = [...defsWithErrors];\n    if (defsWithErrors.includes(index)) {\n      // If the definition had an error, remove it from the list\n      newErrors.splice(defsWithErrors.indexOf(index), 1);\n    }\n    // Shift any indices that came after the deleted definition to properly track errors\n    const shiftedErrors = newErrors.map((i) => (i < index ? i : i - 1));\n    setDefsWithErrors(shiftedErrors);\n\n    setOpenDeleteConfirmation(false);\n    props.updateTextValue(updatedDefs);\n  };\n\n  const handleOpenDeleteConfirmation = () => {\n    setOpenDeleteConfirmation(true);\n  };\n\n  const handleCloseDeleteConfirmation = () => {\n    setOpenDeleteConfirmation(false);\n  };\n\n  const renderDeleteModal = () => {\n    const defToDelete = fhirDefinitions[currentDef];\n    if (!defToDelete) {\n      return;\n    }\n    const type = defToDelete.resourceType || 'Instance';\n    const id = defToDelete.id || 'Untitled';\n    return (\n      <DeleteConfirmationModal\n        title={'FHIR JSON'}\n        item={`${type}/${id}`}\n        isOpen={openDeleteConfirmation}\n        handleCloseModal={handleCloseDeleteConfirmation}\n        handleDelete={handleCloseAndDelete}\n      />\n    );\n  };\n\n  const renderFileTreeView = () => {\n    const order = ['StructureDefinitions', 'ValueSets', 'CodeSystems', 'Instances', 'Unknown Type'];\n    const grouped = groupBy(fhirDefinitions, (val) => {\n      if (['StructureDefinition', 'ValueSet', 'CodeSystem'].includes(val?.resourceType)) return `${val.resourceType}s`;\n      if (val?.resourceType != null) return 'Instances';\n      return 'Unknown Type';\n    });\n\n    return Object.keys(grouped)\n      .sort((a, b) => order.indexOf(a) - order.indexOf(b)) // Sort so we keep a defined order of types in the tree\n      .map((key) => {\n        return (\n          <List component=\"nav\" key={key} className={classes.list}>\n            <div className={classes.listHeader}>{key}</div>\n            {grouped[key]\n              .sort((a, b) => {\n                const aId = a.id ? a.id : 'Untitled'; // Treat missing or blank ids as \"Untitled\"\n                const bId = b.id ? b.id : 'Untitled';\n                return aId.toLowerCase() < bId.toLowerCase() ? -1 : aId.toLowerCase() > bId.toLowerCase() ? 1 : 0;\n              }) // Sort ids alphabetically\n              .map((def, i) => {\n                const currentIndex = fhirDefinitions.indexOf(def);\n                const isError = defsWithErrors.includes(currentIndex);\n                return (\n                  <ListItem\n                    button\n                    key={i}\n                    title={def?.id || 'Untitled'}\n                    data-testid={`${key}-defId`}\n                    className={clsx(\n                      classes.listItem,\n                      isError && classes.listItemError,\n                      currentIndex === currentDef && classes.listItemSelected\n                    )}\n                    onClick={() => {\n                      setCurrentDef(currentIndex);\n                      setInitialText(def.def);\n                    }}\n                  >\n                    {defsWithErrors.includes(currentIndex) ? (\n                      <Tooltip title=\"Invalid JSON\" placement=\"top\" arrow>\n                        <ErrorOutline className={clsx(classes.listIcon, classes.listIconError)} />\n                      </Tooltip>\n                    ) : (\n                      <span className={classes.blankIcon} />\n                    )}\n                    {def?.id || 'Untitled'}\n                  </ListItem>\n                );\n              })}\n          </List>\n        );\n      });\n  };\n\n  const renderDrawer = () => {\n    return (\n      <>\n        <Button className={classes.button} startIcon={<Add />} onClick={addDefinition}>\n          New JSON Editor\n        </Button>\n        <div className={classes.fileTreeContent}>{renderFileTreeView()}</div>\n      </>\n    );\n  };\n\n  const displayValue = fhirDefinitions.length > 0 ? fhirDefinitions[currentDef].def : null;\n\n  return (\n    <>\n      <CodeMirrorComponent\n        name={`FHIR JSON: ${fhirDefinitions.length > 0 ? fhirDefinitions[currentDef].id : 'Untitled'}`}\n        value={displayValue}\n        initialText={initialText}\n        updateTextValue={updateTextValue}\n        mode={'application/json'}\n        placeholder={\n          props.isWaiting\n            ? 'Loading...'\n            : 'Paste or edit single FHIR JSON artifact here... \\nCreate additional FHIR JSON artifacts to the right.'\n        }\n        renderDrawer={renderDrawer}\n        delete={handleOpenDeleteConfirmation}\n      />\n      {openDeleteConfirmation && renderDeleteModal()}\n    </>\n  );\n}\n","import React, { useState } from 'react';\nimport CodeMirrorComponent from './CodeMirrorComponent';\nimport DeleteConfirmationModal from './DeleteConfirmationModal';\n\nexport default function FSHOutput(props) {\n  const [openDeleteModal, setOpenDeleteModal] = useState(false);\n\n  const handleOpenDeleteModal = () => {\n    setOpenDeleteModal(!openDeleteModal);\n  };\n\n  const handleCloseAndDelete = () => {\n    setOpenDeleteModal(false);\n    props.setInitialText('');\n  };\n\n  return (\n    <>\n      <CodeMirrorComponent\n        name={'FSH'}\n        value={props.text}\n        initialText={props.initialText}\n        updateTextValue={props.updateTextValue}\n        mode={'fsh'}\n        placeholder={props.isWaiting ? 'Loading...' : 'Paste or edit FSH here...'}\n        delete={handleOpenDeleteModal}\n      />\n      {openDeleteModal && (\n        <DeleteConfirmationModal\n          title={'FHIR Shorthand'}\n          item={'all FSH'}\n          isOpen={openDeleteModal}\n          handleCloseModal={handleOpenDeleteModal}\n          handleDelete={handleCloseAndDelete}\n        />\n      )}\n    </>\n  );\n}\n","import React from 'react';\nimport { makeStyles } from '@material-ui/core/styles';\nimport { Box, Button } from '@material-ui/core';\nimport { ExpandLess, ExpandMore } from '@material-ui/icons';\nimport WarningIcon from '@material-ui/icons/Warning';\nimport ErrorIcon from '@material-ui/icons/Error';\nimport CheckIcon from '@material-ui/icons/Check';\n\nconst useStyles = makeStyles((theme) => ({\n  consoleControls: {\n    background: theme.palette.common.darkestGrey,\n    height: '34px',\n    boxSizing: 'border-box',\n    display: 'flex;',\n    alignItems: 'center',\n    justifyContent: 'left'\n  },\n  box: {\n    paddingLeft: '29px', // Same padding as header of code mirror\n    color: theme.palette.common.white,\n    background: theme.palette.common.darkestGrey,\n    height: 'calc(100% - 34px)',\n    overflow: 'scroll',\n    boxSizing: 'border-box'\n  },\n  button: {\n    padding: 0,\n    color: theme.palette.common.white,\n    textTransform: 'none'\n  },\n  expandIcon: {\n    width: '29px' // Lines up with padding\n  },\n  warning: {\n    paddingRight: '5px',\n    paddingLeft: '20px',\n    color: 'khaki'\n  },\n  error: {\n    paddingRight: '5px',\n    paddingLeft: '20px',\n    color: 'red'\n  },\n  success: {\n    paddingRight: '5px',\n    paddingLeft: '20px',\n    color: 'green'\n  },\n  pre: {\n    margin: '0px'\n  }\n}));\n\nexport default function Console(props) {\n  const classes = useStyles();\n\n  const toggleExpandConsole = () => {\n    props.setExpandConsole(!props.expandConsole);\n  };\n\n  return (\n    <>\n      <Box className={classes.consoleControls}>\n        <Button onClick={toggleExpandConsole} className={classes.button}>\n          {props.expandConsole ? (\n            <ExpandMore className={classes.expandIcon} />\n          ) : (\n            <ExpandLess className={classes.expandIcon} />\n          )}\n          Console\n          <WarningIcon style={{ display: props.warningCount ? 'block' : 'none' }} className={classes.warning} />\n          {props.warningCount ? `${props.warningCount}` : ''}\n          <ErrorIcon style={{ display: props.errorCount ? 'block' : 'none' }} className={classes.error} />\n          {props.errorCount ? `${props.errorCount}` : ''}\n          <CheckIcon\n            className={classes.success}\n            style={{\n              display: props.consoleMessages.length > 0 && !props.warningCount && !props.errorCount ? 'block' : 'none'\n            }}\n          />\n          {props.consoleMessages.length > 0 && !props.warningCount && !props.errorCount ? `Success!` : ''}\n        </Button>\n      </Box>\n      <Box style={{ display: props.expandConsole ? 'block' : 'none' }} className={classes.box}>\n        {props.consoleMessages.map((message, i) => {\n          return (\n            <pre key={i} className={classes.pre}>\n              {message}\n            </pre>\n          );\n        })}\n      </Box>\n    </>\n  );\n}\n","import tarStream from 'tar-stream';\nimport zlib from 'zlib';\nimport http from 'http';\nimport { utils } from 'fsh-sushi';\nconst logger = utils.logger;\n\nexport function unzipDependencies(resources, dependency, id) {\n  let returnPackage = { resourceArr: resources, emptyDependencies: [] };\n  return new Promise((resolve) => {\n    http.get(`https://packages.fhir.org/${dependency}/${id}`, function (res) {\n      const extract = tarStream.extract();\n      // Unzip files\n      extract.on('entry', function (header, stream, next) {\n        let buf = '';\n        stream.on('data', function (chunk) {\n          buf += chunk.toString();\n        });\n        stream.on('end', function () {\n          try {\n            const resource = JSON.parse(buf);\n            if (resource.resourceType) {\n              returnPackage.resourceArr.push(resource);\n            }\n          } catch {} //eslint-disable-line no-empty\n          next();\n        });\n        stream.resume();\n      });\n      extract.on('finish', function () {\n        resolve(returnPackage);\n      });\n      if (res.statusCode < 400) {\n        res.pipe(zlib.createGunzip()).pipe(extract);\n        logger.info(`Downloaded ${dependency}#${id}`);\n      } else {\n        if (id === 'current' || id === 'dev') {\n          logger.error(`FSHOnline does not currently support \"current\" or \"dev\" package versions`);\n        } else {\n          logger.error(`your dependency ${dependency}#${id} could not be loaded. Your output may be invalid.`);\n          returnPackage.emptyDependencies.push(`${dependency}${id}`);\n        }\n        resolve(returnPackage);\n      }\n    });\n  });\n}\n\nexport function loadDependenciesInStorage(database, resources, dependency, id) {\n  return new Promise((resolve, reject) => {\n    // Loads parsed json into indexDB\n    const transaction = database.transaction([`${dependency}${id}`], 'readwrite');\n    transaction.oncomplete = () => {\n      resolve();\n    };\n    transaction.onerror = (event) => {\n      reject(event);\n    };\n    const objectStore = transaction.objectStore(`${dependency}${id}`, { keyPath: ['id', 'resourceType'] });\n    resources.forEach((res) => {\n      objectStore.put(res);\n    });\n  });\n}\n\nexport function loadAsFHIRDefs(FHIRdefs, database, dependency, id) {\n  // Convert database data into FHIR Definitions\n  return new Promise((resolve, reject) => {\n    let displayLoaded = false;\n    const getData = database\n      .transaction([`${dependency}${id}`], 'readonly')\n      .objectStore(`${dependency}${id}`, { keyPath: ['id', 'resourceType'] })\n      .openCursor();\n    getData.onerror = function () {\n      reject('There is an error getting data out!');\n    };\n    getData.onsuccess = function () {\n      const iterator = getData.result;\n      if (iterator) {\n        displayLoaded = true;\n        FHIRdefs.add(iterator.value);\n        iterator.continue();\n      } else {\n        if (displayLoaded) {\n          logger.info(`Loaded package ${dependency}#${id}`);\n        }\n        resolve(FHIRdefs);\n      }\n    };\n  });\n}\n","import { fhirdefs, sushiImport, utils } from 'fsh-sushi';\nimport { loadAsFHIRDefs, loadDependenciesInStorage, unzipDependencies } from './Load';\nimport { findIndex, flatten } from 'lodash';\n\nconst logger = utils.logger;\nconst FHIRDefinitions = fhirdefs.FHIRDefinitions;\nconst FSHTank = sushiImport.FSHTank;\nconst importText = sushiImport.importText;\n\nexport function fillTank(rawFSHes, config) {\n  logger.info('Importing FSH text...');\n  const docs = importText(rawFSHes);\n  return new FSHTank(docs, config);\n}\n\nexport async function loadAndCleanDatabase(defs, dependencies) {\n  let helperUpdate = await checkForDatabaseUpgrade(dependencies);\n  let loadExternalDependenciesReturn = { defs, emptyDependencies: [] };\n\n  if (helperUpdate.shouldUpdate) {\n    loadExternalDependenciesReturn = await loadExternalDependencies(defs, helperUpdate.version + 1, dependencies);\n    defs = loadExternalDependenciesReturn.defs;\n  } else {\n    loadExternalDependenciesReturn = await loadExternalDependencies(defs, helperUpdate.version, dependencies);\n    defs = loadExternalDependenciesReturn.defs;\n  }\n\n  // Cleans out database of any empty objectStores\n  await cleanDatabase(loadExternalDependenciesReturn.emptyDependencies, helperUpdate.version + 2);\n  return defs;\n}\n\nexport function cleanDatabase(emptyDependencies, version, databaseName = 'FSH Playground Dependencies') {\n  const mergedEmpties = flatten(emptyDependencies);\n  return new Promise((resolve, reject) => {\n    let database = null;\n    const OpenIDBRequest = indexedDB.open(databaseName, version);\n    OpenIDBRequest.onsuccess = function (event) {\n      database = event.target.result;\n      database.close();\n      resolve();\n    };\n    OpenIDBRequest.onupgradeneeded = async function (event) {\n      database = event.target.result;\n      let existingObjectStores = database.objectStoreNames;\n\n      // Checks existing objectStores to see if any are empty - failsafe for users who previously had blank objectStores created\n      for (let objectStore of existingObjectStores) {\n        await new Promise((resolve) => {\n          let transaction = event.target.transaction;\n          const objStore = transaction.objectStore(`${objectStore}`).getAll();\n          objStore.onsuccess = (event) => {\n            let items = event.target.result;\n            if (items.length === 0 && !mergedEmpties.includes(objectStore)) {\n              mergedEmpties.push(objectStore);\n            }\n            resolve();\n          };\n        });\n      }\n      // Deletes objectStores that are empty\n      for (let i = 0; i < mergedEmpties.length; i++) {\n        if (existingObjectStores.contains(mergedEmpties[i])) {\n          database.deleteObjectStore(mergedEmpties[i]);\n        }\n      }\n    };\n    OpenIDBRequest.onerror = function (event) {\n      reject(event);\n    };\n  });\n}\n\nexport function checkForDatabaseUpgrade(dependencyArr, databaseName = 'FSH Playground Dependencies') {\n  let helperReturn = { shouldUpdate: false, version: 1 };\n  return new Promise((resolve, reject) => {\n    let database = null;\n    const OpenIDBRequest = indexedDB.open(databaseName);\n    OpenIDBRequest.onsuccess = function (event) {\n      database = event.target.result;\n      let existingObjectStores = database.objectStoreNames;\n      helperReturn.version = database.version;\n      if (\n        existingObjectStores.length === 0 ||\n        dependencyArr.length === 0 ||\n        existingObjectStores.contains('resources')\n      ) {\n        helperReturn.shouldUpdate = true;\n        database.close();\n        resolve(helperReturn);\n      } else {\n        for (let i = 0; i < dependencyArr.length; i++) {\n          let dependency = dependencyArr[i][0];\n          let id = dependencyArr[i][1];\n          if (!existingObjectStores.contains(`${dependency}${id}`)) {\n            helperReturn.shouldUpdate = true;\n          }\n        }\n        database.close();\n        resolve(helperReturn);\n      }\n    };\n    OpenIDBRequest.onupgradeneeded = function (event) {\n      database = event.target.result;\n    };\n    OpenIDBRequest.onerror = function (event) {\n      reject(event);\n    };\n  });\n}\n\nexport async function loadExternalDependencies(\n  FHIRdefs,\n  version,\n  dependencyArr,\n  databaseName = 'FSH Playground Dependencies',\n  shouldUnzip = false\n) {\n  return new Promise((resolve, reject) => {\n    let database = null;\n    let newDependencies = [];\n    let returnPackage = { defs: FHIRDefinitions, emptyDependencies: [] };\n    const OpenIDBRequest = indexedDB.open(databaseName, version);\n\n    // If successful the database exists\n    OpenIDBRequest.onsuccess = async function (event) {\n      database = event.target.result;\n      let findR4 = findIndex(dependencyArr, (elem) => elem[0] === 'hl7.fhir.r4.core' && elem[1] === '4.0.1');\n      if (findR4 < 0) {\n        dependencyArr.push(['hl7.fhir.r4.core', '4.0.1']);\n      }\n      for (let i = 0; i < dependencyArr.length; i++) {\n        let resources = [];\n        shouldUnzip = false;\n        const dependency = dependencyArr[i][0];\n        const id = dependencyArr[i][1];\n        if (newDependencies.includes(`${dependency}${id}`)) {\n          shouldUnzip = true;\n        }\n        if (shouldUnzip) {\n          let unzipReturn = await unzipDependencies(resources, dependency, id);\n          if (unzipReturn.emptyDependencies.length !== 0) {\n            returnPackage.emptyDependencies.push(unzipReturn.emptyDependencies);\n          }\n          await loadDependenciesInStorage(database, unzipReturn.resourceArr, dependency, id);\n        }\n        returnPackage.defs = await loadAsFHIRDefs(FHIRdefs, database, dependency, id);\n      }\n      database.close();\n      resolve(returnPackage);\n    };\n\n    // If upgrade is needed to the version, the database does not yet exist\n    OpenIDBRequest.onupgradeneeded = function (event) {\n      let findR4 = findIndex(dependencyArr, (elem) => elem[0] === 'hl7.fhir.r4.core' && elem[1] === '4.0.1');\n      if (findR4 < 0) {\n        dependencyArr.push(['hl7.fhir.r4.core', '4.0.1']);\n      }\n      database = event.target.result;\n      let existingObjectStores = database.objectStoreNames;\n      if (existingObjectStores.contains('resources')) {\n        database.deleteObjectStore('resources');\n      }\n      for (let i = 0; i < dependencyArr.length; i++) {\n        const dependency = dependencyArr[i][0];\n        const id = dependencyArr[i][1];\n        if (!existingObjectStores.contains(`${dependency}${id}`)) {\n          database.createObjectStore(`${dependency}${id}`, {\n            keyPath: ['id', 'resourceType']\n          });\n          newDependencies.push(`${dependency}${id}`);\n        }\n      }\n    };\n\n    // Checks if there is an error\n    OpenIDBRequest.onerror = function (event) {\n      reject(event);\n    };\n  });\n}\n","export function sliceDependency(dependencies) {\n  let returnArr = [];\n  const arr = dependencies.split(',');\n  for (let i = 0; i < arr.length; i++) {\n    arr[i] = arr[i].trim();\n    if (arr[i] === '') {\n      continue;\n    }\n    let singleDep = arr[i].split('#');\n    returnArr.push([singleDep[0], singleDep[1]]);\n  }\n  return returnArr;\n}\n","import { pad, padStart, padEnd } from 'lodash';\nimport { fhirdefs, sushiExport, sushiImport, utils } from 'fsh-sushi';\nimport { gofshExport, processor, utils as gofshUtils } from 'gofsh';\nimport { fillTank, loadAndCleanDatabase } from './Processing';\nimport { sliceDependency } from './helpers';\n\nconst FSHTank = sushiImport.FSHTank;\nconst RawFSH = sushiImport.RawFSH;\nconst exportFHIR = sushiExport.exportFHIR;\nconst logger = utils.logger;\nconst stats = utils.stats;\nconst getRandomPun = utils.getRandomPun;\nconst Type = utils.Type;\nconst FHIRDefinitions = fhirdefs.FHIRDefinitions;\nconst { getRandomSeaCreatures, getRandomSeaCreaturesStat } = gofshUtils;\n\n/**\n * Run GoFSH\n * Note: This function is very similar to FhirToFsh in GoFSH.\n * The only difference is that FSH Online must load dependencies into IndexedDB.\n * If FhirToFsh ever supports a way to load dependencies in the browser,\n * we can update this to simply use that function.\n * @param {array} input array of JSON definitions to be processed\n * @param {object} options - config options for GoFSH based on user input and defaults\n * dependencies: user set, defaults to []\n * @param {FHIRDefinitions} testDefs - this should only be used by the unit tests so they can provide their own definitions.\n * @returns {string} the FSH\n */\nexport async function runGoFSH(input, options) {\n  stats.reset();\n\n  // Read in the resources as strings\n  const docs = [];\n  input.forEach((resource, i) => {\n    const location = `Input_${i}`;\n    try {\n      resource = JSON.parse(resource);\n    } catch (e) {\n      logger.error(`Could not parse ${location} to JSON`);\n      return;\n    }\n    if (gofshUtils.isProcessableContent(resource, location)) {\n      docs.push(new processor.WildFHIR(resource, location));\n    }\n  });\n\n  // Set up the FHIRProcessor\n  const lake = new processor.LakeOfFHIR(docs);\n  let defs = new FHIRDefinitions();\n  const fisher = new gofshUtils.MasterFisher(lake, defs);\n  const fhirProcessor = new processor.FHIRProcessor(lake, fisher);\n\n  // Process the configuration\n  const configuration = fhirProcessor.processConfig(options.dependencies ?? []);\n\n  // Load dependencies, including those inferred from an IG file, and those given as input\n  let dependencies = configuration?.config.dependencies\n    ? configuration?.config.dependencies.map((dep) => `${dep.packageId}#${dep.version}`)\n    : [];\n  dependencies = sliceDependency(dependencies.join(','));\n  defs = await loadAndCleanDatabase(defs, dependencies);\n\n  // Process the FHIR to rules, and then export to FSH\n  const pkg = await gofshUtils.getResources(fhirProcessor, configuration);\n\n  // Return the string of FSH definitions\n  const fsh = new gofshExport.FSHExporter(pkg).apiExport('string');\n  logger.info('Done converting definitions');\n  printGoFSHresults(pkg);\n  return { fsh, config: configuration?.config ?? {} };\n}\n\n/**\n * Load dependencies (FHIR R4) and run SUSHI on provided text\n *\n * @param {string} input - string containing FSH text\n * @param {object} config - Configuration for SUSHI based on user input and defaults\n * config.canonical: user set, defaults to http://example.org\n * config.version: user set, defaults to 1.0.0\n * config.FSHOnly: true\n * config.fhirVersion: [4.0.1]\n *\n * @returns Package with FHIR resources\n */\nexport async function runSUSHI(input, config, dependencyArr) {\n  stats.reset();\n\n  // Load dependencies\n  let defs = new FHIRDefinitions();\n  defs = await loadAndCleanDatabase(defs, dependencyArr);\n\n  // Load and fill FSH Tank\n  let tank = FSHTank;\n  try {\n    const rawFSH = [new RawFSH(input)];\n    tank = fillTank(rawFSH, config);\n  } catch (e) {\n    logger.error('Something went wrong when importing the FSH definitions');\n    return;\n  }\n  //Check for StructureDefinition\n  const structDef = defs.fishForFHIR('StructureDefinition', Type.Resource);\n  if (structDef?.version !== '4.0.1') {\n    logger.error(\n      'StructureDefinition resource not found for v4.0.1. The FHIR R4 package in local cache' +\n        ' may be corrupt. Local FHIR cache can be found at <home-directory>/.fhir/packages.' +\n        ' For more information, see https://wiki.hl7.org/FHIR_Package_Cache#Location.'\n    );\n    return;\n  }\n\n  logger.info('Converting FSH to FHIR resources...');\n  const outPackage = exportFHIR(tank, defs);\n\n  console.log(' ');\n  printSUSHIResults(outPackage);\n\n  // Remove snapshots\n  outPackage.profiles = outPackage.profiles.map((p) => p.toJSON(false));\n  outPackage.extensions = outPackage.extensions.map((e) => e.toJSON(false));\n\n  return outPackage;\n}\n\nfunction printSUSHIResults(pkg) {\n  const numError = stats.numError;\n  const numWarn = stats.numWarn;\n  // NOTE: These variables are creatively names to align well in the strings below while keeping prettier happy\n  const prNum = pad(pkg.profiles.length.toString(), 8);\n  const extnNum = pad(pkg.extensions.length.toString(), 10);\n  const vstNum = pad(pkg.valueSets.length.toString(), 9);\n  const cdsysNum = pad(pkg.codeSystems.length.toString(), 11);\n  const insNum = pad(pkg.instances.length.toString(), 9);\n  const errorNumMsg = pad(`${numError} Error${numError !== 1 ? 's' : ''}`, 13);\n  const wrNumMsg = padStart(`${numWarn} Warning${numWarn !== 1 ? 's' : ''}`, 12);\n\n  const aWittyMessageInvolvingABadFishPun = padEnd(getRandomPun(numError, numWarn), 36);\n  const color = numError > 0 ? 'red' : numWarn > 0 ? '#b36200' : 'green'; // eslint-disable-line no-unused-vars\n\n  /* eslint-disable no-useless-concat */\n  // NOTE: Doing some funky things w/ strings on some lines to keep overall alignment in the code\n  const results = [\n    '╔' + '════════════════════════ SUSHI RESULTS ══════════════════════════' + '╗',\n    '║' + ' ╭──────────┬────────────┬───────────┬─────────────┬───────────╮ ' + '║',\n    '║' + ' │ Profiles │ Extensions │ ValueSets │ CodeSystems │ Instances │ ' + '║',\n    '║' + ' ├──────────┼────────────┼───────────┼─────────────┼───────────┤ ' + '║',\n    '║' + ` │ ${prNum} │ ${extnNum} │ ${vstNum} │ ${cdsysNum} │ ${insNum} │ ` + '║',\n    '║' + ' ╰──────────┴────────────┴───────────┴─────────────┴───────────╯ ' + '║',\n    '║' + '                                                                 ' + '║',\n    '╠' + '═════════════════════════════════════════════════════════════════' + '╣',\n    '║' + ` ${aWittyMessageInvolvingABadFishPun} ${errorNumMsg} ${wrNumMsg} ` + '║',\n    '╚' + '═════════════════════════════════════════════════════════════════' + '╝'\n  ];\n  results.forEach((r) => console.log(r));\n  // results.forEach((r) => console.log(`%c${r}`, `color:${clr}`)); // Color formatting for browser console\n}\n\nfunction printGoFSHresults(pkg) {\n  const proNum = pad(pkg.profiles.length.toString(), 12);\n  const extNum = pad(pkg.extensions.length.toString(), 13);\n  const vsNum = pad(pkg.valueSets.length.toString(), 12);\n  const csNum = pad(pkg.codeSystems.length.toString(), 13);\n  const instNum = pad(pkg.instances.length.toString(), 12);\n  const invNum = pad(pkg.invariants.length.toString(), 13);\n  const mapNum = pad(pkg.mappings.length.toString(), 12);\n  const errNumMsg = pad(`${stats.numError} Error${stats.numError !== 1 ? 's' : ''}`, 12);\n  const wrnNumMsg = padStart(`${stats.numWarn} Warning${stats.numWarn !== 1 ? 's' : ''}`, 12);\n  const creatures = pad(getRandomSeaCreatures(), 13);\n  const creatrStat = pad(getRandomSeaCreaturesStat(stats.numError, stats.numWarn), 13);\n  const aWittyMessageInvolvingABadFishPun = padEnd(getRandomPun(stats.numError, stats.numWarn), 37);\n\n  // prettier-ignore\n  const results = [\n    '╔'  + '═════════════════════════ GoFSH RESULTS ═════════════════════════' +'╗',\n    '║' + ' ╭──────────────┬───────────────┬──────────────┬───────────────╮ ' + '║',\n    '║' + ' │   Profiles   │  Extensions   │  ValueSets   │  CodeSystems  │ ' + '║',\n    '║' + ' ├──────────────┼───────────────┼──────────────┼───────────────┤ ' + '║',\n    '║' + ` │ ${ proNum  } │ ${  extNum  } │ ${  vsNum  } │ ${  csNum   } │ ` + '║',\n    '║' + ' ╰──────────────┴───────────────┴──────────────┴───────────────╯ ' + '║',\n    '║' + ' ╭──────────────┬───────────────┬──────────────┬───────────────╮ ' + '║',\n    '║' + ` │  Instances   │  Invariants   │   Mappings   │ ${creatures } │ ` + '║',\n    '║' + ' ├──────────────┼───────────────┼──────────────┼───────────────┤ ' + '║',\n    '║' + ` │ ${ instNum } │ ${  invNum  } │ ${ mapNum  } │ ${creatrStat} │ ` + '║',\n    '║' + ' ╰──────────────┴───────────────┴──────────────┴───────────────╯ ' + '║',\n    '║' + '                                                                 ' + '║',\n    '╠'  + '═════════════════════════════════════════════════════════════════' +'╣',\n    '║' + ` ${aWittyMessageInvolvingABadFishPun } ${errNumMsg} ${wrnNumMsg} ` + '║',\n    '╚'  + '═════════════════════════════════════════════════════════════════' +'╝'\n  ];\n\n  console.log(' ');\n  results.forEach((r) => console.log(r));\n}\n","import React, { useState } from 'react';\nimport clsx from 'clsx';\nimport { makeStyles } from '@material-ui/core/styles';\nimport { PlayArrow, Settings } from '@material-ui/icons';\nimport { Box, Button, CircularProgress, Grid } from '@material-ui/core';\nimport TextField from '@material-ui/core/TextField';\nimport Dialog from '@material-ui/core/Dialog';\nimport DialogActions from '@material-ui/core/DialogActions';\nimport DialogContent from '@material-ui/core/DialogContent';\nimport DialogContentText from '@material-ui/core/DialogContentText';\nimport DialogTitle from '@material-ui/core/DialogTitle';\nimport { runSUSHI, runGoFSH } from '../utils/FSHHelpers';\nimport { sliceDependency } from '../utils/helpers';\n\nconst useStyles = makeStyles((theme) => ({\n  box: {\n    padding: theme.spacing(1),\n    color: theme.palette.text.primary,\n    background: theme.palette.background.paper,\n    display: 'flex;',\n    alignItems: 'center',\n    justifyContent: 'center'\n  },\n  rightControls: {\n    position: 'absolute',\n    right: '24px'\n  },\n  secondaryButton: {\n    color: theme.palette.success.main,\n    '&:hover': {\n      background: theme.palette.common.lighterBlue\n    }\n  },\n  progressContainer: {\n    width: '24px',\n    height: '24px'\n  },\n  progress: {\n    height: '1em !important',\n    width: '1em !important',\n    verticalAlign: 'middle',\n    color: theme.palette.common.white\n  },\n  button: {\n    color: theme.palette.common.white,\n    background: theme.palette.success.main,\n    borderRadius: '0',\n    paddingRight: '15px',\n    paddingLeft: '15px',\n    '&:hover': {\n      background: theme.palette.success.dark\n    }\n  },\n  buttonLeft: {\n    float: 'right',\n    marginRight: '2px'\n  },\n  runIcon: {\n    padding: '0px'\n  }\n}));\n\nfunction replacer(key, value) {\n  if (key === 'config') {\n    return undefined;\n  }\n  return value;\n}\n\nexport default function FSHControls(props) {\n  const classes = useStyles();\n  const [openConfig, setOpenConfig] = useState(false);\n  const [canonical, setCanonical] = useState('');\n  const [version, setVersion] = useState('');\n  const [dependencies, setDependencies] = useState('');\n  const [isSUSHIRunning, setIsSUSHIRunning] = useState(false);\n  const [isGoFSHRunning, setIsGoFSHRunning] = useState(false);\n\n  const handleOpenConfig = () => {\n    setOpenConfig(true);\n  };\n\n  const handleCloseConfig = () => {\n    setOpenConfig(false);\n  };\n\n  const updateCanonical = (event) => {\n    const newCanonical = event.target.value;\n    setCanonical(newCanonical);\n  };\n\n  const updateVersion = (event) => {\n    const newVersion = event.target.value;\n    setVersion(newVersion);\n  };\n\n  const updateDependencyString = (event) => {\n    const dependencyString = event.target.value;\n    setDependencies(dependencyString);\n  };\n\n  async function handleSUSHIClick() {\n    if (props.isWaiting) {\n      // If SUSHI or GoFSH is in the middle of processes, don't do anything\n      return;\n    }\n\n    props.resetLogMessages();\n    props.onSUSHIClick(true, [''], true);\n    setIsSUSHIRunning(true);\n    const dependencyArr = sliceDependency(dependencies);\n    const config = {\n      canonical: canonical ? canonical : 'http://example.org',\n      version: version ? version : '1.0.0',\n      FSHOnly: true,\n      fhirVersion: ['4.0.1']\n    };\n    const outPackage = await runSUSHI(props.fshText, config, dependencyArr);\n    let jsonOutput = JSON.stringify(outPackage, replacer, 2);\n    if (outPackage && outPackage.codeSystems) {\n      if (\n        !outPackage.codeSystems.length &&\n        !outPackage.extensions.length &&\n        !outPackage.instances.length &&\n        !outPackage.profiles.length &&\n        !outPackage.valueSets.length\n      ) {\n        jsonOutput = [''];\n      }\n    } else {\n      jsonOutput = [''];\n    }\n\n    props.onSUSHIClick(true, jsonOutput, false);\n    setIsSUSHIRunning(false);\n  }\n\n  async function handleGoFSHClick() {\n    if (props.isWaiting) {\n      // If SUSHI or GoFSH is in the middle of processes, don't do anything\n      return;\n    }\n\n    props.resetLogMessages();\n    props.onGoFSHClick('', true);\n    setIsGoFSHRunning(true);\n    const gofshInputStrings = props.gofshText.map((def) => def.def).filter((d) => d);\n    const parsedDependencies = dependencies === '' ? [] : dependencies.split(',');\n\n    // Create small ImplementationGuide resource to send canonical and version information\n    if (canonical || version) {\n      const igResource = {\n        resourceType: 'ImplementationGuide',\n        fhirVersion: ['4.0.1'],\n        id: '1',\n        ...(canonical && { url: `${canonical}/ImplementationGuide/1` }),\n        ...(version && { version: version })\n      };\n      gofshInputStrings.push(JSON.stringify(igResource, null, 2));\n    }\n\n    const options = { dependencies: parsedDependencies };\n    const { fsh, config } = await runGoFSH(gofshInputStrings, options);\n    props.onGoFSHClick(fsh, false);\n    setIsGoFSHRunning(false);\n    if (canonical === '' && config.canonical) setCanonical(config.canonical);\n    if (version === '' && config.version) setVersion(config.version);\n  }\n\n  return (\n    <Box className={classes.box}>\n      <Grid container>\n        <Grid item xs={5}>\n          <Button className={clsx(classes.button, classes.buttonLeft)} onClick={handleSUSHIClick} testid=\"Button\">\n            Convert to JSON\n            {isSUSHIRunning ? (\n              <div className={classes.progressContainer}>\n                <CircularProgress className={classes.progress} />\n              </div>\n            ) : (\n              <PlayArrow className={classes.runIcon} />\n            )}\n          </Button>\n        </Grid>\n        <Grid item xs={7}>\n          <Button className={classes.button} onClick={handleGoFSHClick} testid=\"GoFSH-button\">\n            {isGoFSHRunning ? (\n              <div className={classes.progressContainer}>\n                <CircularProgress className={classes.progress} />\n              </div>\n            ) : (\n              <PlayArrow className={classes.runIcon} style={{ transform: 'scaleX(-1)' }} />\n            )}\n            Convert to FSH\n          </Button>\n        </Grid>\n      </Grid>\n\n      <div className={classes.rightControls}>\n        <Button name=\"Configuration\" className={classes.secondaryButton} onClick={handleOpenConfig}>\n          <Settings /> Configuration\n        </Button>\n      </div>\n\n      <Dialog open={openConfig} onClose={handleCloseConfig} aria-labelledby=\"form-dialog-title\">\n        <DialogTitle id=\"form-dialog-title\">Configuration Settings</DialogTitle>\n        <DialogContent>\n          <DialogContentText>\n            Change the Implementation Guide configuration to use when processing FSH and FHIR JSON\n          </DialogContentText>\n          <TextField\n            id=\"canonical\"\n            margin=\"dense\"\n            fullWidth\n            label=\"Canonical URL\"\n            helperText=\"Default: http://example.org\"\n            defaultValue={canonical}\n            onChange={updateCanonical}\n          />\n          <TextField\n            id=\"version\"\n            margin=\"dense\"\n            fullWidth\n            label=\"Version\"\n            helperText=\"Default: 1.0.0\"\n            defaultValue={version}\n            onChange={updateVersion}\n          />\n          <TextField\n            id=\"dependencies\"\n            margin=\"dense\"\n            fullWidth\n            label=\"Dependencies\"\n            helperText=\"Format: packageId#version, packageId#version (e.g., hl7.fhir.us.core#3.1.1)\"\n            defaultValue={dependencies}\n            onChange={updateDependencyString}\n          />\n        </DialogContent>\n        <DialogActions>\n          <Button onClick={handleCloseConfig} color=\"primary\">\n            Done\n          </Button>\n        </DialogActions>\n      </Dialog>\n    </Box>\n  );\n}\n"],"sourceRoot":""}